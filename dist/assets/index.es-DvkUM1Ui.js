const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DCptEfrH.js","assets/index-B3T43FqE.js","assets/index-CC9QRen_.css"])))=>i.map(i=>d[i]);
import{J as Gb,K as hd,L as Ba,N as mu,P as dt,V as Qb,W as ms,X as Yr,Y as Er,Z as ph,$ as Jb,a0 as Yb,a1 as Wb,a2 as ws,a3 as en,a4 as ud,a5 as Xb,a6 as Zb,a7 as vu,a8 as t6,a9 as Ya,aa as e6,ab as gr,ac as r6,ad as i6,ae as Dr,af as Ei,ag as Fn,ah as Io,ai as fs,aj as yu,ak as hi,al as wu,am as bu,an as Wa,ao as _u,ap as Qi,aq as n6,ar as os,as as Di,_ as s6}from"./index-B3T43FqE.js";var gh={},mh,ld;function o6(){return ld||(ld=1,mh=r=>encodeURIComponent(r).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`)),mh}var vh,fd;function a6(){if(fd)return vh;fd=1;var r="%[a-f0-9]{2}",t=new RegExp("("+r+")|([^%]+?)","gi"),e=new RegExp("("+r+")+","gi");function n(h,u){try{return[decodeURIComponent(h.join(""))]}catch{}if(h.length===1)return h;u=u||1;var f=h.slice(0,u),y=h.slice(u);return Array.prototype.concat.call([],n(f),n(y))}function s(h){try{return decodeURIComponent(h)}catch{for(var u=h.match(t)||[],f=1;f<u.length;f++)h=n(u,f).join(""),u=h.match(t)||[];return h}}function a(h){for(var u={"%FE%FF":"��","%FF%FE":"��"},f=e.exec(h);f;){try{u[f[0]]=decodeURIComponent(f[0])}catch{var y=s(f[0]);y!==f[0]&&(u[f[0]]=y)}f=e.exec(h)}u["%C2"]="�";for(var A=Object.keys(u),x=0;x<A.length;x++){var T=A[x];h=h.replace(new RegExp(T,"g"),u[T])}return h}return vh=function(h){if(typeof h!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof h+"`");try{return h=h.replace(/\+/g," "),decodeURIComponent(h)}catch{return a(h)}},vh}var yh,dd;function c6(){return dd||(dd=1,yh=(r,t)=>{if(!(typeof r=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[r];const e=r.indexOf(t);return e===-1?[r]:[r.slice(0,e),r.slice(e+t.length)]}),yh}var wh,pd;function h6(){return pd||(pd=1,wh=function(r,t){for(var e={},n=Object.keys(r),s=Array.isArray(t),a=0;a<n.length;a++){var h=n[a],u=r[h];(s?t.indexOf(h)!==-1:t(h,u,r))&&(e[h]=u)}return e}),wh}var gd;function u6(){return gd||(gd=1,function(r){const t=o6(),e=a6(),n=c6(),s=h6(),a=H=>H==null,h=Symbol("encodeFragmentIdentifier");function u(H){switch(H.arrayFormat){case"index":return J=>(B,k)=>{const z=B.length;return k===void 0||H.skipNull&&k===null||H.skipEmptyString&&k===""?B:k===null?[...B,[A(J,H),"[",z,"]"].join("")]:[...B,[A(J,H),"[",A(z,H),"]=",A(k,H)].join("")]};case"bracket":return J=>(B,k)=>k===void 0||H.skipNull&&k===null||H.skipEmptyString&&k===""?B:k===null?[...B,[A(J,H),"[]"].join("")]:[...B,[A(J,H),"[]=",A(k,H)].join("")];case"colon-list-separator":return J=>(B,k)=>k===void 0||H.skipNull&&k===null||H.skipEmptyString&&k===""?B:k===null?[...B,[A(J,H),":list="].join("")]:[...B,[A(J,H),":list=",A(k,H)].join("")];case"comma":case"separator":case"bracket-separator":{const J=H.arrayFormat==="bracket-separator"?"[]=":"=";return B=>(k,z)=>z===void 0||H.skipNull&&z===null||H.skipEmptyString&&z===""?k:(z=z===null?"":z,k.length===0?[[A(B,H),J,A(z,H)].join("")]:[[k,A(z,H)].join(H.arrayFormatSeparator)])}default:return J=>(B,k)=>k===void 0||H.skipNull&&k===null||H.skipEmptyString&&k===""?B:k===null?[...B,A(J,H)]:[...B,[A(J,H),"=",A(k,H)].join("")]}}function f(H){let J;switch(H.arrayFormat){case"index":return(B,k,z)=>{if(J=/\[(\d*)\]$/.exec(B),B=B.replace(/\[\d*\]$/,""),!J){z[B]=k;return}z[B]===void 0&&(z[B]={}),z[B][J[1]]=k};case"bracket":return(B,k,z)=>{if(J=/(\[\])$/.exec(B),B=B.replace(/\[\]$/,""),!J){z[B]=k;return}if(z[B]===void 0){z[B]=[k];return}z[B]=[].concat(z[B],k)};case"colon-list-separator":return(B,k,z)=>{if(J=/(:list)$/.exec(B),B=B.replace(/:list$/,""),!J){z[B]=k;return}if(z[B]===void 0){z[B]=[k];return}z[B]=[].concat(z[B],k)};case"comma":case"separator":return(B,k,z)=>{const w=typeof k=="string"&&k.includes(H.arrayFormatSeparator),q=typeof k=="string"&&!w&&x(k,H).includes(H.arrayFormatSeparator);k=q?x(k,H):k;const ht=w||q?k.split(H.arrayFormatSeparator).map(ut=>x(ut,H)):k===null?k:x(k,H);z[B]=ht};case"bracket-separator":return(B,k,z)=>{const w=/(\[\])$/.test(B);if(B=B.replace(/\[\]$/,""),!w){z[B]=k&&x(k,H);return}const q=k===null?[]:k.split(H.arrayFormatSeparator).map(ht=>x(ht,H));if(z[B]===void 0){z[B]=q;return}z[B]=[].concat(z[B],q)};default:return(B,k,z)=>{if(z[B]===void 0){z[B]=k;return}z[B]=[].concat(z[B],k)}}}function y(H){if(typeof H!="string"||H.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function A(H,J){return J.encode?J.strict?t(H):encodeURIComponent(H):H}function x(H,J){return J.decode?e(H):H}function T(H){return Array.isArray(H)?H.sort():typeof H=="object"?T(Object.keys(H)).sort((J,B)=>Number(J)-Number(B)).map(J=>H[J]):H}function R(H){const J=H.indexOf("#");return J!==-1&&(H=H.slice(0,J)),H}function $(H){let J="";const B=H.indexOf("#");return B!==-1&&(J=H.slice(B)),J}function Q(H){H=R(H);const J=H.indexOf("?");return J===-1?"":H.slice(J+1)}function V(H,J){return J.parseNumbers&&!Number.isNaN(Number(H))&&typeof H=="string"&&H.trim()!==""?H=Number(H):J.parseBooleans&&H!==null&&(H.toLowerCase()==="true"||H.toLowerCase()==="false")&&(H=H.toLowerCase()==="true"),H}function Z(H,J){J=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},J),y(J.arrayFormatSeparator);const B=f(J),k=Object.create(null);if(typeof H!="string"||(H=H.trim().replace(/^[?#&]/,""),!H))return k;for(const z of H.split("&")){if(z==="")continue;let[w,q]=n(J.decode?z.replace(/\+/g," "):z,"=");q=q===void 0?null:["comma","separator","bracket-separator"].includes(J.arrayFormat)?q:x(q,J),B(x(w,J),q,k)}for(const z of Object.keys(k)){const w=k[z];if(typeof w=="object"&&w!==null)for(const q of Object.keys(w))w[q]=V(w[q],J);else k[z]=V(w,J)}return J.sort===!1?k:(J.sort===!0?Object.keys(k).sort():Object.keys(k).sort(J.sort)).reduce((z,w)=>{const q=k[w];return q&&typeof q=="object"&&!Array.isArray(q)?z[w]=T(q):z[w]=q,z},Object.create(null))}r.extract=Q,r.parse=Z,r.stringify=(H,J)=>{if(!H)return"";J=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},J),y(J.arrayFormatSeparator);const B=q=>J.skipNull&&a(H[q])||J.skipEmptyString&&H[q]==="",k=u(J),z={};for(const q of Object.keys(H))B(q)||(z[q]=H[q]);const w=Object.keys(z);return J.sort!==!1&&w.sort(J.sort),w.map(q=>{const ht=H[q];return ht===void 0?"":ht===null?A(q,J):Array.isArray(ht)?ht.length===0&&J.arrayFormat==="bracket-separator"?A(q,J)+"[]":ht.reduce(k(q),[]).join("&"):A(q,J)+"="+A(ht,J)}).filter(q=>q.length>0).join("&")},r.parseUrl=(H,J)=>{J=Object.assign({decode:!0},J);const[B,k]=n(H,"#");return Object.assign({url:B.split("?")[0]||"",query:Z(Q(H),J)},J&&J.parseFragmentIdentifier&&k?{fragmentIdentifier:x(k,J)}:{})},r.stringifyUrl=(H,J)=>{J=Object.assign({encode:!0,strict:!0,[h]:!0},J);const B=R(H.url).split("?")[0]||"",k=r.extract(H.url),z=r.parse(k,{sort:!1}),w=Object.assign(z,H.query);let q=r.stringify(w,J);q&&(q=`?${q}`);let ht=$(H.url);return H.fragmentIdentifier&&(ht=`#${J[h]?A(H.fragmentIdentifier,J):H.fragmentIdentifier}`),`${B}${q}${ht}`},r.pick=(H,J,B)=>{B=Object.assign({parseFragmentIdentifier:!0,[h]:!1},B);const{url:k,query:z,fragmentIdentifier:w}=r.parseUrl(H,B);return r.stringifyUrl({url:k,query:s(z,J),fragmentIdentifier:w},B)},r.exclude=(H,J,B)=>{const k=Array.isArray(J)?z=>!J.includes(z):(z,w)=>!J(z,w);return r.pick(H,k,B)}}(gh)),gh}var La=u6(),bh={},Ws={},ne={},_h={},md;function l6(){return md||(md=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});function t(u,f){var y=u>>>16&65535,A=u&65535,x=f>>>16&65535,T=f&65535;return A*T+(y*T+A*x<<16>>>0)|0}r.mul=Math.imul||t;function e(u,f){return u+f|0}r.add=e;function n(u,f){return u-f|0}r.sub=n;function s(u,f){return u<<f|u>>>32-f}r.rotl=s;function a(u,f){return u<<32-f|u>>>f}r.rotr=a;function h(u){return typeof u=="number"&&isFinite(u)&&Math.floor(u)===u}r.isInteger=Number.isInteger||h,r.MAX_SAFE_INTEGER=9007199254740991,r.isSafeInteger=function(u){return r.isInteger(u)&&u>=-r.MAX_SAFE_INTEGER&&u<=r.MAX_SAFE_INTEGER}}(_h)),_h}var vd;function So(){if(vd)return ne;vd=1,Object.defineProperty(ne,"__esModule",{value:!0});var r=l6();function t(m,b){return b===void 0&&(b=0),(m[b+0]<<8|m[b+1])<<16>>16}ne.readInt16BE=t;function e(m,b){return b===void 0&&(b=0),(m[b+0]<<8|m[b+1])>>>0}ne.readUint16BE=e;function n(m,b){return b===void 0&&(b=0),(m[b+1]<<8|m[b])<<16>>16}ne.readInt16LE=n;function s(m,b){return b===void 0&&(b=0),(m[b+1]<<8|m[b])>>>0}ne.readUint16LE=s;function a(m,b,E){return b===void 0&&(b=new Uint8Array(2)),E===void 0&&(E=0),b[E+0]=m>>>8,b[E+1]=m>>>0,b}ne.writeUint16BE=a,ne.writeInt16BE=a;function h(m,b,E){return b===void 0&&(b=new Uint8Array(2)),E===void 0&&(E=0),b[E+0]=m>>>0,b[E+1]=m>>>8,b}ne.writeUint16LE=h,ne.writeInt16LE=h;function u(m,b){return b===void 0&&(b=0),m[b]<<24|m[b+1]<<16|m[b+2]<<8|m[b+3]}ne.readInt32BE=u;function f(m,b){return b===void 0&&(b=0),(m[b]<<24|m[b+1]<<16|m[b+2]<<8|m[b+3])>>>0}ne.readUint32BE=f;function y(m,b){return b===void 0&&(b=0),m[b+3]<<24|m[b+2]<<16|m[b+1]<<8|m[b]}ne.readInt32LE=y;function A(m,b){return b===void 0&&(b=0),(m[b+3]<<24|m[b+2]<<16|m[b+1]<<8|m[b])>>>0}ne.readUint32LE=A;function x(m,b,E){return b===void 0&&(b=new Uint8Array(4)),E===void 0&&(E=0),b[E+0]=m>>>24,b[E+1]=m>>>16,b[E+2]=m>>>8,b[E+3]=m>>>0,b}ne.writeUint32BE=x,ne.writeInt32BE=x;function T(m,b,E){return b===void 0&&(b=new Uint8Array(4)),E===void 0&&(E=0),b[E+0]=m>>>0,b[E+1]=m>>>8,b[E+2]=m>>>16,b[E+3]=m>>>24,b}ne.writeUint32LE=T,ne.writeInt32LE=T;function R(m,b){b===void 0&&(b=0);var E=u(m,b),P=u(m,b+4);return E*4294967296+P-(P>>31)*4294967296}ne.readInt64BE=R;function $(m,b){b===void 0&&(b=0);var E=f(m,b),P=f(m,b+4);return E*4294967296+P}ne.readUint64BE=$;function Q(m,b){b===void 0&&(b=0);var E=y(m,b),P=y(m,b+4);return P*4294967296+E-(E>>31)*4294967296}ne.readInt64LE=Q;function V(m,b){b===void 0&&(b=0);var E=A(m,b),P=A(m,b+4);return P*4294967296+E}ne.readUint64LE=V;function Z(m,b,E){return b===void 0&&(b=new Uint8Array(8)),E===void 0&&(E=0),x(m/4294967296>>>0,b,E),x(m>>>0,b,E+4),b}ne.writeUint64BE=Z,ne.writeInt64BE=Z;function H(m,b,E){return b===void 0&&(b=new Uint8Array(8)),E===void 0&&(E=0),T(m>>>0,b,E),T(m/4294967296>>>0,b,E+4),b}ne.writeUint64LE=H,ne.writeInt64LE=H;function J(m,b,E){if(E===void 0&&(E=0),m%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(m/8>b.length-E)throw new Error("readUintBE: array is too short for the given bitLength");for(var P=0,O=1,S=m/8+E-1;S>=E;S--)P+=b[S]*O,O*=256;return P}ne.readUintBE=J;function B(m,b,E){if(E===void 0&&(E=0),m%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(m/8>b.length-E)throw new Error("readUintLE: array is too short for the given bitLength");for(var P=0,O=1,S=E;S<E+m/8;S++)P+=b[S]*O,O*=256;return P}ne.readUintLE=B;function k(m,b,E,P){if(E===void 0&&(E=new Uint8Array(m/8)),P===void 0&&(P=0),m%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!r.isSafeInteger(b))throw new Error("writeUintBE value must be an integer");for(var O=1,S=m/8+P-1;S>=P;S--)E[S]=b/O&255,O*=256;return E}ne.writeUintBE=k;function z(m,b,E,P){if(E===void 0&&(E=new Uint8Array(m/8)),P===void 0&&(P=0),m%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!r.isSafeInteger(b))throw new Error("writeUintLE value must be an integer");for(var O=1,S=P;S<P+m/8;S++)E[S]=b/O&255,O*=256;return E}ne.writeUintLE=z;function w(m,b){b===void 0&&(b=0);var E=new DataView(m.buffer,m.byteOffset,m.byteLength);return E.getFloat32(b)}ne.readFloat32BE=w;function q(m,b){b===void 0&&(b=0);var E=new DataView(m.buffer,m.byteOffset,m.byteLength);return E.getFloat32(b,!0)}ne.readFloat32LE=q;function ht(m,b){b===void 0&&(b=0);var E=new DataView(m.buffer,m.byteOffset,m.byteLength);return E.getFloat64(b)}ne.readFloat64BE=ht;function ut(m,b){b===void 0&&(b=0);var E=new DataView(m.buffer,m.byteOffset,m.byteLength);return E.getFloat64(b,!0)}ne.readFloat64LE=ut;function lt(m,b,E){b===void 0&&(b=new Uint8Array(4)),E===void 0&&(E=0);var P=new DataView(b.buffer,b.byteOffset,b.byteLength);return P.setFloat32(E,m),b}ne.writeFloat32BE=lt;function gt(m,b,E){b===void 0&&(b=new Uint8Array(4)),E===void 0&&(E=0);var P=new DataView(b.buffer,b.byteOffset,b.byteLength);return P.setFloat32(E,m,!0),b}ne.writeFloat32LE=gt;function l(m,b,E){b===void 0&&(b=new Uint8Array(8)),E===void 0&&(E=0);var P=new DataView(b.buffer,b.byteOffset,b.byteLength);return P.setFloat64(E,m),b}ne.writeFloat64BE=l;function v(m,b,E){b===void 0&&(b=new Uint8Array(8)),E===void 0&&(E=0);var P=new DataView(b.buffer,b.byteOffset,b.byteLength);return P.setFloat64(E,m,!0),b}return ne.writeFloat64LE=v,ne}var wa={},yd;function ui(){if(yd)return wa;yd=1,Object.defineProperty(wa,"__esModule",{value:!0});function r(t){for(var e=0;e<t.length;e++)t[e]=0;return t}return wa.wipe=r,wa}var wd;function f6(){if(wd)return Ws;wd=1,Object.defineProperty(Ws,"__esModule",{value:!0});var r=So(),t=ui(),e=20;function n(u,f,y){for(var A=1634760805,x=857760878,T=2036477234,R=1797285236,$=y[3]<<24|y[2]<<16|y[1]<<8|y[0],Q=y[7]<<24|y[6]<<16|y[5]<<8|y[4],V=y[11]<<24|y[10]<<16|y[9]<<8|y[8],Z=y[15]<<24|y[14]<<16|y[13]<<8|y[12],H=y[19]<<24|y[18]<<16|y[17]<<8|y[16],J=y[23]<<24|y[22]<<16|y[21]<<8|y[20],B=y[27]<<24|y[26]<<16|y[25]<<8|y[24],k=y[31]<<24|y[30]<<16|y[29]<<8|y[28],z=f[3]<<24|f[2]<<16|f[1]<<8|f[0],w=f[7]<<24|f[6]<<16|f[5]<<8|f[4],q=f[11]<<24|f[10]<<16|f[9]<<8|f[8],ht=f[15]<<24|f[14]<<16|f[13]<<8|f[12],ut=A,lt=x,gt=T,l=R,v=$,m=Q,b=V,E=Z,P=H,O=J,S=B,d=k,C=z,X=w,rt=q,_=ht,W=0;W<e;W+=2)ut=ut+v|0,C^=ut,C=C>>>16|C<<16,P=P+C|0,v^=P,v=v>>>20|v<<12,lt=lt+m|0,X^=lt,X=X>>>16|X<<16,O=O+X|0,m^=O,m=m>>>20|m<<12,gt=gt+b|0,rt^=gt,rt=rt>>>16|rt<<16,S=S+rt|0,b^=S,b=b>>>20|b<<12,l=l+E|0,_^=l,_=_>>>16|_<<16,d=d+_|0,E^=d,E=E>>>20|E<<12,gt=gt+b|0,rt^=gt,rt=rt>>>24|rt<<8,S=S+rt|0,b^=S,b=b>>>25|b<<7,l=l+E|0,_^=l,_=_>>>24|_<<8,d=d+_|0,E^=d,E=E>>>25|E<<7,lt=lt+m|0,X^=lt,X=X>>>24|X<<8,O=O+X|0,m^=O,m=m>>>25|m<<7,ut=ut+v|0,C^=ut,C=C>>>24|C<<8,P=P+C|0,v^=P,v=v>>>25|v<<7,ut=ut+m|0,_^=ut,_=_>>>16|_<<16,S=S+_|0,m^=S,m=m>>>20|m<<12,lt=lt+b|0,C^=lt,C=C>>>16|C<<16,d=d+C|0,b^=d,b=b>>>20|b<<12,gt=gt+E|0,X^=gt,X=X>>>16|X<<16,P=P+X|0,E^=P,E=E>>>20|E<<12,l=l+v|0,rt^=l,rt=rt>>>16|rt<<16,O=O+rt|0,v^=O,v=v>>>20|v<<12,gt=gt+E|0,X^=gt,X=X>>>24|X<<8,P=P+X|0,E^=P,E=E>>>25|E<<7,l=l+v|0,rt^=l,rt=rt>>>24|rt<<8,O=O+rt|0,v^=O,v=v>>>25|v<<7,lt=lt+b|0,C^=lt,C=C>>>24|C<<8,d=d+C|0,b^=d,b=b>>>25|b<<7,ut=ut+m|0,_^=ut,_=_>>>24|_<<8,S=S+_|0,m^=S,m=m>>>25|m<<7;r.writeUint32LE(ut+A|0,u,0),r.writeUint32LE(lt+x|0,u,4),r.writeUint32LE(gt+T|0,u,8),r.writeUint32LE(l+R|0,u,12),r.writeUint32LE(v+$|0,u,16),r.writeUint32LE(m+Q|0,u,20),r.writeUint32LE(b+V|0,u,24),r.writeUint32LE(E+Z|0,u,28),r.writeUint32LE(P+H|0,u,32),r.writeUint32LE(O+J|0,u,36),r.writeUint32LE(S+B|0,u,40),r.writeUint32LE(d+k|0,u,44),r.writeUint32LE(C+z|0,u,48),r.writeUint32LE(X+w|0,u,52),r.writeUint32LE(rt+q|0,u,56),r.writeUint32LE(_+ht|0,u,60)}function s(u,f,y,A,x){if(x===void 0&&(x=0),u.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(A.length<y.length)throw new Error("ChaCha: destination is shorter than source");var T,R;if(x===0){if(f.length!==8&&f.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");T=new Uint8Array(16),R=T.length-f.length,T.set(f,R)}else{if(f.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");T=f,R=x}for(var $=new Uint8Array(64),Q=0;Q<y.length;Q+=64){n($,T,u);for(var V=Q;V<Q+64&&V<y.length;V++)A[V]=y[V]^$[V-Q];h(T,0,R)}return t.wipe($),x===0&&t.wipe(T),A}Ws.streamXOR=s;function a(u,f,y,A){return A===void 0&&(A=0),t.wipe(y),s(u,f,y,y,A)}Ws.stream=a;function h(u,f,y){for(var A=1;y--;)A=A+(u[f]&255)|0,u[f]=A&255,A>>>=8,f++;if(A>0)throw new Error("ChaCha: counter overflow")}return Ws}var Ah={},Cn={},bd;function Au(){if(bd)return Cn;bd=1,Object.defineProperty(Cn,"__esModule",{value:!0});function r(s,a,h){return~(s-1)&a|s-1&h}Cn.select=r;function t(s,a){return(s|0)-(a|0)-1>>>31&1}Cn.lessOrEqual=t;function e(s,a){if(s.length!==a.length)return 0;for(var h=0,u=0;u<s.length;u++)h|=s[u]^a[u];return 1&h-1>>>8}Cn.compare=e;function n(s,a){return s.length===0||a.length===0?!1:e(s,a)!==0}return Cn.equal=n,Cn}var _d;function d6(){return _d||(_d=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=Au(),e=ui();r.DIGEST_LENGTH=16;var n=function(){function h(u){this.digestLength=r.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var f=u[0]|u[1]<<8;this._r[0]=f&8191;var y=u[2]|u[3]<<8;this._r[1]=(f>>>13|y<<3)&8191;var A=u[4]|u[5]<<8;this._r[2]=(y>>>10|A<<6)&7939;var x=u[6]|u[7]<<8;this._r[3]=(A>>>7|x<<9)&8191;var T=u[8]|u[9]<<8;this._r[4]=(x>>>4|T<<12)&255,this._r[5]=T>>>1&8190;var R=u[10]|u[11]<<8;this._r[6]=(T>>>14|R<<2)&8191;var $=u[12]|u[13]<<8;this._r[7]=(R>>>11|$<<5)&8065;var Q=u[14]|u[15]<<8;this._r[8]=($>>>8|Q<<8)&8191,this._r[9]=Q>>>5&127,this._pad[0]=u[16]|u[17]<<8,this._pad[1]=u[18]|u[19]<<8,this._pad[2]=u[20]|u[21]<<8,this._pad[3]=u[22]|u[23]<<8,this._pad[4]=u[24]|u[25]<<8,this._pad[5]=u[26]|u[27]<<8,this._pad[6]=u[28]|u[29]<<8,this._pad[7]=u[30]|u[31]<<8}return h.prototype._blocks=function(u,f,y){for(var A=this._fin?0:2048,x=this._h[0],T=this._h[1],R=this._h[2],$=this._h[3],Q=this._h[4],V=this._h[5],Z=this._h[6],H=this._h[7],J=this._h[8],B=this._h[9],k=this._r[0],z=this._r[1],w=this._r[2],q=this._r[3],ht=this._r[4],ut=this._r[5],lt=this._r[6],gt=this._r[7],l=this._r[8],v=this._r[9];y>=16;){var m=u[f+0]|u[f+1]<<8;x+=m&8191;var b=u[f+2]|u[f+3]<<8;T+=(m>>>13|b<<3)&8191;var E=u[f+4]|u[f+5]<<8;R+=(b>>>10|E<<6)&8191;var P=u[f+6]|u[f+7]<<8;$+=(E>>>7|P<<9)&8191;var O=u[f+8]|u[f+9]<<8;Q+=(P>>>4|O<<12)&8191,V+=O>>>1&8191;var S=u[f+10]|u[f+11]<<8;Z+=(O>>>14|S<<2)&8191;var d=u[f+12]|u[f+13]<<8;H+=(S>>>11|d<<5)&8191;var C=u[f+14]|u[f+15]<<8;J+=(d>>>8|C<<8)&8191,B+=C>>>5|A;var X=0,rt=X;rt+=x*k,rt+=T*(5*v),rt+=R*(5*l),rt+=$*(5*gt),rt+=Q*(5*lt),X=rt>>>13,rt&=8191,rt+=V*(5*ut),rt+=Z*(5*ht),rt+=H*(5*q),rt+=J*(5*w),rt+=B*(5*z),X+=rt>>>13,rt&=8191;var _=X;_+=x*z,_+=T*k,_+=R*(5*v),_+=$*(5*l),_+=Q*(5*gt),X=_>>>13,_&=8191,_+=V*(5*lt),_+=Z*(5*ut),_+=H*(5*ht),_+=J*(5*q),_+=B*(5*w),X+=_>>>13,_&=8191;var W=X;W+=x*w,W+=T*z,W+=R*k,W+=$*(5*v),W+=Q*(5*l),X=W>>>13,W&=8191,W+=V*(5*gt),W+=Z*(5*lt),W+=H*(5*ut),W+=J*(5*ht),W+=B*(5*q),X+=W>>>13,W&=8191;var D=X;D+=x*q,D+=T*w,D+=R*z,D+=$*k,D+=Q*(5*v),X=D>>>13,D&=8191,D+=V*(5*l),D+=Z*(5*gt),D+=H*(5*lt),D+=J*(5*ut),D+=B*(5*ht),X+=D>>>13,D&=8191;var U=X;U+=x*ht,U+=T*q,U+=R*w,U+=$*z,U+=Q*k,X=U>>>13,U&=8191,U+=V*(5*v),U+=Z*(5*l),U+=H*(5*gt),U+=J*(5*lt),U+=B*(5*ut),X+=U>>>13,U&=8191;var L=X;L+=x*ut,L+=T*ht,L+=R*q,L+=$*w,L+=Q*z,X=L>>>13,L&=8191,L+=V*k,L+=Z*(5*v),L+=H*(5*l),L+=J*(5*gt),L+=B*(5*lt),X+=L>>>13,L&=8191;var p=X;p+=x*lt,p+=T*ut,p+=R*ht,p+=$*q,p+=Q*w,X=p>>>13,p&=8191,p+=V*z,p+=Z*k,p+=H*(5*v),p+=J*(5*l),p+=B*(5*gt),X+=p>>>13,p&=8191;var F=X;F+=x*gt,F+=T*lt,F+=R*ut,F+=$*ht,F+=Q*q,X=F>>>13,F&=8191,F+=V*w,F+=Z*z,F+=H*k,F+=J*(5*v),F+=B*(5*l),X+=F>>>13,F&=8191;var et=X;et+=x*l,et+=T*gt,et+=R*lt,et+=$*ut,et+=Q*ht,X=et>>>13,et&=8191,et+=V*q,et+=Z*w,et+=H*z,et+=J*k,et+=B*(5*v),X+=et>>>13,et&=8191;var st=X;st+=x*v,st+=T*l,st+=R*gt,st+=$*lt,st+=Q*ut,X=st>>>13,st&=8191,st+=V*ht,st+=Z*q,st+=H*w,st+=J*z,st+=B*k,X+=st>>>13,st&=8191,X=(X<<2)+X|0,X=X+rt|0,rt=X&8191,X=X>>>13,_+=X,x=rt,T=_,R=W,$=D,Q=U,V=L,Z=p,H=F,J=et,B=st,f+=16,y-=16}this._h[0]=x,this._h[1]=T,this._h[2]=R,this._h[3]=$,this._h[4]=Q,this._h[5]=V,this._h[6]=Z,this._h[7]=H,this._h[8]=J,this._h[9]=B},h.prototype.finish=function(u,f){f===void 0&&(f=0);var y=new Uint16Array(10),A,x,T,R;if(this._leftover){for(R=this._leftover,this._buffer[R++]=1;R<16;R++)this._buffer[R]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(A=this._h[1]>>>13,this._h[1]&=8191,R=2;R<10;R++)this._h[R]+=A,A=this._h[R]>>>13,this._h[R]&=8191;for(this._h[0]+=A*5,A=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=A,A=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=A,y[0]=this._h[0]+5,A=y[0]>>>13,y[0]&=8191,R=1;R<10;R++)y[R]=this._h[R]+A,A=y[R]>>>13,y[R]&=8191;for(y[9]-=8192,x=(A^1)-1,R=0;R<10;R++)y[R]&=x;for(x=~x,R=0;R<10;R++)this._h[R]=this._h[R]&x|y[R];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,T=this._h[0]+this._pad[0],this._h[0]=T&65535,R=1;R<8;R++)T=(this._h[R]+this._pad[R]|0)+(T>>>16)|0,this._h[R]=T&65535;return u[f+0]=this._h[0]>>>0,u[f+1]=this._h[0]>>>8,u[f+2]=this._h[1]>>>0,u[f+3]=this._h[1]>>>8,u[f+4]=this._h[2]>>>0,u[f+5]=this._h[2]>>>8,u[f+6]=this._h[3]>>>0,u[f+7]=this._h[3]>>>8,u[f+8]=this._h[4]>>>0,u[f+9]=this._h[4]>>>8,u[f+10]=this._h[5]>>>0,u[f+11]=this._h[5]>>>8,u[f+12]=this._h[6]>>>0,u[f+13]=this._h[6]>>>8,u[f+14]=this._h[7]>>>0,u[f+15]=this._h[7]>>>8,this._finished=!0,this},h.prototype.update=function(u){var f=0,y=u.length,A;if(this._leftover){A=16-this._leftover,A>y&&(A=y);for(var x=0;x<A;x++)this._buffer[this._leftover+x]=u[f+x];if(y-=A,f+=A,this._leftover+=A,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(y>=16&&(A=y-y%16,this._blocks(u,f,A),f+=A,y-=A),y){for(var x=0;x<y;x++)this._buffer[this._leftover+x]=u[f+x];this._leftover+=y}return this},h.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var u=new Uint8Array(16);return this.finish(u),u},h.prototype.clean=function(){return e.wipe(this._buffer),e.wipe(this._r),e.wipe(this._h),e.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},h}();r.Poly1305=n;function s(h,u){var f=new n(h);f.update(u);var y=f.digest();return f.clean(),y}r.oneTimeAuth=s;function a(h,u){return h.length!==r.DIGEST_LENGTH||u.length!==r.DIGEST_LENGTH?!1:t.equal(h,u)}r.equal=a}(Ah)),Ah}var Ad;function p6(){return Ad||(Ad=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=f6(),e=d6(),n=ui(),s=So(),a=Au();r.KEY_LENGTH=32,r.NONCE_LENGTH=12,r.TAG_LENGTH=16;var h=new Uint8Array(16),u=function(){function f(y){if(this.nonceLength=r.NONCE_LENGTH,this.tagLength=r.TAG_LENGTH,y.length!==r.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(y)}return f.prototype.seal=function(y,A,x,T){if(y.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var R=new Uint8Array(16);R.set(y,R.length-y.length);var $=new Uint8Array(32);t.stream(this._key,R,$,4);var Q=A.length+this.tagLength,V;if(T){if(T.length!==Q)throw new Error("ChaCha20Poly1305: incorrect destination length");V=T}else V=new Uint8Array(Q);return t.streamXOR(this._key,R,A,V,4),this._authenticate(V.subarray(V.length-this.tagLength,V.length),$,V.subarray(0,V.length-this.tagLength),x),n.wipe(R),V},f.prototype.open=function(y,A,x,T){if(y.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(A.length<this.tagLength)return null;var R=new Uint8Array(16);R.set(y,R.length-y.length);var $=new Uint8Array(32);t.stream(this._key,R,$,4);var Q=new Uint8Array(this.tagLength);if(this._authenticate(Q,$,A.subarray(0,A.length-this.tagLength),x),!a.equal(Q,A.subarray(A.length-this.tagLength,A.length)))return null;var V=A.length-this.tagLength,Z;if(T){if(T.length!==V)throw new Error("ChaCha20Poly1305: incorrect destination length");Z=T}else Z=new Uint8Array(V);return t.streamXOR(this._key,R,A.subarray(0,A.length-this.tagLength),Z,4),n.wipe(R),Z},f.prototype.clean=function(){return n.wipe(this._key),this},f.prototype._authenticate=function(y,A,x,T){var R=new e.Poly1305(A);T&&(R.update(T),T.length%16>0&&R.update(h.subarray(T.length%16))),R.update(x),x.length%16>0&&R.update(h.subarray(x.length%16));var $=new Uint8Array(8);T&&s.writeUint64LE(T.length,$),R.update($),s.writeUint64LE(x.length,$),R.update($);for(var Q=R.digest(),V=0;V<Q.length;V++)y[V]=Q[V];R.clean(),n.wipe(Q),n.wipe($)},f}();r.ChaCha20Poly1305=u}(bh)),bh}var m0=p6(),ba={},as={},_a={},Ed;function g6(){if(Ed)return _a;Ed=1,Object.defineProperty(_a,"__esModule",{value:!0});function r(t){return typeof t.saveState<"u"&&typeof t.restoreState<"u"&&typeof t.cleanSavedState<"u"}return _a.isSerializableHash=r,_a}var Id;function m6(){if(Id)return as;Id=1,Object.defineProperty(as,"__esModule",{value:!0});var r=g6(),t=Au(),e=ui(),n=function(){function a(h,u){this._finished=!1,this._inner=new h,this._outer=new h,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var f=new Uint8Array(this.blockSize);u.length>this.blockSize?this._inner.update(u).finish(f).clean():f.set(u);for(var y=0;y<f.length;y++)f[y]^=54;this._inner.update(f);for(var y=0;y<f.length;y++)f[y]^=106;this._outer.update(f),r.isSerializableHash(this._inner)&&r.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),e.wipe(f)}return a.prototype.reset=function(){if(!r.isSerializableHash(this._inner)||!r.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},a.prototype.clean=function(){r.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),r.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},a.prototype.update=function(h){return this._inner.update(h),this},a.prototype.finish=function(h){return this._finished?(this._outer.finish(h),this):(this._inner.finish(h),this._outer.update(h.subarray(0,this.digestLength)).finish(h),this._finished=!0,this)},a.prototype.digest=function(){var h=new Uint8Array(this.digestLength);return this.finish(h),h},a.prototype.saveState=function(){if(!r.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},a.prototype.restoreState=function(h){if(!r.isSerializableHash(this._inner)||!r.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(h),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},a.prototype.cleanSavedState=function(h){if(!r.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(h)},a}();as.HMAC=n;function s(a,h,u){var f=new n(a,h);f.update(u);var y=f.digest();return f.clean(),y}return as.hmac=s,as.equal=t.equal,as}var Sd;function v6(){if(Sd)return ba;Sd=1,Object.defineProperty(ba,"__esModule",{value:!0});var r=m6(),t=ui(),e=function(){function n(s,a,h,u){h===void 0&&(h=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=s,this._info=u;var f=r.hmac(this._hash,h,a);this._hmac=new r.HMAC(s,f),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return n.prototype._fillBuffer=function(){this._counter[0]++;var s=this._counter[0];if(s===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),s>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},n.prototype.expand=function(s){for(var a=new Uint8Array(s),h=0;h<a.length;h++)this._bufpos===this._buffer.length&&this._fillBuffer(),a[h]=this._buffer[this._bufpos++];return a},n.prototype.clean=function(){this._hmac.clean(),t.wipe(this._buffer),t.wipe(this._counter),this._bufpos=0},n}();return ba.HKDF=e,ba}var y6=v6(),Eh={},Xs={},Zs={},xd;function w6(){if(xd)return Zs;xd=1,Object.defineProperty(Zs,"__esModule",{value:!0}),Zs.BrowserRandomSource=void 0;const r=65536;class t{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const n=typeof self<"u"?self.crypto||self.msCrypto:null;n&&n.getRandomValues!==void 0&&(this._crypto=n,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(n){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const s=new Uint8Array(n);for(let a=0;a<s.length;a+=r)this._crypto.getRandomValues(s.subarray(a,a+Math.min(s.length-a,r)));return s}}return Zs.BrowserRandomSource=t,Zs}function b6(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var to={},Md;function _6(){if(Md)return to;Md=1,Object.defineProperty(to,"__esModule",{value:!0}),to.NodeRandomSource=void 0;const r=ui();class t{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof b6<"u"){const n=Gb;n&&n.randomBytes&&(this._crypto=n,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(n){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let s=this._crypto.randomBytes(n);if(s.length!==n)throw new Error("NodeRandomSource: got fewer bytes than requested");const a=new Uint8Array(n);for(let h=0;h<a.length;h++)a[h]=s[h];return(0,r.wipe)(s),a}}return to.NodeRandomSource=t,to}var Pd;function A6(){if(Pd)return Xs;Pd=1,Object.defineProperty(Xs,"__esModule",{value:!0}),Xs.SystemRandomSource=void 0;const r=w6(),t=_6();class e{constructor(){if(this.isAvailable=!1,this.name="",this._source=new r.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new t.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(s){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(s)}}return Xs.SystemRandomSource=e,Xs}var Cd;function Eu(){return Cd||(Cd=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.randomStringForEntropy=r.randomString=r.randomUint32=r.randomBytes=r.defaultRandomSource=void 0;const t=A6(),e=So(),n=ui();r.defaultRandomSource=new t.SystemRandomSource;function s(y,A=r.defaultRandomSource){return A.randomBytes(y)}r.randomBytes=s;function a(y=r.defaultRandomSource){const A=s(4,y),x=(0,e.readUint32LE)(A);return(0,n.wipe)(A),x}r.randomUint32=a;const h="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function u(y,A=h,x=r.defaultRandomSource){if(A.length<2)throw new Error("randomString charset is too short");if(A.length>256)throw new Error("randomString charset is too long");let T="";const R=A.length,$=256-256%R;for(;y>0;){const Q=s(Math.ceil(y*256/$),x);for(let V=0;V<Q.length&&y>0;V++){const Z=Q[V];Z<$&&(T+=A.charAt(Z%R),y--)}(0,n.wipe)(Q)}return T}r.randomString=u;function f(y,A=h,x=r.defaultRandomSource){const T=Math.ceil(y/(Math.log(A.length)/Math.LN2));return u(T,A,x)}r.randomStringForEntropy=f}(Eh)),Eh}var xo=Eu(),Ih={},Nd;function E6(){return Nd||(Nd=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=So(),e=ui();r.DIGEST_LENGTH=32,r.BLOCK_SIZE=64;var n=function(){function u(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){e.wipe(this._buffer),e.wipe(this._temp),this.reset()},u.prototype.update=function(f,y){if(y===void 0&&(y=f.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var A=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&y>0;)this._buffer[this._bufferLength++]=f[A++],y--;this._bufferLength===this.blockSize&&(a(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(A=a(this._temp,this._state,f,A,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=f[A++],y--;return this},u.prototype.finish=function(f){if(!this._finished){var y=this._bytesHashed,A=this._bufferLength,x=y/536870912|0,T=y<<3,R=y%64<56?64:128;this._buffer[A]=128;for(var $=A+1;$<R-8;$++)this._buffer[$]=0;t.writeUint32BE(x,this._buffer,R-8),t.writeUint32BE(T,this._buffer,R-4),a(this._temp,this._state,this._buffer,0,R),this._finished=!0}for(var $=0;$<this.digestLength/4;$++)t.writeUint32BE(this._state[$],f,$*4);return this},u.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(f){return this._state.set(f.state),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(f){e.wipe(f.state),f.buffer&&e.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},u}();r.SHA256=n;var s=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function a(u,f,y,A,x){for(;x>=64;){for(var T=f[0],R=f[1],$=f[2],Q=f[3],V=f[4],Z=f[5],H=f[6],J=f[7],B=0;B<16;B++){var k=A+B*4;u[B]=t.readUint32BE(y,k)}for(var B=16;B<64;B++){var z=u[B-2],w=(z>>>17|z<<15)^(z>>>19|z<<13)^z>>>10;z=u[B-15];var q=(z>>>7|z<<25)^(z>>>18|z<<14)^z>>>3;u[B]=(w+u[B-7]|0)+(q+u[B-16]|0)}for(var B=0;B<64;B++){var w=(((V>>>6|V<<26)^(V>>>11|V<<21)^(V>>>25|V<<7))+(V&Z^~V&H)|0)+(J+(s[B]+u[B]|0)|0)|0,q=((T>>>2|T<<30)^(T>>>13|T<<19)^(T>>>22|T<<10))+(T&R^T&$^R&$)|0;J=H,H=Z,Z=V,V=Q+w|0,Q=$,$=R,R=T,T=w+q|0}f[0]+=T,f[1]+=R,f[2]+=$,f[3]+=Q,f[4]+=V,f[5]+=Z,f[6]+=H,f[7]+=J,A+=64,x-=64}return A}function h(u){var f=new n;f.update(u);var y=f.digest();return f.clean(),y}r.hash=h}(Ih)),Ih}var Xa=E6(),Sh={},Rd;function I6(){return Rd||(Rd=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.sharedKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.scalarMultBase=r.scalarMult=r.SHARED_KEY_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=void 0;const t=Eu(),e=ui();r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=32,r.SHARED_KEY_LENGTH=32;function n(B){const k=new Float64Array(16);if(B)for(let z=0;z<B.length;z++)k[z]=B[z];return k}const s=new Uint8Array(32);s[0]=9;const a=n([56129,1]);function h(B){let k=1;for(let z=0;z<16;z++){let w=B[z]+k+65535;k=Math.floor(w/65536),B[z]=w-k*65536}B[0]+=k-1+37*(k-1)}function u(B,k,z){const w=~(z-1);for(let q=0;q<16;q++){const ht=w&(B[q]^k[q]);B[q]^=ht,k[q]^=ht}}function f(B,k){const z=n(),w=n();for(let q=0;q<16;q++)w[q]=k[q];h(w),h(w),h(w);for(let q=0;q<2;q++){z[0]=w[0]-65517;for(let ut=1;ut<15;ut++)z[ut]=w[ut]-65535-(z[ut-1]>>16&1),z[ut-1]&=65535;z[15]=w[15]-32767-(z[14]>>16&1);const ht=z[15]>>16&1;z[14]&=65535,u(w,z,1-ht)}for(let q=0;q<16;q++)B[2*q]=w[q]&255,B[2*q+1]=w[q]>>8}function y(B,k){for(let z=0;z<16;z++)B[z]=k[2*z]+(k[2*z+1]<<8);B[15]&=32767}function A(B,k,z){for(let w=0;w<16;w++)B[w]=k[w]+z[w]}function x(B,k,z){for(let w=0;w<16;w++)B[w]=k[w]-z[w]}function T(B,k,z){let w,q,ht=0,ut=0,lt=0,gt=0,l=0,v=0,m=0,b=0,E=0,P=0,O=0,S=0,d=0,C=0,X=0,rt=0,_=0,W=0,D=0,U=0,L=0,p=0,F=0,et=0,st=0,at=0,It=0,xt=0,At=0,me=0,Ut=0,Et=z[0],Ot=z[1],yt=z[2],wt=z[3],Bt=z[4],mt=z[5],bt=z[6],Tt=z[7],_t=z[8],St=z[9],Wt=z[10],Mt=z[11],Ct=z[12],ee=z[13],Nt=z[14],Rt=z[15];w=k[0],ht+=w*Et,ut+=w*Ot,lt+=w*yt,gt+=w*wt,l+=w*Bt,v+=w*mt,m+=w*bt,b+=w*Tt,E+=w*_t,P+=w*St,O+=w*Wt,S+=w*Mt,d+=w*Ct,C+=w*ee,X+=w*Nt,rt+=w*Rt,w=k[1],ut+=w*Et,lt+=w*Ot,gt+=w*yt,l+=w*wt,v+=w*Bt,m+=w*mt,b+=w*bt,E+=w*Tt,P+=w*_t,O+=w*St,S+=w*Wt,d+=w*Mt,C+=w*Ct,X+=w*ee,rt+=w*Nt,_+=w*Rt,w=k[2],lt+=w*Et,gt+=w*Ot,l+=w*yt,v+=w*wt,m+=w*Bt,b+=w*mt,E+=w*bt,P+=w*Tt,O+=w*_t,S+=w*St,d+=w*Wt,C+=w*Mt,X+=w*Ct,rt+=w*ee,_+=w*Nt,W+=w*Rt,w=k[3],gt+=w*Et,l+=w*Ot,v+=w*yt,m+=w*wt,b+=w*Bt,E+=w*mt,P+=w*bt,O+=w*Tt,S+=w*_t,d+=w*St,C+=w*Wt,X+=w*Mt,rt+=w*Ct,_+=w*ee,W+=w*Nt,D+=w*Rt,w=k[4],l+=w*Et,v+=w*Ot,m+=w*yt,b+=w*wt,E+=w*Bt,P+=w*mt,O+=w*bt,S+=w*Tt,d+=w*_t,C+=w*St,X+=w*Wt,rt+=w*Mt,_+=w*Ct,W+=w*ee,D+=w*Nt,U+=w*Rt,w=k[5],v+=w*Et,m+=w*Ot,b+=w*yt,E+=w*wt,P+=w*Bt,O+=w*mt,S+=w*bt,d+=w*Tt,C+=w*_t,X+=w*St,rt+=w*Wt,_+=w*Mt,W+=w*Ct,D+=w*ee,U+=w*Nt,L+=w*Rt,w=k[6],m+=w*Et,b+=w*Ot,E+=w*yt,P+=w*wt,O+=w*Bt,S+=w*mt,d+=w*bt,C+=w*Tt,X+=w*_t,rt+=w*St,_+=w*Wt,W+=w*Mt,D+=w*Ct,U+=w*ee,L+=w*Nt,p+=w*Rt,w=k[7],b+=w*Et,E+=w*Ot,P+=w*yt,O+=w*wt,S+=w*Bt,d+=w*mt,C+=w*bt,X+=w*Tt,rt+=w*_t,_+=w*St,W+=w*Wt,D+=w*Mt,U+=w*Ct,L+=w*ee,p+=w*Nt,F+=w*Rt,w=k[8],E+=w*Et,P+=w*Ot,O+=w*yt,S+=w*wt,d+=w*Bt,C+=w*mt,X+=w*bt,rt+=w*Tt,_+=w*_t,W+=w*St,D+=w*Wt,U+=w*Mt,L+=w*Ct,p+=w*ee,F+=w*Nt,et+=w*Rt,w=k[9],P+=w*Et,O+=w*Ot,S+=w*yt,d+=w*wt,C+=w*Bt,X+=w*mt,rt+=w*bt,_+=w*Tt,W+=w*_t,D+=w*St,U+=w*Wt,L+=w*Mt,p+=w*Ct,F+=w*ee,et+=w*Nt,st+=w*Rt,w=k[10],O+=w*Et,S+=w*Ot,d+=w*yt,C+=w*wt,X+=w*Bt,rt+=w*mt,_+=w*bt,W+=w*Tt,D+=w*_t,U+=w*St,L+=w*Wt,p+=w*Mt,F+=w*Ct,et+=w*ee,st+=w*Nt,at+=w*Rt,w=k[11],S+=w*Et,d+=w*Ot,C+=w*yt,X+=w*wt,rt+=w*Bt,_+=w*mt,W+=w*bt,D+=w*Tt,U+=w*_t,L+=w*St,p+=w*Wt,F+=w*Mt,et+=w*Ct,st+=w*ee,at+=w*Nt,It+=w*Rt,w=k[12],d+=w*Et,C+=w*Ot,X+=w*yt,rt+=w*wt,_+=w*Bt,W+=w*mt,D+=w*bt,U+=w*Tt,L+=w*_t,p+=w*St,F+=w*Wt,et+=w*Mt,st+=w*Ct,at+=w*ee,It+=w*Nt,xt+=w*Rt,w=k[13],C+=w*Et,X+=w*Ot,rt+=w*yt,_+=w*wt,W+=w*Bt,D+=w*mt,U+=w*bt,L+=w*Tt,p+=w*_t,F+=w*St,et+=w*Wt,st+=w*Mt,at+=w*Ct,It+=w*ee,xt+=w*Nt,At+=w*Rt,w=k[14],X+=w*Et,rt+=w*Ot,_+=w*yt,W+=w*wt,D+=w*Bt,U+=w*mt,L+=w*bt,p+=w*Tt,F+=w*_t,et+=w*St,st+=w*Wt,at+=w*Mt,It+=w*Ct,xt+=w*ee,At+=w*Nt,me+=w*Rt,w=k[15],rt+=w*Et,_+=w*Ot,W+=w*yt,D+=w*wt,U+=w*Bt,L+=w*mt,p+=w*bt,F+=w*Tt,et+=w*_t,st+=w*St,at+=w*Wt,It+=w*Mt,xt+=w*Ct,At+=w*ee,me+=w*Nt,Ut+=w*Rt,ht+=38*_,ut+=38*W,lt+=38*D,gt+=38*U,l+=38*L,v+=38*p,m+=38*F,b+=38*et,E+=38*st,P+=38*at,O+=38*It,S+=38*xt,d+=38*At,C+=38*me,X+=38*Ut,q=1,w=ht+q+65535,q=Math.floor(w/65536),ht=w-q*65536,w=ut+q+65535,q=Math.floor(w/65536),ut=w-q*65536,w=lt+q+65535,q=Math.floor(w/65536),lt=w-q*65536,w=gt+q+65535,q=Math.floor(w/65536),gt=w-q*65536,w=l+q+65535,q=Math.floor(w/65536),l=w-q*65536,w=v+q+65535,q=Math.floor(w/65536),v=w-q*65536,w=m+q+65535,q=Math.floor(w/65536),m=w-q*65536,w=b+q+65535,q=Math.floor(w/65536),b=w-q*65536,w=E+q+65535,q=Math.floor(w/65536),E=w-q*65536,w=P+q+65535,q=Math.floor(w/65536),P=w-q*65536,w=O+q+65535,q=Math.floor(w/65536),O=w-q*65536,w=S+q+65535,q=Math.floor(w/65536),S=w-q*65536,w=d+q+65535,q=Math.floor(w/65536),d=w-q*65536,w=C+q+65535,q=Math.floor(w/65536),C=w-q*65536,w=X+q+65535,q=Math.floor(w/65536),X=w-q*65536,w=rt+q+65535,q=Math.floor(w/65536),rt=w-q*65536,ht+=q-1+37*(q-1),q=1,w=ht+q+65535,q=Math.floor(w/65536),ht=w-q*65536,w=ut+q+65535,q=Math.floor(w/65536),ut=w-q*65536,w=lt+q+65535,q=Math.floor(w/65536),lt=w-q*65536,w=gt+q+65535,q=Math.floor(w/65536),gt=w-q*65536,w=l+q+65535,q=Math.floor(w/65536),l=w-q*65536,w=v+q+65535,q=Math.floor(w/65536),v=w-q*65536,w=m+q+65535,q=Math.floor(w/65536),m=w-q*65536,w=b+q+65535,q=Math.floor(w/65536),b=w-q*65536,w=E+q+65535,q=Math.floor(w/65536),E=w-q*65536,w=P+q+65535,q=Math.floor(w/65536),P=w-q*65536,w=O+q+65535,q=Math.floor(w/65536),O=w-q*65536,w=S+q+65535,q=Math.floor(w/65536),S=w-q*65536,w=d+q+65535,q=Math.floor(w/65536),d=w-q*65536,w=C+q+65535,q=Math.floor(w/65536),C=w-q*65536,w=X+q+65535,q=Math.floor(w/65536),X=w-q*65536,w=rt+q+65535,q=Math.floor(w/65536),rt=w-q*65536,ht+=q-1+37*(q-1),B[0]=ht,B[1]=ut,B[2]=lt,B[3]=gt,B[4]=l,B[5]=v,B[6]=m,B[7]=b,B[8]=E,B[9]=P,B[10]=O,B[11]=S,B[12]=d,B[13]=C,B[14]=X,B[15]=rt}function R(B,k){T(B,k,k)}function $(B,k){const z=n();for(let w=0;w<16;w++)z[w]=k[w];for(let w=253;w>=0;w--)R(z,z),w!==2&&w!==4&&T(z,z,k);for(let w=0;w<16;w++)B[w]=z[w]}function Q(B,k){const z=new Uint8Array(32),w=new Float64Array(80),q=n(),ht=n(),ut=n(),lt=n(),gt=n(),l=n();for(let E=0;E<31;E++)z[E]=B[E];z[31]=B[31]&127|64,z[0]&=248,y(w,k);for(let E=0;E<16;E++)ht[E]=w[E];q[0]=lt[0]=1;for(let E=254;E>=0;--E){const P=z[E>>>3]>>>(E&7)&1;u(q,ht,P),u(ut,lt,P),A(gt,q,ut),x(q,q,ut),A(ut,ht,lt),x(ht,ht,lt),R(lt,gt),R(l,q),T(q,ut,q),T(ut,ht,gt),A(gt,q,ut),x(q,q,ut),R(ht,q),x(ut,lt,l),T(q,ut,a),A(q,q,lt),T(ut,ut,q),T(q,lt,l),T(lt,ht,w),R(ht,gt),u(q,ht,P),u(ut,lt,P)}for(let E=0;E<16;E++)w[E+16]=q[E],w[E+32]=ut[E],w[E+48]=ht[E],w[E+64]=lt[E];const v=w.subarray(32),m=w.subarray(16);$(v,v),T(m,m,v);const b=new Uint8Array(32);return f(b,m),b}r.scalarMult=Q;function V(B){return Q(B,s)}r.scalarMultBase=V;function Z(B){if(B.length!==r.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${r.SECRET_KEY_LENGTH} bytes`);const k=new Uint8Array(B);return{publicKey:V(k),secretKey:k}}r.generateKeyPairFromSeed=Z;function H(B){const k=(0,t.randomBytes)(32,B),z=Z(k);return(0,e.wipe)(k),z}r.generateKeyPair=H;function J(B,k,z=!1){if(B.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(k.length!==r.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const w=Q(B,k);if(z){let q=0;for(let ht=0;ht<w.length;ht++)q|=w[ht];if(q===0)throw new Error("X25519: invalid shared key")}return w}r.sharedKey=J}(Sh)),Sh}var v0=I6(),xh={},Mh={},Od;function S6(){return Od||(Od=1,function(r){Object.defineProperty(r,"__esModule",{value:!0});var t=So(),e=ui();r.DIGEST_LENGTH=64,r.BLOCK_SIZE=128;var n=function(){function u(){this.digestLength=r.DIGEST_LENGTH,this.blockSize=r.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return u.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},u.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},u.prototype.clean=function(){e.wipe(this._buffer),e.wipe(this._tempHi),e.wipe(this._tempLo),this.reset()},u.prototype.update=function(f,y){if(y===void 0&&(y=f.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var A=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<r.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=f[A++],y--;this._bufferLength===this.blockSize&&(a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(A=a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,f,A,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=f[A++],y--;return this},u.prototype.finish=function(f){if(!this._finished){var y=this._bytesHashed,A=this._bufferLength,x=y/536870912|0,T=y<<3,R=y%128<112?128:256;this._buffer[A]=128;for(var $=A+1;$<R-8;$++)this._buffer[$]=0;t.writeUint32BE(x,this._buffer,R-8),t.writeUint32BE(T,this._buffer,R-4),a(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,R),this._finished=!0}for(var $=0;$<this.digestLength/8;$++)t.writeUint32BE(this._stateHi[$],f,$*8),t.writeUint32BE(this._stateLo[$],f,$*8+4);return this},u.prototype.digest=function(){var f=new Uint8Array(this.digestLength);return this.finish(f),f},u.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},u.prototype.restoreState=function(f){return this._stateHi.set(f.stateHi),this._stateLo.set(f.stateLo),this._bufferLength=f.bufferLength,f.buffer&&this._buffer.set(f.buffer),this._bytesHashed=f.bytesHashed,this._finished=!1,this},u.prototype.cleanSavedState=function(f){e.wipe(f.stateHi),e.wipe(f.stateLo),f.buffer&&e.wipe(f.buffer),f.bufferLength=0,f.bytesHashed=0},u}();r.SHA512=n;var s=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function a(u,f,y,A,x,T,R){for(var $=y[0],Q=y[1],V=y[2],Z=y[3],H=y[4],J=y[5],B=y[6],k=y[7],z=A[0],w=A[1],q=A[2],ht=A[3],ut=A[4],lt=A[5],gt=A[6],l=A[7],v,m,b,E,P,O,S,d;R>=128;){for(var C=0;C<16;C++){var X=8*C+T;u[C]=t.readUint32BE(x,X),f[C]=t.readUint32BE(x,X+4)}for(var C=0;C<80;C++){var rt=$,_=Q,W=V,D=Z,U=H,L=J,p=B,F=k,et=z,st=w,at=q,It=ht,xt=ut,At=lt,me=gt,Ut=l;if(v=k,m=l,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=(H>>>14|ut<<18)^(H>>>18|ut<<14)^(ut>>>9|H<<23),m=(ut>>>14|H<<18)^(ut>>>18|H<<14)^(H>>>9|ut<<23),P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,v=H&J^~H&B,m=ut&lt^~ut&gt,P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,v=s[C*2],m=s[C*2+1],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,v=u[C%16],m=f[C%16],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,b=S&65535|d<<16,E=P&65535|O<<16,v=b,m=E,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=($>>>28|z<<4)^(z>>>2|$<<30)^(z>>>7|$<<25),m=(z>>>28|$<<4)^($>>>2|z<<30)^($>>>7|z<<25),P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,v=$&Q^$&V^Q&V,m=z&w^z&q^w&q,P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,F=S&65535|d<<16,Ut=P&65535|O<<16,v=D,m=It,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=b,m=E,P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,D=S&65535|d<<16,It=P&65535|O<<16,Q=rt,V=_,Z=W,H=D,J=U,B=L,k=p,$=F,w=et,q=st,ht=at,ut=It,lt=xt,gt=At,l=me,z=Ut,C%16===15)for(var X=0;X<16;X++)v=u[X],m=f[X],P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=u[(X+9)%16],m=f[(X+9)%16],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,b=u[(X+1)%16],E=f[(X+1)%16],v=(b>>>1|E<<31)^(b>>>8|E<<24)^b>>>7,m=(E>>>1|b<<31)^(E>>>8|b<<24)^(E>>>7|b<<25),P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,b=u[(X+14)%16],E=f[(X+14)%16],v=(b>>>19|E<<13)^(E>>>29|b<<3)^b>>>6,m=(E>>>19|b<<13)^(b>>>29|E<<3)^(E>>>6|b<<26),P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,u[X]=S&65535|d<<16,f[X]=P&65535|O<<16}v=$,m=z,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[0],m=A[0],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[0]=$=S&65535|d<<16,A[0]=z=P&65535|O<<16,v=Q,m=w,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[1],m=A[1],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[1]=Q=S&65535|d<<16,A[1]=w=P&65535|O<<16,v=V,m=q,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[2],m=A[2],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[2]=V=S&65535|d<<16,A[2]=q=P&65535|O<<16,v=Z,m=ht,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[3],m=A[3],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[3]=Z=S&65535|d<<16,A[3]=ht=P&65535|O<<16,v=H,m=ut,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[4],m=A[4],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[4]=H=S&65535|d<<16,A[4]=ut=P&65535|O<<16,v=J,m=lt,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[5],m=A[5],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[5]=J=S&65535|d<<16,A[5]=lt=P&65535|O<<16,v=B,m=gt,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[6],m=A[6],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[6]=B=S&65535|d<<16,A[6]=gt=P&65535|O<<16,v=k,m=l,P=m&65535,O=m>>>16,S=v&65535,d=v>>>16,v=y[7],m=A[7],P+=m&65535,O+=m>>>16,S+=v&65535,d+=v>>>16,O+=P>>>16,S+=O>>>16,d+=S>>>16,y[7]=k=S&65535|d<<16,A[7]=l=P&65535|O<<16,T+=128,R-=128}return T}function h(u){var f=new n;f.update(u);var y=f.digest();return f.clean(),y}r.hash=h}(Mh)),Mh}var Td;function x6(){return Td||(Td=1,function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.convertSecretKeyToX25519=r.convertPublicKeyToX25519=r.verify=r.sign=r.extractPublicKeyFromSecretKey=r.generateKeyPair=r.generateKeyPairFromSeed=r.SEED_LENGTH=r.SECRET_KEY_LENGTH=r.PUBLIC_KEY_LENGTH=r.SIGNATURE_LENGTH=void 0;const t=Eu(),e=S6(),n=ui();r.SIGNATURE_LENGTH=64,r.PUBLIC_KEY_LENGTH=32,r.SECRET_KEY_LENGTH=64,r.SEED_LENGTH=32;function s(D){const U=new Float64Array(16);if(D)for(let L=0;L<D.length;L++)U[L]=D[L];return U}const a=new Uint8Array(32);a[0]=9;const h=s(),u=s([1]),f=s([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=s([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),A=s([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=s([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),T=s([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function R(D,U){for(let L=0;L<16;L++)D[L]=U[L]|0}function $(D){let U=1;for(let L=0;L<16;L++){let p=D[L]+U+65535;U=Math.floor(p/65536),D[L]=p-U*65536}D[0]+=U-1+37*(U-1)}function Q(D,U,L){const p=~(L-1);for(let F=0;F<16;F++){const et=p&(D[F]^U[F]);D[F]^=et,U[F]^=et}}function V(D,U){const L=s(),p=s();for(let F=0;F<16;F++)p[F]=U[F];$(p),$(p),$(p);for(let F=0;F<2;F++){L[0]=p[0]-65517;for(let st=1;st<15;st++)L[st]=p[st]-65535-(L[st-1]>>16&1),L[st-1]&=65535;L[15]=p[15]-32767-(L[14]>>16&1);const et=L[15]>>16&1;L[14]&=65535,Q(p,L,1-et)}for(let F=0;F<16;F++)D[2*F]=p[F]&255,D[2*F+1]=p[F]>>8}function Z(D,U){let L=0;for(let p=0;p<32;p++)L|=D[p]^U[p];return(1&L-1>>>8)-1}function H(D,U){const L=new Uint8Array(32),p=new Uint8Array(32);return V(L,D),V(p,U),Z(L,p)}function J(D){const U=new Uint8Array(32);return V(U,D),U[0]&1}function B(D,U){for(let L=0;L<16;L++)D[L]=U[2*L]+(U[2*L+1]<<8);D[15]&=32767}function k(D,U,L){for(let p=0;p<16;p++)D[p]=U[p]+L[p]}function z(D,U,L){for(let p=0;p<16;p++)D[p]=U[p]-L[p]}function w(D,U,L){let p,F,et=0,st=0,at=0,It=0,xt=0,At=0,me=0,Ut=0,Et=0,Ot=0,yt=0,wt=0,Bt=0,mt=0,bt=0,Tt=0,_t=0,St=0,Wt=0,Mt=0,Ct=0,ee=0,Nt=0,Rt=0,He=0,se=0,fe=0,or=0,de=0,pe=0,Sr=0,$t=L[0],jt=L[1],Me=L[2],zt=L[3],kt=L[4],Pe=L[5],Ht=L[6],Kt=L[7],_e=L[8],Vt=L[9],Lt=L[10],Ce=L[11],Gt=L[12],Qt=L[13],Ne=L[14],Jt=L[15];p=U[0],et+=p*$t,st+=p*jt,at+=p*Me,It+=p*zt,xt+=p*kt,At+=p*Pe,me+=p*Ht,Ut+=p*Kt,Et+=p*_e,Ot+=p*Vt,yt+=p*Lt,wt+=p*Ce,Bt+=p*Gt,mt+=p*Qt,bt+=p*Ne,Tt+=p*Jt,p=U[1],st+=p*$t,at+=p*jt,It+=p*Me,xt+=p*zt,At+=p*kt,me+=p*Pe,Ut+=p*Ht,Et+=p*Kt,Ot+=p*_e,yt+=p*Vt,wt+=p*Lt,Bt+=p*Ce,mt+=p*Gt,bt+=p*Qt,Tt+=p*Ne,_t+=p*Jt,p=U[2],at+=p*$t,It+=p*jt,xt+=p*Me,At+=p*zt,me+=p*kt,Ut+=p*Pe,Et+=p*Ht,Ot+=p*Kt,yt+=p*_e,wt+=p*Vt,Bt+=p*Lt,mt+=p*Ce,bt+=p*Gt,Tt+=p*Qt,_t+=p*Ne,St+=p*Jt,p=U[3],It+=p*$t,xt+=p*jt,At+=p*Me,me+=p*zt,Ut+=p*kt,Et+=p*Pe,Ot+=p*Ht,yt+=p*Kt,wt+=p*_e,Bt+=p*Vt,mt+=p*Lt,bt+=p*Ce,Tt+=p*Gt,_t+=p*Qt,St+=p*Ne,Wt+=p*Jt,p=U[4],xt+=p*$t,At+=p*jt,me+=p*Me,Ut+=p*zt,Et+=p*kt,Ot+=p*Pe,yt+=p*Ht,wt+=p*Kt,Bt+=p*_e,mt+=p*Vt,bt+=p*Lt,Tt+=p*Ce,_t+=p*Gt,St+=p*Qt,Wt+=p*Ne,Mt+=p*Jt,p=U[5],At+=p*$t,me+=p*jt,Ut+=p*Me,Et+=p*zt,Ot+=p*kt,yt+=p*Pe,wt+=p*Ht,Bt+=p*Kt,mt+=p*_e,bt+=p*Vt,Tt+=p*Lt,_t+=p*Ce,St+=p*Gt,Wt+=p*Qt,Mt+=p*Ne,Ct+=p*Jt,p=U[6],me+=p*$t,Ut+=p*jt,Et+=p*Me,Ot+=p*zt,yt+=p*kt,wt+=p*Pe,Bt+=p*Ht,mt+=p*Kt,bt+=p*_e,Tt+=p*Vt,_t+=p*Lt,St+=p*Ce,Wt+=p*Gt,Mt+=p*Qt,Ct+=p*Ne,ee+=p*Jt,p=U[7],Ut+=p*$t,Et+=p*jt,Ot+=p*Me,yt+=p*zt,wt+=p*kt,Bt+=p*Pe,mt+=p*Ht,bt+=p*Kt,Tt+=p*_e,_t+=p*Vt,St+=p*Lt,Wt+=p*Ce,Mt+=p*Gt,Ct+=p*Qt,ee+=p*Ne,Nt+=p*Jt,p=U[8],Et+=p*$t,Ot+=p*jt,yt+=p*Me,wt+=p*zt,Bt+=p*kt,mt+=p*Pe,bt+=p*Ht,Tt+=p*Kt,_t+=p*_e,St+=p*Vt,Wt+=p*Lt,Mt+=p*Ce,Ct+=p*Gt,ee+=p*Qt,Nt+=p*Ne,Rt+=p*Jt,p=U[9],Ot+=p*$t,yt+=p*jt,wt+=p*Me,Bt+=p*zt,mt+=p*kt,bt+=p*Pe,Tt+=p*Ht,_t+=p*Kt,St+=p*_e,Wt+=p*Vt,Mt+=p*Lt,Ct+=p*Ce,ee+=p*Gt,Nt+=p*Qt,Rt+=p*Ne,He+=p*Jt,p=U[10],yt+=p*$t,wt+=p*jt,Bt+=p*Me,mt+=p*zt,bt+=p*kt,Tt+=p*Pe,_t+=p*Ht,St+=p*Kt,Wt+=p*_e,Mt+=p*Vt,Ct+=p*Lt,ee+=p*Ce,Nt+=p*Gt,Rt+=p*Qt,He+=p*Ne,se+=p*Jt,p=U[11],wt+=p*$t,Bt+=p*jt,mt+=p*Me,bt+=p*zt,Tt+=p*kt,_t+=p*Pe,St+=p*Ht,Wt+=p*Kt,Mt+=p*_e,Ct+=p*Vt,ee+=p*Lt,Nt+=p*Ce,Rt+=p*Gt,He+=p*Qt,se+=p*Ne,fe+=p*Jt,p=U[12],Bt+=p*$t,mt+=p*jt,bt+=p*Me,Tt+=p*zt,_t+=p*kt,St+=p*Pe,Wt+=p*Ht,Mt+=p*Kt,Ct+=p*_e,ee+=p*Vt,Nt+=p*Lt,Rt+=p*Ce,He+=p*Gt,se+=p*Qt,fe+=p*Ne,or+=p*Jt,p=U[13],mt+=p*$t,bt+=p*jt,Tt+=p*Me,_t+=p*zt,St+=p*kt,Wt+=p*Pe,Mt+=p*Ht,Ct+=p*Kt,ee+=p*_e,Nt+=p*Vt,Rt+=p*Lt,He+=p*Ce,se+=p*Gt,fe+=p*Qt,or+=p*Ne,de+=p*Jt,p=U[14],bt+=p*$t,Tt+=p*jt,_t+=p*Me,St+=p*zt,Wt+=p*kt,Mt+=p*Pe,Ct+=p*Ht,ee+=p*Kt,Nt+=p*_e,Rt+=p*Vt,He+=p*Lt,se+=p*Ce,fe+=p*Gt,or+=p*Qt,de+=p*Ne,pe+=p*Jt,p=U[15],Tt+=p*$t,_t+=p*jt,St+=p*Me,Wt+=p*zt,Mt+=p*kt,Ct+=p*Pe,ee+=p*Ht,Nt+=p*Kt,Rt+=p*_e,He+=p*Vt,se+=p*Lt,fe+=p*Ce,or+=p*Gt,de+=p*Qt,pe+=p*Ne,Sr+=p*Jt,et+=38*_t,st+=38*St,at+=38*Wt,It+=38*Mt,xt+=38*Ct,At+=38*ee,me+=38*Nt,Ut+=38*Rt,Et+=38*He,Ot+=38*se,yt+=38*fe,wt+=38*or,Bt+=38*de,mt+=38*pe,bt+=38*Sr,F=1,p=et+F+65535,F=Math.floor(p/65536),et=p-F*65536,p=st+F+65535,F=Math.floor(p/65536),st=p-F*65536,p=at+F+65535,F=Math.floor(p/65536),at=p-F*65536,p=It+F+65535,F=Math.floor(p/65536),It=p-F*65536,p=xt+F+65535,F=Math.floor(p/65536),xt=p-F*65536,p=At+F+65535,F=Math.floor(p/65536),At=p-F*65536,p=me+F+65535,F=Math.floor(p/65536),me=p-F*65536,p=Ut+F+65535,F=Math.floor(p/65536),Ut=p-F*65536,p=Et+F+65535,F=Math.floor(p/65536),Et=p-F*65536,p=Ot+F+65535,F=Math.floor(p/65536),Ot=p-F*65536,p=yt+F+65535,F=Math.floor(p/65536),yt=p-F*65536,p=wt+F+65535,F=Math.floor(p/65536),wt=p-F*65536,p=Bt+F+65535,F=Math.floor(p/65536),Bt=p-F*65536,p=mt+F+65535,F=Math.floor(p/65536),mt=p-F*65536,p=bt+F+65535,F=Math.floor(p/65536),bt=p-F*65536,p=Tt+F+65535,F=Math.floor(p/65536),Tt=p-F*65536,et+=F-1+37*(F-1),F=1,p=et+F+65535,F=Math.floor(p/65536),et=p-F*65536,p=st+F+65535,F=Math.floor(p/65536),st=p-F*65536,p=at+F+65535,F=Math.floor(p/65536),at=p-F*65536,p=It+F+65535,F=Math.floor(p/65536),It=p-F*65536,p=xt+F+65535,F=Math.floor(p/65536),xt=p-F*65536,p=At+F+65535,F=Math.floor(p/65536),At=p-F*65536,p=me+F+65535,F=Math.floor(p/65536),me=p-F*65536,p=Ut+F+65535,F=Math.floor(p/65536),Ut=p-F*65536,p=Et+F+65535,F=Math.floor(p/65536),Et=p-F*65536,p=Ot+F+65535,F=Math.floor(p/65536),Ot=p-F*65536,p=yt+F+65535,F=Math.floor(p/65536),yt=p-F*65536,p=wt+F+65535,F=Math.floor(p/65536),wt=p-F*65536,p=Bt+F+65535,F=Math.floor(p/65536),Bt=p-F*65536,p=mt+F+65535,F=Math.floor(p/65536),mt=p-F*65536,p=bt+F+65535,F=Math.floor(p/65536),bt=p-F*65536,p=Tt+F+65535,F=Math.floor(p/65536),Tt=p-F*65536,et+=F-1+37*(F-1),D[0]=et,D[1]=st,D[2]=at,D[3]=It,D[4]=xt,D[5]=At,D[6]=me,D[7]=Ut,D[8]=Et,D[9]=Ot,D[10]=yt,D[11]=wt,D[12]=Bt,D[13]=mt,D[14]=bt,D[15]=Tt}function q(D,U){w(D,U,U)}function ht(D,U){const L=s();let p;for(p=0;p<16;p++)L[p]=U[p];for(p=253;p>=0;p--)q(L,L),p!==2&&p!==4&&w(L,L,U);for(p=0;p<16;p++)D[p]=L[p]}function ut(D,U){const L=s();let p;for(p=0;p<16;p++)L[p]=U[p];for(p=250;p>=0;p--)q(L,L),p!==1&&w(L,L,U);for(p=0;p<16;p++)D[p]=L[p]}function lt(D,U){const L=s(),p=s(),F=s(),et=s(),st=s(),at=s(),It=s(),xt=s(),At=s();z(L,D[1],D[0]),z(At,U[1],U[0]),w(L,L,At),k(p,D[0],D[1]),k(At,U[0],U[1]),w(p,p,At),w(F,D[3],U[3]),w(F,F,y),w(et,D[2],U[2]),k(et,et,et),z(st,p,L),z(at,et,F),k(It,et,F),k(xt,p,L),w(D[0],st,at),w(D[1],xt,It),w(D[2],It,at),w(D[3],st,xt)}function gt(D,U,L){for(let p=0;p<4;p++)Q(D[p],U[p],L)}function l(D,U){const L=s(),p=s(),F=s();ht(F,U[2]),w(L,U[0],F),w(p,U[1],F),V(D,p),D[31]^=J(L)<<7}function v(D,U,L){R(D[0],h),R(D[1],u),R(D[2],u),R(D[3],h);for(let p=255;p>=0;--p){const F=L[p/8|0]>>(p&7)&1;gt(D,U,F),lt(U,D),lt(D,D),gt(D,U,F)}}function m(D,U){const L=[s(),s(),s(),s()];R(L[0],A),R(L[1],x),R(L[2],u),w(L[3],A,x),v(D,L,U)}function b(D){if(D.length!==r.SEED_LENGTH)throw new Error(`ed25519: seed must be ${r.SEED_LENGTH} bytes`);const U=(0,e.hash)(D);U[0]&=248,U[31]&=127,U[31]|=64;const L=new Uint8Array(32),p=[s(),s(),s(),s()];m(p,U),l(L,p);const F=new Uint8Array(64);return F.set(D),F.set(L,32),{publicKey:L,secretKey:F}}r.generateKeyPairFromSeed=b;function E(D){const U=(0,t.randomBytes)(32,D),L=b(U);return(0,n.wipe)(U),L}r.generateKeyPair=E;function P(D){if(D.length!==r.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${r.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(D.subarray(32))}r.extractPublicKeyFromSecretKey=P;const O=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function S(D,U){let L,p,F,et;for(p=63;p>=32;--p){for(L=0,F=p-32,et=p-12;F<et;++F)U[F]+=L-16*U[p]*O[F-(p-32)],L=Math.floor((U[F]+128)/256),U[F]-=L*256;U[F]+=L,U[p]=0}for(L=0,F=0;F<32;F++)U[F]+=L-(U[31]>>4)*O[F],L=U[F]>>8,U[F]&=255;for(F=0;F<32;F++)U[F]-=L*O[F];for(p=0;p<32;p++)U[p+1]+=U[p]>>8,D[p]=U[p]&255}function d(D){const U=new Float64Array(64);for(let L=0;L<64;L++)U[L]=D[L];for(let L=0;L<64;L++)D[L]=0;S(D,U)}function C(D,U){const L=new Float64Array(64),p=[s(),s(),s(),s()],F=(0,e.hash)(D.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const et=new Uint8Array(64);et.set(F.subarray(32),32);const st=new e.SHA512;st.update(et.subarray(32)),st.update(U);const at=st.digest();st.clean(),d(at),m(p,at),l(et,p),st.reset(),st.update(et.subarray(0,32)),st.update(D.subarray(32)),st.update(U);const It=st.digest();d(It);for(let xt=0;xt<32;xt++)L[xt]=at[xt];for(let xt=0;xt<32;xt++)for(let At=0;At<32;At++)L[xt+At]+=It[xt]*F[At];return S(et.subarray(32),L),et}r.sign=C;function X(D,U){const L=s(),p=s(),F=s(),et=s(),st=s(),at=s(),It=s();return R(D[2],u),B(D[1],U),q(F,D[1]),w(et,F,f),z(F,F,D[2]),k(et,D[2],et),q(st,et),q(at,st),w(It,at,st),w(L,It,F),w(L,L,et),ut(L,L),w(L,L,F),w(L,L,et),w(L,L,et),w(D[0],L,et),q(p,D[0]),w(p,p,et),H(p,F)&&w(D[0],D[0],T),q(p,D[0]),w(p,p,et),H(p,F)?-1:(J(D[0])===U[31]>>7&&z(D[0],h,D[0]),w(D[3],D[0],D[1]),0)}function rt(D,U,L){const p=new Uint8Array(32),F=[s(),s(),s(),s()],et=[s(),s(),s(),s()];if(L.length!==r.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${r.SIGNATURE_LENGTH} bytes`);if(X(et,D))return!1;const st=new e.SHA512;st.update(L.subarray(0,32)),st.update(D),st.update(U);const at=st.digest();return d(at),v(F,et,at),m(et,L.subarray(32)),lt(F,et),l(p,F),!Z(L,p)}r.verify=rt;function _(D){let U=[s(),s(),s(),s()];if(X(U,D))throw new Error("Ed25519: invalid public key");let L=s(),p=s(),F=U[1];k(L,u,F),z(p,u,F),ht(p,p),w(L,L,p);let et=new Uint8Array(32);return V(et,L),et}r.convertPublicKeyToX25519=_;function W(D){const U=(0,e.hash)(D.subarray(0,32));U[0]&=248,U[31]&=127,U[31]|=64;const L=new Uint8Array(U.subarray(0,32));return(0,n.wipe)(U),L}r.convertSecretKeyToX25519=W}(xh)),xh}var y0=x6();const M6="EdDSA",P6="JWT",ka=".",Za="base64url",w0="utf8",b0="utf8",C6=":",N6="did",R6="key",Fd="base58btc",O6="z",T6="K36",F6=32;function Iu(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function _0(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Iu(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function D6(r,t){t||(t=r.reduce((s,a)=>s+a.length,0));const e=_0(t);let n=0;for(const s of r)e.set(s,n),n+=s.length;return Iu(e)}function A0(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}const Dd=A0("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ph=A0("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);const t=_0(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),E0={utf8:Dd,"utf-8":Dd,hex:hd.base16,latin1:Ph,ascii:Ph,binary:Ph,...hd};function tc(r,t="utf8"){const e=E0[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r.buffer,r.byteOffset,r.byteLength).toString("utf8"):e.encoder.encode(r).substring(1)}function bs(r,t="utf8"){const e=E0[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Iu(globalThis.Buffer.from(r,"utf-8")):e.decoder.decode(`${e.prefix}${r}`)}function qd(r){return Ba(tc(bs(r,Za),w0))}function $a(r){return tc(bs(mu(r),w0),Za)}function I0(r){const t=bs(T6,Fd),e=O6+tc(D6([t,r]),Fd);return[N6,R6,e].join(C6)}function q6(r){return tc(r,Za)}function U6(r){return bs(r,Za)}function B6(r){return bs([$a(r.header),$a(r.payload)].join(ka),b0)}function L6(r){return[$a(r.header),$a(r.payload),q6(r.signature)].join(ka)}function eu(r){const t=r.split(ka),e=qd(t[0]),n=qd(t[1]),s=U6(t[2]),a=bs(t.slice(0,2).join(ka),b0);return{header:e,payload:n,signature:s,data:a}}function Ud(r=xo.randomBytes(F6)){return y0.generateKeyPairFromSeed(r)}async function k6(r,t,e,n,s=dt.fromMiliseconds(Date.now())){const a={alg:M6,typ:P6},h=I0(n.publicKey),u=s+e,f={iss:h,sub:r,aud:t,iat:s,exp:u},y=B6({header:a,payload:f}),A=y0.sign(n.secretKey,y);return L6({header:a,payload:f,signature:A})}var $6={};const j6=":";function go(r){const[t,e]=r.split(j6);return{namespace:t,reference:e}}function Bd(r,t=[]){const e=[];return Object.keys(r).forEach(n=>{if(t.length&&!t.includes(n))return;const s=r[n];e.push(...s.accounts)}),e}function S0(r,t){return r.includes(":")?[r]:t.chains||[]}var z6=Object.defineProperty,Ld=Object.getOwnPropertySymbols,H6=Object.prototype.hasOwnProperty,K6=Object.prototype.propertyIsEnumerable,kd=(r,t,e)=>t in r?z6(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,$d=(r,t)=>{for(var e in t||(t={}))H6.call(t,e)&&kd(r,e,t[e]);if(Ld)for(var e of Ld(t))K6.call(t,e)&&kd(r,e,t[e]);return r};const V6="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},G6="js";function ja(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function _s(){return!ms.getDocument()&&!!ms.getNavigator()&&navigator.product===V6}function Mo(){return!ja()&&!!ms.getNavigator()&&!!ms.getDocument()}function Po(){return _s()?Or.reactNative:ja()?Or.node:Mo()?Or.browser:Or.unknown}function Q6(){var r;try{return _s()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(r=global.Application)==null?void 0:r.applicationId:void 0}catch{return}}function J6(r,t){let e=La.parse(r);return e=$d($d({},e),t),r=La.stringify(e),r}function x0(){return Qb.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function Y6(){if(Po()===Or.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:e,Version:n}=global.Platform;return[e,n].join("-")}const r=Wb();if(r===null)return"unknown";const t=r.os?r.os.replace(" ","").toLowerCase():"unknown";return r.type==="browser"?[t,r.name,r.version].join("-"):[t,r.version].join("-")}function W6(){var r;const t=Po();return t===Or.browser?[t,((r=ms.getLocation())==null?void 0:r.host)||"unknown"].join(":"):t}function M0(r,t,e){const n=Y6(),s=W6();return[[r,t].join("-"),[G6,e].join("-"),n,s].join("/")}function X6({protocol:r,version:t,relayUrl:e,sdkVersion:n,auth:s,projectId:a,useOnCloseEvent:h,bundleId:u}){const f=e.split("?"),y=M0(r,t,n),A={auth:s,ua:y,projectId:a,useOnCloseEvent:h,origin:u||void 0},x=J6(f[1]||"",A);return f[0]+"?"+x}function Dn(r,t){return r.filter(e=>t.includes(e)).length===r.length}function P0(r){return Object.fromEntries(r.entries())}function C0(r){return new Map(Object.entries(r))}function On(r=dt.FIVE_MINUTES,t){const e=dt.toMiliseconds(r||dt.FIVE_MINUTES);let n,s,a;return{resolve:h=>{a&&n&&(clearTimeout(a),n(h))},reject:h=>{a&&s&&(clearTimeout(a),s(h))},done:()=>new Promise((h,u)=>{a=setTimeout(()=>{u(new Error(t))},e),n=h,s=u})}}function ds(r,t,e){return new Promise(async(n,s)=>{const a=setTimeout(()=>s(new Error(e)),t);try{const h=await r;n(h)}catch(h){s(h)}clearTimeout(a)})}function N0(r,t){if(typeof t=="string"&&t.startsWith(`${r}:`))return t;if(r.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(r.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${r}`)}function Z6(r){return N0("topic",r)}function t3(r){return N0("id",r)}function R0(r){const[t,e]=r.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof e=="string")n.topic=e;else if(t==="id"&&Number.isInteger(Number(e)))n.id=Number(e);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${e}`);return n}function Qe(r,t){return dt.fromMiliseconds(Date.now()+dt.toMiliseconds(r))}function gn(r){return Date.now()>=dt.toMiliseconds(r)}function ae(r,t){return`${r}${t?`:${t}`:""}`}function Ra(r=[],t=[]){return[...new Set([...r,...t])]}async function e3({id:r,topic:t,wcDeepLink:e}){var n;try{if(!e)return;const s=typeof e=="string"?JSON.parse(e):e,a=s==null?void 0:s.href;if(typeof a!="string")return;const h=r3(a,r,t),u=Po();if(u===Or.browser){if(!((n=ms.getDocument())!=null&&n.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}h.startsWith("https://")||h.startsWith("http://")?window.open(h,"_blank","noreferrer noopener"):window.open(h,n3()?"_blank":"_self","noreferrer noopener")}else u===Or.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(h)}catch(s){console.error(s)}}function r3(r,t,e){const n=`requestId=${t}&sessionTopic=${e}`;r.endsWith("/")&&(r=r.slice(0,-1));let s=`${r}`;if(r.startsWith("https://t.me")){const a=r.includes("?")?"&startapp=":"?startapp=";s=`${s}${a}${s3(n,!0)}`}else s=`${s}/wc?${n}`;return s}async function i3(r,t){let e="";try{if(Mo()&&(e=localStorage.getItem(t),e))return e;e=await r.getItem(t)}catch(n){console.error(n)}return e}function jd(r,t){if(!r.includes(t))return null;const e=r.split(/([&,?,=])/),n=e.indexOf(t);return e[n+2]}function zd(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,r=>{const t=Math.random()*16|0;return(r==="x"?t:t&3|8).toString(16)})}function Su(){return typeof process<"u"&&$6.IS_VITEST==="true"}function n3(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function s3(r,t=!1){const e=Buffer.from(r).toString("base64");return t?e.replace(/[=]/g,""):e}function O0(r){return Buffer.from(r,"base64").toString("utf-8")}var T0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function o3(r){var t=r.default;if(typeof t=="function"){var e=function(){return t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(n){var s=Object.getOwnPropertyDescriptor(r,n);Object.defineProperty(e,n,s.get?s:{enumerable:!0,get:function(){return r[n]}})}),e}var F0={exports:{}};/**
* [js-sha3]{@link https://github.com/emn178/js-sha3}
*
* @version 0.8.0
* @author Chen, Yi-Cyuan [emn178@gmail.com]
* @copyright Chen, Yi-Cyuan 2015-2018
* @license MIT
*/(function(r){(function(){var t="input is invalid type",e="finalize already called",n=typeof window=="object",s=n?window:{};s.JS_SHA3_NO_WINDOW&&(n=!1);var a=!n&&typeof self=="object",h=!s.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;h?s=T0:a&&(s=self);var u=!s.JS_SHA3_NO_COMMON_JS&&!0&&r.exports,f=!s.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer<"u",y="0123456789abcdef".split(""),A=[31,7936,2031616,520093696],x=[4,1024,262144,67108864],T=[1,256,65536,16777216],R=[6,1536,393216,100663296],$=[0,8,16,24],Q=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],V=[224,256,384,512],Z=[128,256],H=["hex","buffer","arrayBuffer","array","digest"],J={128:168,256:136};(s.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(_){return Object.prototype.toString.call(_)==="[object Array]"}),f&&(s.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(_){return typeof _=="object"&&_.buffer&&_.buffer.constructor===ArrayBuffer});for(var B=function(_,W,D){return function(U){return new C(_,W,_).update(U)[D]()}},k=function(_,W,D){return function(U,L){return new C(_,W,L).update(U)[D]()}},z=function(_,W,D){return function(U,L,p,F){return v["cshake"+_].update(U,L,p,F)[D]()}},w=function(_,W,D){return function(U,L,p,F){return v["kmac"+_].update(U,L,p,F)[D]()}},q=function(_,W,D,U){for(var L=0;L<H.length;++L){var p=H[L];_[p]=W(D,U,p)}return _},ht=function(_,W){var D=B(_,W,"hex");return D.create=function(){return new C(_,W,_)},D.update=function(U){return D.create().update(U)},q(D,B,_,W)},ut=function(_,W){var D=k(_,W,"hex");return D.create=function(U){return new C(_,W,U)},D.update=function(U,L){return D.create(L).update(U)},q(D,k,_,W)},lt=function(_,W){var D=J[_],U=z(_,W,"hex");return U.create=function(L,p,F){return!p&&!F?v["shake"+_].create(L):new C(_,W,L).bytepad([p,F],D)},U.update=function(L,p,F,et){return U.create(p,F,et).update(L)},q(U,z,_,W)},gt=function(_,W){var D=J[_],U=w(_,W,"hex");return U.create=function(L,p,F){return new X(_,W,p).bytepad(["KMAC",F],D).bytepad([L],D)},U.update=function(L,p,F,et){return U.create(L,F,et).update(p)},q(U,w,_,W)},l=[{name:"keccak",padding:T,bits:V,createMethod:ht},{name:"sha3",padding:R,bits:V,createMethod:ht},{name:"shake",padding:A,bits:Z,createMethod:ut},{name:"cshake",padding:x,bits:Z,createMethod:lt},{name:"kmac",padding:x,bits:Z,createMethod:gt}],v={},m=[],b=0;b<l.length;++b)for(var E=l[b],P=E.bits,O=0;O<P.length;++O){var S=E.name+"_"+P[O];if(m.push(S),v[S]=E.createMethod(P[O],E.padding),E.name!=="sha3"){var d=E.name+P[O];m.push(d),v[d]=v[S]}}function C(_,W,D){this.blocks=[],this.s=[],this.padding=W,this.outputBits=D,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(_<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=D>>5,this.extraBytes=(D&31)>>3;for(var U=0;U<50;++U)this.s[U]=0}C.prototype.update=function(_){if(this.finalized)throw new Error(e);var W,D=typeof _;if(D!=="string"){if(D==="object"){if(_===null)throw new Error(t);if(f&&_.constructor===ArrayBuffer)_=new Uint8Array(_);else if(!Array.isArray(_)&&(!f||!ArrayBuffer.isView(_)))throw new Error(t)}else throw new Error(t);W=!0}for(var U=this.blocks,L=this.byteCount,p=_.length,F=this.blockCount,et=0,st=this.s,at,It;et<p;){if(this.reset)for(this.reset=!1,U[0]=this.block,at=1;at<F+1;++at)U[at]=0;if(W)for(at=this.start;et<p&&at<L;++et)U[at>>2]|=_[et]<<$[at++&3];else for(at=this.start;et<p&&at<L;++et)It=_.charCodeAt(et),It<128?U[at>>2]|=It<<$[at++&3]:It<2048?(U[at>>2]|=(192|It>>6)<<$[at++&3],U[at>>2]|=(128|It&63)<<$[at++&3]):It<55296||It>=57344?(U[at>>2]|=(224|It>>12)<<$[at++&3],U[at>>2]|=(128|It>>6&63)<<$[at++&3],U[at>>2]|=(128|It&63)<<$[at++&3]):(It=65536+((It&1023)<<10|_.charCodeAt(++et)&1023),U[at>>2]|=(240|It>>18)<<$[at++&3],U[at>>2]|=(128|It>>12&63)<<$[at++&3],U[at>>2]|=(128|It>>6&63)<<$[at++&3],U[at>>2]|=(128|It&63)<<$[at++&3]);if(this.lastByteIndex=at,at>=L){for(this.start=at-L,this.block=U[F],at=0;at<F;++at)st[at]^=U[at];rt(st),this.reset=!0}else this.start=at}return this},C.prototype.encode=function(_,W){var D=_&255,U=1,L=[D];for(_=_>>8,D=_&255;D>0;)L.unshift(D),_=_>>8,D=_&255,++U;return W?L.push(U):L.unshift(U),this.update(L),L.length},C.prototype.encodeString=function(_){var W,D=typeof _;if(D!=="string"){if(D==="object"){if(_===null)throw new Error(t);if(f&&_.constructor===ArrayBuffer)_=new Uint8Array(_);else if(!Array.isArray(_)&&(!f||!ArrayBuffer.isView(_)))throw new Error(t)}else throw new Error(t);W=!0}var U=0,L=_.length;if(W)U=L;else for(var p=0;p<_.length;++p){var F=_.charCodeAt(p);F<128?U+=1:F<2048?U+=2:F<55296||F>=57344?U+=3:(F=65536+((F&1023)<<10|_.charCodeAt(++p)&1023),U+=4)}return U+=this.encode(U*8),this.update(_),U},C.prototype.bytepad=function(_,W){for(var D=this.encode(W),U=0;U<_.length;++U)D+=this.encodeString(_[U]);var L=W-D%W,p=[];return p.length=L,this.update(p),this},C.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var _=this.blocks,W=this.lastByteIndex,D=this.blockCount,U=this.s;if(_[W>>2]|=this.padding[W&3],this.lastByteIndex===this.byteCount)for(_[0]=_[D],W=1;W<D+1;++W)_[W]=0;for(_[D-1]|=2147483648,W=0;W<D;++W)U[W]^=_[W];rt(U)}},C.prototype.toString=C.prototype.hex=function(){this.finalize();for(var _=this.blockCount,W=this.s,D=this.outputBlocks,U=this.extraBytes,L=0,p=0,F="",et;p<D;){for(L=0;L<_&&p<D;++L,++p)et=W[L],F+=y[et>>4&15]+y[et&15]+y[et>>12&15]+y[et>>8&15]+y[et>>20&15]+y[et>>16&15]+y[et>>28&15]+y[et>>24&15];p%_===0&&(rt(W),L=0)}return U&&(et=W[L],F+=y[et>>4&15]+y[et&15],U>1&&(F+=y[et>>12&15]+y[et>>8&15]),U>2&&(F+=y[et>>20&15]+y[et>>16&15])),F},C.prototype.arrayBuffer=function(){this.finalize();var _=this.blockCount,W=this.s,D=this.outputBlocks,U=this.extraBytes,L=0,p=0,F=this.outputBits>>3,et;U?et=new ArrayBuffer(D+1<<2):et=new ArrayBuffer(F);for(var st=new Uint32Array(et);p<D;){for(L=0;L<_&&p<D;++L,++p)st[p]=W[L];p%_===0&&rt(W)}return U&&(st[L]=W[L],et=et.slice(0,F)),et},C.prototype.buffer=C.prototype.arrayBuffer,C.prototype.digest=C.prototype.array=function(){this.finalize();for(var _=this.blockCount,W=this.s,D=this.outputBlocks,U=this.extraBytes,L=0,p=0,F=[],et,st;p<D;){for(L=0;L<_&&p<D;++L,++p)et=p<<2,st=W[L],F[et]=st&255,F[et+1]=st>>8&255,F[et+2]=st>>16&255,F[et+3]=st>>24&255;p%_===0&&rt(W)}return U&&(et=p<<2,st=W[L],F[et]=st&255,U>1&&(F[et+1]=st>>8&255),U>2&&(F[et+2]=st>>16&255)),F};function X(_,W,D){C.call(this,_,W,D)}X.prototype=new C,X.prototype.finalize=function(){return this.encode(this.outputBits,!0),C.prototype.finalize.call(this)};var rt=function(_){var W,D,U,L,p,F,et,st,at,It,xt,At,me,Ut,Et,Ot,yt,wt,Bt,mt,bt,Tt,_t,St,Wt,Mt,Ct,ee,Nt,Rt,He,se,fe,or,de,pe,Sr,$t,jt,Me,zt,kt,Pe,Ht,Kt,_e,Vt,Lt,Ce,Gt,Qt,Ne,Jt,Ee,Ui,Ie,Ae,fi,di,pi,gi,mi,vi;for(U=0;U<48;U+=2)L=_[0]^_[10]^_[20]^_[30]^_[40],p=_[1]^_[11]^_[21]^_[31]^_[41],F=_[2]^_[12]^_[22]^_[32]^_[42],et=_[3]^_[13]^_[23]^_[33]^_[43],st=_[4]^_[14]^_[24]^_[34]^_[44],at=_[5]^_[15]^_[25]^_[35]^_[45],It=_[6]^_[16]^_[26]^_[36]^_[46],xt=_[7]^_[17]^_[27]^_[37]^_[47],At=_[8]^_[18]^_[28]^_[38]^_[48],me=_[9]^_[19]^_[29]^_[39]^_[49],W=At^(F<<1|et>>>31),D=me^(et<<1|F>>>31),_[0]^=W,_[1]^=D,_[10]^=W,_[11]^=D,_[20]^=W,_[21]^=D,_[30]^=W,_[31]^=D,_[40]^=W,_[41]^=D,W=L^(st<<1|at>>>31),D=p^(at<<1|st>>>31),_[2]^=W,_[3]^=D,_[12]^=W,_[13]^=D,_[22]^=W,_[23]^=D,_[32]^=W,_[33]^=D,_[42]^=W,_[43]^=D,W=F^(It<<1|xt>>>31),D=et^(xt<<1|It>>>31),_[4]^=W,_[5]^=D,_[14]^=W,_[15]^=D,_[24]^=W,_[25]^=D,_[34]^=W,_[35]^=D,_[44]^=W,_[45]^=D,W=st^(At<<1|me>>>31),D=at^(me<<1|At>>>31),_[6]^=W,_[7]^=D,_[16]^=W,_[17]^=D,_[26]^=W,_[27]^=D,_[36]^=W,_[37]^=D,_[46]^=W,_[47]^=D,W=It^(L<<1|p>>>31),D=xt^(p<<1|L>>>31),_[8]^=W,_[9]^=D,_[18]^=W,_[19]^=D,_[28]^=W,_[29]^=D,_[38]^=W,_[39]^=D,_[48]^=W,_[49]^=D,Ut=_[0],Et=_[1],_e=_[11]<<4|_[10]>>>28,Vt=_[10]<<4|_[11]>>>28,ee=_[20]<<3|_[21]>>>29,Nt=_[21]<<3|_[20]>>>29,pi=_[31]<<9|_[30]>>>23,gi=_[30]<<9|_[31]>>>23,kt=_[40]<<18|_[41]>>>14,Pe=_[41]<<18|_[40]>>>14,or=_[2]<<1|_[3]>>>31,de=_[3]<<1|_[2]>>>31,Ot=_[13]<<12|_[12]>>>20,yt=_[12]<<12|_[13]>>>20,Lt=_[22]<<10|_[23]>>>22,Ce=_[23]<<10|_[22]>>>22,Rt=_[33]<<13|_[32]>>>19,He=_[32]<<13|_[33]>>>19,mi=_[42]<<2|_[43]>>>30,vi=_[43]<<2|_[42]>>>30,Ee=_[5]<<30|_[4]>>>2,Ui=_[4]<<30|_[5]>>>2,pe=_[14]<<6|_[15]>>>26,Sr=_[15]<<6|_[14]>>>26,wt=_[25]<<11|_[24]>>>21,Bt=_[24]<<11|_[25]>>>21,Gt=_[34]<<15|_[35]>>>17,Qt=_[35]<<15|_[34]>>>17,se=_[45]<<29|_[44]>>>3,fe=_[44]<<29|_[45]>>>3,St=_[6]<<28|_[7]>>>4,Wt=_[7]<<28|_[6]>>>4,Ie=_[17]<<23|_[16]>>>9,Ae=_[16]<<23|_[17]>>>9,$t=_[26]<<25|_[27]>>>7,jt=_[27]<<25|_[26]>>>7,mt=_[36]<<21|_[37]>>>11,bt=_[37]<<21|_[36]>>>11,Ne=_[47]<<24|_[46]>>>8,Jt=_[46]<<24|_[47]>>>8,Ht=_[8]<<27|_[9]>>>5,Kt=_[9]<<27|_[8]>>>5,Mt=_[18]<<20|_[19]>>>12,Ct=_[19]<<20|_[18]>>>12,fi=_[29]<<7|_[28]>>>25,di=_[28]<<7|_[29]>>>25,Me=_[38]<<8|_[39]>>>24,zt=_[39]<<8|_[38]>>>24,Tt=_[48]<<14|_[49]>>>18,_t=_[49]<<14|_[48]>>>18,_[0]=Ut^~Ot&wt,_[1]=Et^~yt&Bt,_[10]=St^~Mt&ee,_[11]=Wt^~Ct&Nt,_[20]=or^~pe&$t,_[21]=de^~Sr&jt,_[30]=Ht^~_e&Lt,_[31]=Kt^~Vt&Ce,_[40]=Ee^~Ie&fi,_[41]=Ui^~Ae&di,_[2]=Ot^~wt&mt,_[3]=yt^~Bt&bt,_[12]=Mt^~ee&Rt,_[13]=Ct^~Nt&He,_[22]=pe^~$t&Me,_[23]=Sr^~jt&zt,_[32]=_e^~Lt&Gt,_[33]=Vt^~Ce&Qt,_[42]=Ie^~fi&pi,_[43]=Ae^~di&gi,_[4]=wt^~mt&Tt,_[5]=Bt^~bt&_t,_[14]=ee^~Rt&se,_[15]=Nt^~He&fe,_[24]=$t^~Me&kt,_[25]=jt^~zt&Pe,_[34]=Lt^~Gt&Ne,_[35]=Ce^~Qt&Jt,_[44]=fi^~pi&mi,_[45]=di^~gi&vi,_[6]=mt^~Tt&Ut,_[7]=bt^~_t&Et,_[16]=Rt^~se&St,_[17]=He^~fe&Wt,_[26]=Me^~kt&or,_[27]=zt^~Pe&de,_[36]=Gt^~Ne&Ht,_[37]=Qt^~Jt&Kt,_[46]=pi^~mi&Ee,_[47]=gi^~vi&Ui,_[8]=Tt^~Ut&Ot,_[9]=_t^~Et&yt,_[18]=se^~St&Mt,_[19]=fe^~Wt&Ct,_[28]=kt^~or&pe,_[29]=Pe^~de&Sr,_[38]=Ne^~Ht&_e,_[39]=Jt^~Kt&Vt,_[48]=mi^~Ee&Ie,_[49]=vi^~Ui&Ae,_[0]^=Q[U],_[1]^=Q[U+1]};if(u)r.exports=v;else for(b=0;b<m.length;++b)s[m[b]]=v[m[b]]})()})(F0);var a3=F0.exports;const c3="logger/5.7.0";let Hd=!1,Kd=!1;const Oa={debug:1,default:2,info:2,warning:3,error:4,off:5};let Vd=Oa.default,Ch=null;function h3(){try{const r=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test".normalize(t)!=="test")throw new Error("bad normalize")}catch{r.push(t)}}),r.length)throw new Error("missing "+r.join(", "));if("é".normalize("NFD")!=="é")throw new Error("broken implementation")}catch(r){return r.message}return null}const Gd=h3();var ru;(function(r){r.DEBUG="DEBUG",r.INFO="INFO",r.WARNING="WARNING",r.ERROR="ERROR",r.OFF="OFF"})(ru||(ru={}));var si;(function(r){r.UNKNOWN_ERROR="UNKNOWN_ERROR",r.NOT_IMPLEMENTED="NOT_IMPLEMENTED",r.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",r.NETWORK_ERROR="NETWORK_ERROR",r.SERVER_ERROR="SERVER_ERROR",r.TIMEOUT="TIMEOUT",r.BUFFER_OVERRUN="BUFFER_OVERRUN",r.NUMERIC_FAULT="NUMERIC_FAULT",r.MISSING_NEW="MISSING_NEW",r.INVALID_ARGUMENT="INVALID_ARGUMENT",r.MISSING_ARGUMENT="MISSING_ARGUMENT",r.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",r.CALL_EXCEPTION="CALL_EXCEPTION",r.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",r.NONCE_EXPIRED="NONCE_EXPIRED",r.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",r.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",r.TRANSACTION_REPLACED="TRANSACTION_REPLACED",r.ACTION_REJECTED="ACTION_REJECTED"})(si||(si={}));const Qd="0123456789abcdef";let er=class Ge{constructor(t){Object.defineProperty(this,"version",{enumerable:!0,value:t,writable:!1})}_log(t,e){const n=t.toLowerCase();Oa[n]==null&&this.throwArgumentError("invalid log level name","logLevel",t),!(Vd>Oa[n])&&console.log.apply(console,e)}debug(...t){this._log(Ge.levels.DEBUG,t)}info(...t){this._log(Ge.levels.INFO,t)}warn(...t){this._log(Ge.levels.WARNING,t)}makeError(t,e,n){if(Kd)return this.makeError("censored error",e,{});e||(e=Ge.errors.UNKNOWN_ERROR),n||(n={});const s=[];Object.keys(n).forEach(f=>{const y=n[f];try{if(y instanceof Uint8Array){let A="";for(let x=0;x<y.length;x++)A+=Qd[y[x]>>4],A+=Qd[y[x]&15];s.push(f+"=Uint8Array(0x"+A+")")}else s.push(f+"="+JSON.stringify(y))}catch{s.push(f+"="+JSON.stringify(n[f].toString()))}}),s.push(`code=${e}`),s.push(`version=${this.version}`);const a=t;let h="";switch(e){case si.NUMERIC_FAULT:{h="NUMERIC_FAULT";const f=t;switch(f){case"overflow":case"underflow":case"division-by-zero":h+="-"+f;break;case"negative-power":case"negative-width":h+="-unsupported";break;case"unbound-bitwise-result":h+="-unbound-result";break}break}case si.CALL_EXCEPTION:case si.INSUFFICIENT_FUNDS:case si.MISSING_NEW:case si.NONCE_EXPIRED:case si.REPLACEMENT_UNDERPRICED:case si.TRANSACTION_REPLACED:case si.UNPREDICTABLE_GAS_LIMIT:h=e;break}h&&(t+=" [ See: https://links.ethers.org/v5-errors-"+h+" ]"),s.length&&(t+=" ("+s.join(", ")+")");const u=new Error(t);return u.reason=a,u.code=e,Object.keys(n).forEach(function(f){u[f]=n[f]}),u}throwError(t,e,n){throw this.makeError(t,e,n)}throwArgumentError(t,e,n){return this.throwError(t,Ge.errors.INVALID_ARGUMENT,{argument:e,value:n})}assert(t,e,n,s){t||this.throwError(e,n,s)}assertArgument(t,e,n,s){t||this.throwArgumentError(e,n,s)}checkNormalize(t){Gd&&this.throwError("platform missing String.prototype.normalize",Ge.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:Gd})}checkSafeUint53(t,e){typeof t=="number"&&(e==null&&(e="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(e,Ge.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(e,Ge.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,e,n){n?n=": "+n:n="",t<e&&this.throwError("missing argument"+n,Ge.errors.MISSING_ARGUMENT,{count:t,expectedCount:e}),t>e&&this.throwError("too many arguments"+n,Ge.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:e})}checkNew(t,e){(t===Object||t==null)&&this.throwError("missing new",Ge.errors.MISSING_NEW,{name:e.name})}checkAbstract(t,e){t===e?this.throwError("cannot instantiate abstract class "+JSON.stringify(e.name)+" directly; use a sub-class",Ge.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):(t===Object||t==null)&&this.throwError("missing new",Ge.errors.MISSING_NEW,{name:e.name})}static globalLogger(){return Ch||(Ch=new Ge(c3)),Ch}static setCensorship(t,e){if(!t&&e&&this.globalLogger().throwError("cannot permanently disable censorship",Ge.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),Hd){if(!t)return;this.globalLogger().throwError("error censorship permanent",Ge.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}Kd=!!t,Hd=!!e}static setLogLevel(t){const e=Oa[t.toLowerCase()];if(e==null){Ge.globalLogger().warn("invalid log level - "+t);return}Vd=e}static from(t){return new Ge(t)}};er.errors=si,er.levels=ru;const u3="bytes/5.7.0",je=new er(u3);function D0(r){return!!r.toHexString}function ps(r){return r.slice||(r.slice=function(){const t=Array.prototype.slice.call(arguments);return ps(new Uint8Array(Array.prototype.slice.apply(r,t)))}),r}function l3(r){return Tr(r)&&!(r.length%2)||As(r)}function Jd(r){return typeof r=="number"&&r==r&&r%1===0}function As(r){if(r==null)return!1;if(r.constructor===Uint8Array)return!0;if(typeof r=="string"||!Jd(r.length)||r.length<0)return!1;for(let t=0;t<r.length;t++){const e=r[t];if(!Jd(e)||e<0||e>=256)return!1}return!0}function Le(r,t){if(t||(t={}),typeof r=="number"){je.checkSafeUint53(r,"invalid arrayify value");const e=[];for(;r;)e.unshift(r&255),r=parseInt(String(r/256));return e.length===0&&e.push(0),ps(new Uint8Array(e))}if(t.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),D0(r)&&(r=r.toHexString()),Tr(r)){let e=r.substring(2);e.length%2&&(t.hexPad==="left"?e="0"+e:t.hexPad==="right"?e+="0":je.throwArgumentError("hex data is odd-length","value",r));const n=[];for(let s=0;s<e.length;s+=2)n.push(parseInt(e.substring(s,s+2),16));return ps(new Uint8Array(n))}return As(r)?ps(new Uint8Array(r)):je.throwArgumentError("invalid arrayify value","value",r)}function f3(r){const t=r.map(s=>Le(s)),e=t.reduce((s,a)=>s+a.length,0),n=new Uint8Array(e);return t.reduce((s,a)=>(n.set(a,s),s+a.length),0),ps(n)}function d3(r,t){r=Le(r),r.length>t&&je.throwArgumentError("value out of range","value",arguments[0]);const e=new Uint8Array(t);return e.set(r,t-r.length),ps(e)}function Tr(r,t){return!(typeof r!="string"||!r.match(/^0x[0-9A-Fa-f]*$/)||t&&r.length!==2+2*t)}const Nh="0123456789abcdef";function Ar(r,t){if(t||(t={}),typeof r=="number"){je.checkSafeUint53(r,"invalid hexlify value");let e="";for(;r;)e=Nh[r&15]+e,r=Math.floor(r/16);return e.length?(e.length%2&&(e="0"+e),"0x"+e):"0x00"}if(typeof r=="bigint")return r=r.toString(16),r.length%2?"0x0"+r:"0x"+r;if(t.allowMissingPrefix&&typeof r=="string"&&r.substring(0,2)!=="0x"&&(r="0x"+r),D0(r))return r.toHexString();if(Tr(r))return r.length%2&&(t.hexPad==="left"?r="0x0"+r.substring(2):t.hexPad==="right"?r+="0":je.throwArgumentError("hex data is odd-length","value",r)),r.toLowerCase();if(As(r)){let e="0x";for(let n=0;n<r.length;n++){let s=r[n];e+=Nh[(s&240)>>4]+Nh[s&15]}return e}return je.throwArgumentError("invalid hexlify value","value",r)}function p3(r){if(typeof r!="string")r=Ar(r);else if(!Tr(r)||r.length%2)return null;return(r.length-2)/2}function Yd(r,t,e){return typeof r!="string"?r=Ar(r):(!Tr(r)||r.length%2)&&je.throwArgumentError("invalid hexData","value",r),t=2+2*t,e!=null?"0x"+r.substring(t,2+2*e):"0x"+r.substring(t)}function Ci(r,t){for(typeof r!="string"?r=Ar(r):Tr(r)||je.throwArgumentError("invalid hex string","value",r),r.length>2*t+2&&je.throwArgumentError("value out of range","value",arguments[1]);r.length<2*t+2;)r="0x0"+r.substring(2);return r}function q0(r){const t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(l3(r)){let e=Le(r);e.length===64?(t.v=27+(e[32]>>7),e[32]&=127,t.r=Ar(e.slice(0,32)),t.s=Ar(e.slice(32,64))):e.length===65?(t.r=Ar(e.slice(0,32)),t.s=Ar(e.slice(32,64)),t.v=e[64]):je.throwArgumentError("invalid signature string","signature",r),t.v<27&&(t.v===0||t.v===1?t.v+=27:je.throwArgumentError("signature invalid v byte","signature",r)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(e[32]|=128),t._vs=Ar(e.slice(32,64))}else{if(t.r=r.r,t.s=r.s,t.v=r.v,t.recoveryParam=r.recoveryParam,t._vs=r._vs,t._vs!=null){const s=d3(Le(t._vs),32);t._vs=Ar(s);const a=s[0]>=128?1:0;t.recoveryParam==null?t.recoveryParam=a:t.recoveryParam!==a&&je.throwArgumentError("signature recoveryParam mismatch _vs","signature",r),s[0]&=127;const h=Ar(s);t.s==null?t.s=h:t.s!==h&&je.throwArgumentError("signature v mismatch _vs","signature",r)}if(t.recoveryParam==null)t.v==null?je.throwArgumentError("signature missing v and recoveryParam","signature",r):t.v===0||t.v===1?t.recoveryParam=t.v:t.recoveryParam=1-t.v%2;else if(t.v==null)t.v=27+t.recoveryParam;else{const s=t.v===0||t.v===1?t.v:1-t.v%2;t.recoveryParam!==s&&je.throwArgumentError("signature recoveryParam mismatch v","signature",r)}t.r==null||!Tr(t.r)?je.throwArgumentError("signature missing or invalid r","signature",r):t.r=Ci(t.r,32),t.s==null||!Tr(t.s)?je.throwArgumentError("signature missing or invalid s","signature",r):t.s=Ci(t.s,32);const e=Le(t.s);e[0]>=128&&je.throwArgumentError("signature s out of range","signature",r),t.recoveryParam&&(e[0]|=128);const n=Ar(e);t._vs&&(Tr(t._vs)||je.throwArgumentError("signature invalid _vs","signature",r),t._vs=Ci(t._vs,32)),t._vs==null?t._vs=n:t._vs!==n&&je.throwArgumentError("signature _vs mismatch v and s","signature",r)}return t.yParityAndS=t._vs,t.compact=t.r+t.yParityAndS.substring(2),t}function xu(r){return"0x"+a3.keccak_256(Le(r))}var U0={exports:{}},g3={},m3=Object.freeze({__proto__:null,default:g3}),v3=o3(m3);(function(r){(function(t,e){function n(l,v){if(!l)throw new Error(v||"Assertion failed")}function s(l,v){l.super_=v;var m=function(){};m.prototype=v.prototype,l.prototype=new m,l.prototype.constructor=l}function a(l,v,m){if(a.isBN(l))return l;this.negative=0,this.words=null,this.length=0,this.red=null,l!==null&&((v==="le"||v==="be")&&(m=v,v=10),this._init(l||0,v||10,m||"be"))}typeof t=="object"?t.exports=a:e.BN=a,a.BN=a,a.wordSize=26;var h;try{typeof window<"u"&&typeof window.Buffer<"u"?h=window.Buffer:h=v3.Buffer}catch{}a.isBN=function(l){return l instanceof a?!0:l!==null&&typeof l=="object"&&l.constructor.wordSize===a.wordSize&&Array.isArray(l.words)},a.max=function(l,v){return l.cmp(v)>0?l:v},a.min=function(l,v){return l.cmp(v)<0?l:v},a.prototype._init=function(l,v,m){if(typeof l=="number")return this._initNumber(l,v,m);if(typeof l=="object")return this._initArray(l,v,m);v==="hex"&&(v=16),n(v===(v|0)&&v>=2&&v<=36),l=l.toString().replace(/\s+/g,"");var b=0;l[0]==="-"&&(b++,this.negative=1),b<l.length&&(v===16?this._parseHex(l,b,m):(this._parseBase(l,v,b),m==="le"&&this._initArray(this.toArray(),v,m)))},a.prototype._initNumber=function(l,v,m){l<0&&(this.negative=1,l=-l),l<67108864?(this.words=[l&67108863],this.length=1):l<4503599627370496?(this.words=[l&67108863,l/67108864&67108863],this.length=2):(n(l<9007199254740992),this.words=[l&67108863,l/67108864&67108863,1],this.length=3),m==="le"&&this._initArray(this.toArray(),v,m)},a.prototype._initArray=function(l,v,m){if(n(typeof l.length=="number"),l.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(l.length/3),this.words=new Array(this.length);for(var b=0;b<this.length;b++)this.words[b]=0;var E,P,O=0;if(m==="be")for(b=l.length-1,E=0;b>=0;b-=3)P=l[b]|l[b-1]<<8|l[b-2]<<16,this.words[E]|=P<<O&67108863,this.words[E+1]=P>>>26-O&67108863,O+=24,O>=26&&(O-=26,E++);else if(m==="le")for(b=0,E=0;b<l.length;b+=3)P=l[b]|l[b+1]<<8|l[b+2]<<16,this.words[E]|=P<<O&67108863,this.words[E+1]=P>>>26-O&67108863,O+=24,O>=26&&(O-=26,E++);return this._strip()};function u(l,v){var m=l.charCodeAt(v);if(m>=48&&m<=57)return m-48;if(m>=65&&m<=70)return m-55;if(m>=97&&m<=102)return m-87;n(!1,"Invalid character in "+l)}function f(l,v,m){var b=u(l,m);return m-1>=v&&(b|=u(l,m-1)<<4),b}a.prototype._parseHex=function(l,v,m){this.length=Math.ceil((l.length-v)/6),this.words=new Array(this.length);for(var b=0;b<this.length;b++)this.words[b]=0;var E=0,P=0,O;if(m==="be")for(b=l.length-1;b>=v;b-=2)O=f(l,v,b)<<E,this.words[P]|=O&67108863,E>=18?(E-=18,P+=1,this.words[P]|=O>>>26):E+=8;else{var S=l.length-v;for(b=S%2===0?v+1:v;b<l.length;b+=2)O=f(l,v,b)<<E,this.words[P]|=O&67108863,E>=18?(E-=18,P+=1,this.words[P]|=O>>>26):E+=8}this._strip()};function y(l,v,m,b){for(var E=0,P=0,O=Math.min(l.length,m),S=v;S<O;S++){var d=l.charCodeAt(S)-48;E*=b,d>=49?P=d-49+10:d>=17?P=d-17+10:P=d,n(d>=0&&P<b,"Invalid character"),E+=P}return E}a.prototype._parseBase=function(l,v,m){this.words=[0],this.length=1;for(var b=0,E=1;E<=67108863;E*=v)b++;b--,E=E/v|0;for(var P=l.length-m,O=P%b,S=Math.min(P,P-O)+m,d=0,C=m;C<S;C+=b)d=y(l,C,C+b,v),this.imuln(E),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d);if(O!==0){var X=1;for(d=y(l,C,l.length,v),C=0;C<O;C++)X*=v;this.imuln(X),this.words[0]+d<67108864?this.words[0]+=d:this._iaddn(d)}this._strip()},a.prototype.copy=function(l){l.words=new Array(this.length);for(var v=0;v<this.length;v++)l.words[v]=this.words[v];l.length=this.length,l.negative=this.negative,l.red=this.red};function A(l,v){l.words=v.words,l.length=v.length,l.negative=v.negative,l.red=v.red}if(a.prototype._move=function(l){A(l,this)},a.prototype.clone=function(){var l=new a(null);return this.copy(l),l},a.prototype._expand=function(l){for(;this.length<l;)this.words[this.length++]=0;return this},a.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},a.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{a.prototype[Symbol.for("nodejs.util.inspect.custom")]=x}catch{a.prototype.inspect=x}else a.prototype.inspect=x;function x(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var T=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],R=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],$=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];a.prototype.toString=function(l,v){l=l||10,v=v|0||1;var m;if(l===16||l==="hex"){m="";for(var b=0,E=0,P=0;P<this.length;P++){var O=this.words[P],S=((O<<b|E)&16777215).toString(16);E=O>>>24-b&16777215,b+=2,b>=26&&(b-=26,P--),E!==0||P!==this.length-1?m=T[6-S.length]+S+m:m=S+m}for(E!==0&&(m=E.toString(16)+m);m.length%v!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}if(l===(l|0)&&l>=2&&l<=36){var d=R[l],C=$[l];m="";var X=this.clone();for(X.negative=0;!X.isZero();){var rt=X.modrn(C).toString(l);X=X.idivn(C),X.isZero()?m=rt+m:m=T[d-rt.length]+rt+m}for(this.isZero()&&(m="0"+m);m.length%v!==0;)m="0"+m;return this.negative!==0&&(m="-"+m),m}n(!1,"Base should be between 2 and 36")},a.prototype.toNumber=function(){var l=this.words[0];return this.length===2?l+=this.words[1]*67108864:this.length===3&&this.words[2]===1?l+=4503599627370496+this.words[1]*67108864:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-l:l},a.prototype.toJSON=function(){return this.toString(16,2)},h&&(a.prototype.toBuffer=function(l,v){return this.toArrayLike(h,l,v)}),a.prototype.toArray=function(l,v){return this.toArrayLike(Array,l,v)};var Q=function(l,v){return l.allocUnsafe?l.allocUnsafe(v):new l(v)};a.prototype.toArrayLike=function(l,v,m){this._strip();var b=this.byteLength(),E=m||Math.max(1,b);n(b<=E,"byte array longer than desired length"),n(E>0,"Requested array length <= 0");var P=Q(l,E),O=v==="le"?"LE":"BE";return this["_toArrayLike"+O](P,b),P},a.prototype._toArrayLikeLE=function(l,v){for(var m=0,b=0,E=0,P=0;E<this.length;E++){var O=this.words[E]<<P|b;l[m++]=O&255,m<l.length&&(l[m++]=O>>8&255),m<l.length&&(l[m++]=O>>16&255),P===6?(m<l.length&&(l[m++]=O>>24&255),b=0,P=0):(b=O>>>24,P+=2)}if(m<l.length)for(l[m++]=b;m<l.length;)l[m++]=0},a.prototype._toArrayLikeBE=function(l,v){for(var m=l.length-1,b=0,E=0,P=0;E<this.length;E++){var O=this.words[E]<<P|b;l[m--]=O&255,m>=0&&(l[m--]=O>>8&255),m>=0&&(l[m--]=O>>16&255),P===6?(m>=0&&(l[m--]=O>>24&255),b=0,P=0):(b=O>>>24,P+=2)}if(m>=0)for(l[m--]=b;m>=0;)l[m--]=0},Math.clz32?a.prototype._countBits=function(l){return 32-Math.clz32(l)}:a.prototype._countBits=function(l){var v=l,m=0;return v>=4096&&(m+=13,v>>>=13),v>=64&&(m+=7,v>>>=7),v>=8&&(m+=4,v>>>=4),v>=2&&(m+=2,v>>>=2),m+v},a.prototype._zeroBits=function(l){if(l===0)return 26;var v=l,m=0;return v&8191||(m+=13,v>>>=13),v&127||(m+=7,v>>>=7),v&15||(m+=4,v>>>=4),v&3||(m+=2,v>>>=2),v&1||m++,m},a.prototype.bitLength=function(){var l=this.words[this.length-1],v=this._countBits(l);return(this.length-1)*26+v};function V(l){for(var v=new Array(l.bitLength()),m=0;m<v.length;m++){var b=m/26|0,E=m%26;v[m]=l.words[b]>>>E&1}return v}a.prototype.zeroBits=function(){if(this.isZero())return 0;for(var l=0,v=0;v<this.length;v++){var m=this._zeroBits(this.words[v]);if(l+=m,m!==26)break}return l},a.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},a.prototype.toTwos=function(l){return this.negative!==0?this.abs().inotn(l).iaddn(1):this.clone()},a.prototype.fromTwos=function(l){return this.testn(l-1)?this.notn(l).iaddn(1).ineg():this.clone()},a.prototype.isNeg=function(){return this.negative!==0},a.prototype.neg=function(){return this.clone().ineg()},a.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},a.prototype.iuor=function(l){for(;this.length<l.length;)this.words[this.length++]=0;for(var v=0;v<l.length;v++)this.words[v]=this.words[v]|l.words[v];return this._strip()},a.prototype.ior=function(l){return n((this.negative|l.negative)===0),this.iuor(l)},a.prototype.or=function(l){return this.length>l.length?this.clone().ior(l):l.clone().ior(this)},a.prototype.uor=function(l){return this.length>l.length?this.clone().iuor(l):l.clone().iuor(this)},a.prototype.iuand=function(l){var v;this.length>l.length?v=l:v=this;for(var m=0;m<v.length;m++)this.words[m]=this.words[m]&l.words[m];return this.length=v.length,this._strip()},a.prototype.iand=function(l){return n((this.negative|l.negative)===0),this.iuand(l)},a.prototype.and=function(l){return this.length>l.length?this.clone().iand(l):l.clone().iand(this)},a.prototype.uand=function(l){return this.length>l.length?this.clone().iuand(l):l.clone().iuand(this)},a.prototype.iuxor=function(l){var v,m;this.length>l.length?(v=this,m=l):(v=l,m=this);for(var b=0;b<m.length;b++)this.words[b]=v.words[b]^m.words[b];if(this!==v)for(;b<v.length;b++)this.words[b]=v.words[b];return this.length=v.length,this._strip()},a.prototype.ixor=function(l){return n((this.negative|l.negative)===0),this.iuxor(l)},a.prototype.xor=function(l){return this.length>l.length?this.clone().ixor(l):l.clone().ixor(this)},a.prototype.uxor=function(l){return this.length>l.length?this.clone().iuxor(l):l.clone().iuxor(this)},a.prototype.inotn=function(l){n(typeof l=="number"&&l>=0);var v=Math.ceil(l/26)|0,m=l%26;this._expand(v),m>0&&v--;for(var b=0;b<v;b++)this.words[b]=~this.words[b]&67108863;return m>0&&(this.words[b]=~this.words[b]&67108863>>26-m),this._strip()},a.prototype.notn=function(l){return this.clone().inotn(l)},a.prototype.setn=function(l,v){n(typeof l=="number"&&l>=0);var m=l/26|0,b=l%26;return this._expand(m+1),v?this.words[m]=this.words[m]|1<<b:this.words[m]=this.words[m]&~(1<<b),this._strip()},a.prototype.iadd=function(l){var v;if(this.negative!==0&&l.negative===0)return this.negative=0,v=this.isub(l),this.negative^=1,this._normSign();if(this.negative===0&&l.negative!==0)return l.negative=0,v=this.isub(l),l.negative=1,v._normSign();var m,b;this.length>l.length?(m=this,b=l):(m=l,b=this);for(var E=0,P=0;P<b.length;P++)v=(m.words[P]|0)+(b.words[P]|0)+E,this.words[P]=v&67108863,E=v>>>26;for(;E!==0&&P<m.length;P++)v=(m.words[P]|0)+E,this.words[P]=v&67108863,E=v>>>26;if(this.length=m.length,E!==0)this.words[this.length]=E,this.length++;else if(m!==this)for(;P<m.length;P++)this.words[P]=m.words[P];return this},a.prototype.add=function(l){var v;return l.negative!==0&&this.negative===0?(l.negative=0,v=this.sub(l),l.negative^=1,v):l.negative===0&&this.negative!==0?(this.negative=0,v=l.sub(this),this.negative=1,v):this.length>l.length?this.clone().iadd(l):l.clone().iadd(this)},a.prototype.isub=function(l){if(l.negative!==0){l.negative=0;var v=this.iadd(l);return l.negative=1,v._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(l),this.negative=1,this._normSign();var m=this.cmp(l);if(m===0)return this.negative=0,this.length=1,this.words[0]=0,this;var b,E;m>0?(b=this,E=l):(b=l,E=this);for(var P=0,O=0;O<E.length;O++)v=(b.words[O]|0)-(E.words[O]|0)+P,P=v>>26,this.words[O]=v&67108863;for(;P!==0&&O<b.length;O++)v=(b.words[O]|0)+P,P=v>>26,this.words[O]=v&67108863;if(P===0&&O<b.length&&b!==this)for(;O<b.length;O++)this.words[O]=b.words[O];return this.length=Math.max(this.length,O),b!==this&&(this.negative=1),this._strip()},a.prototype.sub=function(l){return this.clone().isub(l)};function Z(l,v,m){m.negative=v.negative^l.negative;var b=l.length+v.length|0;m.length=b,b=b-1|0;var E=l.words[0]|0,P=v.words[0]|0,O=E*P,S=O&67108863,d=O/67108864|0;m.words[0]=S;for(var C=1;C<b;C++){for(var X=d>>>26,rt=d&67108863,_=Math.min(C,v.length-1),W=Math.max(0,C-l.length+1);W<=_;W++){var D=C-W|0;E=l.words[D]|0,P=v.words[W]|0,O=E*P+rt,X+=O/67108864|0,rt=O&67108863}m.words[C]=rt|0,d=X|0}return d!==0?m.words[C]=d|0:m.length--,m._strip()}var H=function(l,v,m){var b=l.words,E=v.words,P=m.words,O=0,S,d,C,X=b[0]|0,rt=X&8191,_=X>>>13,W=b[1]|0,D=W&8191,U=W>>>13,L=b[2]|0,p=L&8191,F=L>>>13,et=b[3]|0,st=et&8191,at=et>>>13,It=b[4]|0,xt=It&8191,At=It>>>13,me=b[5]|0,Ut=me&8191,Et=me>>>13,Ot=b[6]|0,yt=Ot&8191,wt=Ot>>>13,Bt=b[7]|0,mt=Bt&8191,bt=Bt>>>13,Tt=b[8]|0,_t=Tt&8191,St=Tt>>>13,Wt=b[9]|0,Mt=Wt&8191,Ct=Wt>>>13,ee=E[0]|0,Nt=ee&8191,Rt=ee>>>13,He=E[1]|0,se=He&8191,fe=He>>>13,or=E[2]|0,de=or&8191,pe=or>>>13,Sr=E[3]|0,$t=Sr&8191,jt=Sr>>>13,Me=E[4]|0,zt=Me&8191,kt=Me>>>13,Pe=E[5]|0,Ht=Pe&8191,Kt=Pe>>>13,_e=E[6]|0,Vt=_e&8191,Lt=_e>>>13,Ce=E[7]|0,Gt=Ce&8191,Qt=Ce>>>13,Ne=E[8]|0,Jt=Ne&8191,Ee=Ne>>>13,Ui=E[9]|0,Ie=Ui&8191,Ae=Ui>>>13;m.negative=l.negative^v.negative,m.length=19,S=Math.imul(rt,Nt),d=Math.imul(rt,Rt),d=d+Math.imul(_,Nt)|0,C=Math.imul(_,Rt);var fi=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(fi>>>26)|0,fi&=67108863,S=Math.imul(D,Nt),d=Math.imul(D,Rt),d=d+Math.imul(U,Nt)|0,C=Math.imul(U,Rt),S=S+Math.imul(rt,se)|0,d=d+Math.imul(rt,fe)|0,d=d+Math.imul(_,se)|0,C=C+Math.imul(_,fe)|0;var di=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(di>>>26)|0,di&=67108863,S=Math.imul(p,Nt),d=Math.imul(p,Rt),d=d+Math.imul(F,Nt)|0,C=Math.imul(F,Rt),S=S+Math.imul(D,se)|0,d=d+Math.imul(D,fe)|0,d=d+Math.imul(U,se)|0,C=C+Math.imul(U,fe)|0,S=S+Math.imul(rt,de)|0,d=d+Math.imul(rt,pe)|0,d=d+Math.imul(_,de)|0,C=C+Math.imul(_,pe)|0;var pi=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(pi>>>26)|0,pi&=67108863,S=Math.imul(st,Nt),d=Math.imul(st,Rt),d=d+Math.imul(at,Nt)|0,C=Math.imul(at,Rt),S=S+Math.imul(p,se)|0,d=d+Math.imul(p,fe)|0,d=d+Math.imul(F,se)|0,C=C+Math.imul(F,fe)|0,S=S+Math.imul(D,de)|0,d=d+Math.imul(D,pe)|0,d=d+Math.imul(U,de)|0,C=C+Math.imul(U,pe)|0,S=S+Math.imul(rt,$t)|0,d=d+Math.imul(rt,jt)|0,d=d+Math.imul(_,$t)|0,C=C+Math.imul(_,jt)|0;var gi=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(gi>>>26)|0,gi&=67108863,S=Math.imul(xt,Nt),d=Math.imul(xt,Rt),d=d+Math.imul(At,Nt)|0,C=Math.imul(At,Rt),S=S+Math.imul(st,se)|0,d=d+Math.imul(st,fe)|0,d=d+Math.imul(at,se)|0,C=C+Math.imul(at,fe)|0,S=S+Math.imul(p,de)|0,d=d+Math.imul(p,pe)|0,d=d+Math.imul(F,de)|0,C=C+Math.imul(F,pe)|0,S=S+Math.imul(D,$t)|0,d=d+Math.imul(D,jt)|0,d=d+Math.imul(U,$t)|0,C=C+Math.imul(U,jt)|0,S=S+Math.imul(rt,zt)|0,d=d+Math.imul(rt,kt)|0,d=d+Math.imul(_,zt)|0,C=C+Math.imul(_,kt)|0;var mi=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(mi>>>26)|0,mi&=67108863,S=Math.imul(Ut,Nt),d=Math.imul(Ut,Rt),d=d+Math.imul(Et,Nt)|0,C=Math.imul(Et,Rt),S=S+Math.imul(xt,se)|0,d=d+Math.imul(xt,fe)|0,d=d+Math.imul(At,se)|0,C=C+Math.imul(At,fe)|0,S=S+Math.imul(st,de)|0,d=d+Math.imul(st,pe)|0,d=d+Math.imul(at,de)|0,C=C+Math.imul(at,pe)|0,S=S+Math.imul(p,$t)|0,d=d+Math.imul(p,jt)|0,d=d+Math.imul(F,$t)|0,C=C+Math.imul(F,jt)|0,S=S+Math.imul(D,zt)|0,d=d+Math.imul(D,kt)|0,d=d+Math.imul(U,zt)|0,C=C+Math.imul(U,kt)|0,S=S+Math.imul(rt,Ht)|0,d=d+Math.imul(rt,Kt)|0,d=d+Math.imul(_,Ht)|0,C=C+Math.imul(_,Kt)|0;var vi=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(vi>>>26)|0,vi&=67108863,S=Math.imul(yt,Nt),d=Math.imul(yt,Rt),d=d+Math.imul(wt,Nt)|0,C=Math.imul(wt,Rt),S=S+Math.imul(Ut,se)|0,d=d+Math.imul(Ut,fe)|0,d=d+Math.imul(Et,se)|0,C=C+Math.imul(Et,fe)|0,S=S+Math.imul(xt,de)|0,d=d+Math.imul(xt,pe)|0,d=d+Math.imul(At,de)|0,C=C+Math.imul(At,pe)|0,S=S+Math.imul(st,$t)|0,d=d+Math.imul(st,jt)|0,d=d+Math.imul(at,$t)|0,C=C+Math.imul(at,jt)|0,S=S+Math.imul(p,zt)|0,d=d+Math.imul(p,kt)|0,d=d+Math.imul(F,zt)|0,C=C+Math.imul(F,kt)|0,S=S+Math.imul(D,Ht)|0,d=d+Math.imul(D,Kt)|0,d=d+Math.imul(U,Ht)|0,C=C+Math.imul(U,Kt)|0,S=S+Math.imul(rt,Vt)|0,d=d+Math.imul(rt,Lt)|0,d=d+Math.imul(_,Vt)|0,C=C+Math.imul(_,Lt)|0;var rn=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(rn>>>26)|0,rn&=67108863,S=Math.imul(mt,Nt),d=Math.imul(mt,Rt),d=d+Math.imul(bt,Nt)|0,C=Math.imul(bt,Rt),S=S+Math.imul(yt,se)|0,d=d+Math.imul(yt,fe)|0,d=d+Math.imul(wt,se)|0,C=C+Math.imul(wt,fe)|0,S=S+Math.imul(Ut,de)|0,d=d+Math.imul(Ut,pe)|0,d=d+Math.imul(Et,de)|0,C=C+Math.imul(Et,pe)|0,S=S+Math.imul(xt,$t)|0,d=d+Math.imul(xt,jt)|0,d=d+Math.imul(At,$t)|0,C=C+Math.imul(At,jt)|0,S=S+Math.imul(st,zt)|0,d=d+Math.imul(st,kt)|0,d=d+Math.imul(at,zt)|0,C=C+Math.imul(at,kt)|0,S=S+Math.imul(p,Ht)|0,d=d+Math.imul(p,Kt)|0,d=d+Math.imul(F,Ht)|0,C=C+Math.imul(F,Kt)|0,S=S+Math.imul(D,Vt)|0,d=d+Math.imul(D,Lt)|0,d=d+Math.imul(U,Vt)|0,C=C+Math.imul(U,Lt)|0,S=S+Math.imul(rt,Gt)|0,d=d+Math.imul(rt,Qt)|0,d=d+Math.imul(_,Gt)|0,C=C+Math.imul(_,Qt)|0;var Ps=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Ps>>>26)|0,Ps&=67108863,S=Math.imul(_t,Nt),d=Math.imul(_t,Rt),d=d+Math.imul(St,Nt)|0,C=Math.imul(St,Rt),S=S+Math.imul(mt,se)|0,d=d+Math.imul(mt,fe)|0,d=d+Math.imul(bt,se)|0,C=C+Math.imul(bt,fe)|0,S=S+Math.imul(yt,de)|0,d=d+Math.imul(yt,pe)|0,d=d+Math.imul(wt,de)|0,C=C+Math.imul(wt,pe)|0,S=S+Math.imul(Ut,$t)|0,d=d+Math.imul(Ut,jt)|0,d=d+Math.imul(Et,$t)|0,C=C+Math.imul(Et,jt)|0,S=S+Math.imul(xt,zt)|0,d=d+Math.imul(xt,kt)|0,d=d+Math.imul(At,zt)|0,C=C+Math.imul(At,kt)|0,S=S+Math.imul(st,Ht)|0,d=d+Math.imul(st,Kt)|0,d=d+Math.imul(at,Ht)|0,C=C+Math.imul(at,Kt)|0,S=S+Math.imul(p,Vt)|0,d=d+Math.imul(p,Lt)|0,d=d+Math.imul(F,Vt)|0,C=C+Math.imul(F,Lt)|0,S=S+Math.imul(D,Gt)|0,d=d+Math.imul(D,Qt)|0,d=d+Math.imul(U,Gt)|0,C=C+Math.imul(U,Qt)|0,S=S+Math.imul(rt,Jt)|0,d=d+Math.imul(rt,Ee)|0,d=d+Math.imul(_,Jt)|0,C=C+Math.imul(_,Ee)|0;var nn=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(nn>>>26)|0,nn&=67108863,S=Math.imul(Mt,Nt),d=Math.imul(Mt,Rt),d=d+Math.imul(Ct,Nt)|0,C=Math.imul(Ct,Rt),S=S+Math.imul(_t,se)|0,d=d+Math.imul(_t,fe)|0,d=d+Math.imul(St,se)|0,C=C+Math.imul(St,fe)|0,S=S+Math.imul(mt,de)|0,d=d+Math.imul(mt,pe)|0,d=d+Math.imul(bt,de)|0,C=C+Math.imul(bt,pe)|0,S=S+Math.imul(yt,$t)|0,d=d+Math.imul(yt,jt)|0,d=d+Math.imul(wt,$t)|0,C=C+Math.imul(wt,jt)|0,S=S+Math.imul(Ut,zt)|0,d=d+Math.imul(Ut,kt)|0,d=d+Math.imul(Et,zt)|0,C=C+Math.imul(Et,kt)|0,S=S+Math.imul(xt,Ht)|0,d=d+Math.imul(xt,Kt)|0,d=d+Math.imul(At,Ht)|0,C=C+Math.imul(At,Kt)|0,S=S+Math.imul(st,Vt)|0,d=d+Math.imul(st,Lt)|0,d=d+Math.imul(at,Vt)|0,C=C+Math.imul(at,Lt)|0,S=S+Math.imul(p,Gt)|0,d=d+Math.imul(p,Qt)|0,d=d+Math.imul(F,Gt)|0,C=C+Math.imul(F,Qt)|0,S=S+Math.imul(D,Jt)|0,d=d+Math.imul(D,Ee)|0,d=d+Math.imul(U,Jt)|0,C=C+Math.imul(U,Ee)|0,S=S+Math.imul(rt,Ie)|0,d=d+Math.imul(rt,Ae)|0,d=d+Math.imul(_,Ie)|0,C=C+Math.imul(_,Ae)|0;var Cs=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Cs>>>26)|0,Cs&=67108863,S=Math.imul(Mt,se),d=Math.imul(Mt,fe),d=d+Math.imul(Ct,se)|0,C=Math.imul(Ct,fe),S=S+Math.imul(_t,de)|0,d=d+Math.imul(_t,pe)|0,d=d+Math.imul(St,de)|0,C=C+Math.imul(St,pe)|0,S=S+Math.imul(mt,$t)|0,d=d+Math.imul(mt,jt)|0,d=d+Math.imul(bt,$t)|0,C=C+Math.imul(bt,jt)|0,S=S+Math.imul(yt,zt)|0,d=d+Math.imul(yt,kt)|0,d=d+Math.imul(wt,zt)|0,C=C+Math.imul(wt,kt)|0,S=S+Math.imul(Ut,Ht)|0,d=d+Math.imul(Ut,Kt)|0,d=d+Math.imul(Et,Ht)|0,C=C+Math.imul(Et,Kt)|0,S=S+Math.imul(xt,Vt)|0,d=d+Math.imul(xt,Lt)|0,d=d+Math.imul(At,Vt)|0,C=C+Math.imul(At,Lt)|0,S=S+Math.imul(st,Gt)|0,d=d+Math.imul(st,Qt)|0,d=d+Math.imul(at,Gt)|0,C=C+Math.imul(at,Qt)|0,S=S+Math.imul(p,Jt)|0,d=d+Math.imul(p,Ee)|0,d=d+Math.imul(F,Jt)|0,C=C+Math.imul(F,Ee)|0,S=S+Math.imul(D,Ie)|0,d=d+Math.imul(D,Ae)|0,d=d+Math.imul(U,Ie)|0,C=C+Math.imul(U,Ae)|0;var Ns=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Ns>>>26)|0,Ns&=67108863,S=Math.imul(Mt,de),d=Math.imul(Mt,pe),d=d+Math.imul(Ct,de)|0,C=Math.imul(Ct,pe),S=S+Math.imul(_t,$t)|0,d=d+Math.imul(_t,jt)|0,d=d+Math.imul(St,$t)|0,C=C+Math.imul(St,jt)|0,S=S+Math.imul(mt,zt)|0,d=d+Math.imul(mt,kt)|0,d=d+Math.imul(bt,zt)|0,C=C+Math.imul(bt,kt)|0,S=S+Math.imul(yt,Ht)|0,d=d+Math.imul(yt,Kt)|0,d=d+Math.imul(wt,Ht)|0,C=C+Math.imul(wt,Kt)|0,S=S+Math.imul(Ut,Vt)|0,d=d+Math.imul(Ut,Lt)|0,d=d+Math.imul(Et,Vt)|0,C=C+Math.imul(Et,Lt)|0,S=S+Math.imul(xt,Gt)|0,d=d+Math.imul(xt,Qt)|0,d=d+Math.imul(At,Gt)|0,C=C+Math.imul(At,Qt)|0,S=S+Math.imul(st,Jt)|0,d=d+Math.imul(st,Ee)|0,d=d+Math.imul(at,Jt)|0,C=C+Math.imul(at,Ee)|0,S=S+Math.imul(p,Ie)|0,d=d+Math.imul(p,Ae)|0,d=d+Math.imul(F,Ie)|0,C=C+Math.imul(F,Ae)|0;var Rs=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Rs>>>26)|0,Rs&=67108863,S=Math.imul(Mt,$t),d=Math.imul(Mt,jt),d=d+Math.imul(Ct,$t)|0,C=Math.imul(Ct,jt),S=S+Math.imul(_t,zt)|0,d=d+Math.imul(_t,kt)|0,d=d+Math.imul(St,zt)|0,C=C+Math.imul(St,kt)|0,S=S+Math.imul(mt,Ht)|0,d=d+Math.imul(mt,Kt)|0,d=d+Math.imul(bt,Ht)|0,C=C+Math.imul(bt,Kt)|0,S=S+Math.imul(yt,Vt)|0,d=d+Math.imul(yt,Lt)|0,d=d+Math.imul(wt,Vt)|0,C=C+Math.imul(wt,Lt)|0,S=S+Math.imul(Ut,Gt)|0,d=d+Math.imul(Ut,Qt)|0,d=d+Math.imul(Et,Gt)|0,C=C+Math.imul(Et,Qt)|0,S=S+Math.imul(xt,Jt)|0,d=d+Math.imul(xt,Ee)|0,d=d+Math.imul(At,Jt)|0,C=C+Math.imul(At,Ee)|0,S=S+Math.imul(st,Ie)|0,d=d+Math.imul(st,Ae)|0,d=d+Math.imul(at,Ie)|0,C=C+Math.imul(at,Ae)|0;var zn=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(zn>>>26)|0,zn&=67108863,S=Math.imul(Mt,zt),d=Math.imul(Mt,kt),d=d+Math.imul(Ct,zt)|0,C=Math.imul(Ct,kt),S=S+Math.imul(_t,Ht)|0,d=d+Math.imul(_t,Kt)|0,d=d+Math.imul(St,Ht)|0,C=C+Math.imul(St,Kt)|0,S=S+Math.imul(mt,Vt)|0,d=d+Math.imul(mt,Lt)|0,d=d+Math.imul(bt,Vt)|0,C=C+Math.imul(bt,Lt)|0,S=S+Math.imul(yt,Gt)|0,d=d+Math.imul(yt,Qt)|0,d=d+Math.imul(wt,Gt)|0,C=C+Math.imul(wt,Qt)|0,S=S+Math.imul(Ut,Jt)|0,d=d+Math.imul(Ut,Ee)|0,d=d+Math.imul(Et,Jt)|0,C=C+Math.imul(Et,Ee)|0,S=S+Math.imul(xt,Ie)|0,d=d+Math.imul(xt,Ae)|0,d=d+Math.imul(At,Ie)|0,C=C+Math.imul(At,Ae)|0;var Hn=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Hn>>>26)|0,Hn&=67108863,S=Math.imul(Mt,Ht),d=Math.imul(Mt,Kt),d=d+Math.imul(Ct,Ht)|0,C=Math.imul(Ct,Kt),S=S+Math.imul(_t,Vt)|0,d=d+Math.imul(_t,Lt)|0,d=d+Math.imul(St,Vt)|0,C=C+Math.imul(St,Lt)|0,S=S+Math.imul(mt,Gt)|0,d=d+Math.imul(mt,Qt)|0,d=d+Math.imul(bt,Gt)|0,C=C+Math.imul(bt,Qt)|0,S=S+Math.imul(yt,Jt)|0,d=d+Math.imul(yt,Ee)|0,d=d+Math.imul(wt,Jt)|0,C=C+Math.imul(wt,Ee)|0,S=S+Math.imul(Ut,Ie)|0,d=d+Math.imul(Ut,Ae)|0,d=d+Math.imul(Et,Ie)|0,C=C+Math.imul(Et,Ae)|0;var Kn=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Kn>>>26)|0,Kn&=67108863,S=Math.imul(Mt,Vt),d=Math.imul(Mt,Lt),d=d+Math.imul(Ct,Vt)|0,C=Math.imul(Ct,Lt),S=S+Math.imul(_t,Gt)|0,d=d+Math.imul(_t,Qt)|0,d=d+Math.imul(St,Gt)|0,C=C+Math.imul(St,Qt)|0,S=S+Math.imul(mt,Jt)|0,d=d+Math.imul(mt,Ee)|0,d=d+Math.imul(bt,Jt)|0,C=C+Math.imul(bt,Ee)|0,S=S+Math.imul(yt,Ie)|0,d=d+Math.imul(yt,Ae)|0,d=d+Math.imul(wt,Ie)|0,C=C+Math.imul(wt,Ae)|0;var Os=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Os>>>26)|0,Os&=67108863,S=Math.imul(Mt,Gt),d=Math.imul(Mt,Qt),d=d+Math.imul(Ct,Gt)|0,C=Math.imul(Ct,Qt),S=S+Math.imul(_t,Jt)|0,d=d+Math.imul(_t,Ee)|0,d=d+Math.imul(St,Jt)|0,C=C+Math.imul(St,Ee)|0,S=S+Math.imul(mt,Ie)|0,d=d+Math.imul(mt,Ae)|0,d=d+Math.imul(bt,Ie)|0,C=C+Math.imul(bt,Ae)|0;var Ts=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Ts>>>26)|0,Ts&=67108863,S=Math.imul(Mt,Jt),d=Math.imul(Mt,Ee),d=d+Math.imul(Ct,Jt)|0,C=Math.imul(Ct,Ee),S=S+Math.imul(_t,Ie)|0,d=d+Math.imul(_t,Ae)|0,d=d+Math.imul(St,Ie)|0,C=C+Math.imul(St,Ae)|0;var Fs=(O+S|0)+((d&8191)<<13)|0;O=(C+(d>>>13)|0)+(Fs>>>26)|0,Fs&=67108863,S=Math.imul(Mt,Ie),d=Math.imul(Mt,Ae),d=d+Math.imul(Ct,Ie)|0,C=Math.imul(Ct,Ae);var Ds=(O+S|0)+((d&8191)<<13)|0;return O=(C+(d>>>13)|0)+(Ds>>>26)|0,Ds&=67108863,P[0]=fi,P[1]=di,P[2]=pi,P[3]=gi,P[4]=mi,P[5]=vi,P[6]=rn,P[7]=Ps,P[8]=nn,P[9]=Cs,P[10]=Ns,P[11]=Rs,P[12]=zn,P[13]=Hn,P[14]=Kn,P[15]=Os,P[16]=Ts,P[17]=Fs,P[18]=Ds,O!==0&&(P[19]=O,m.length++),m};Math.imul||(H=Z);function J(l,v,m){m.negative=v.negative^l.negative,m.length=l.length+v.length;for(var b=0,E=0,P=0;P<m.length-1;P++){var O=E;E=0;for(var S=b&67108863,d=Math.min(P,v.length-1),C=Math.max(0,P-l.length+1);C<=d;C++){var X=P-C,rt=l.words[X]|0,_=v.words[C]|0,W=rt*_,D=W&67108863;O=O+(W/67108864|0)|0,D=D+S|0,S=D&67108863,O=O+(D>>>26)|0,E+=O>>>26,O&=67108863}m.words[P]=S,b=O,O=E}return b!==0?m.words[P]=b:m.length--,m._strip()}function B(l,v,m){return J(l,v,m)}a.prototype.mulTo=function(l,v){var m,b=this.length+l.length;return this.length===10&&l.length===10?m=H(this,l,v):b<63?m=Z(this,l,v):b<1024?m=J(this,l,v):m=B(this,l,v),m},a.prototype.mul=function(l){var v=new a(null);return v.words=new Array(this.length+l.length),this.mulTo(l,v)},a.prototype.mulf=function(l){var v=new a(null);return v.words=new Array(this.length+l.length),B(this,l,v)},a.prototype.imul=function(l){return this.clone().mulTo(l,this)},a.prototype.imuln=function(l){var v=l<0;v&&(l=-l),n(typeof l=="number"),n(l<67108864);for(var m=0,b=0;b<this.length;b++){var E=(this.words[b]|0)*l,P=(E&67108863)+(m&67108863);m>>=26,m+=E/67108864|0,m+=P>>>26,this.words[b]=P&67108863}return m!==0&&(this.words[b]=m,this.length++),v?this.ineg():this},a.prototype.muln=function(l){return this.clone().imuln(l)},a.prototype.sqr=function(){return this.mul(this)},a.prototype.isqr=function(){return this.imul(this.clone())},a.prototype.pow=function(l){var v=V(l);if(v.length===0)return new a(1);for(var m=this,b=0;b<v.length&&v[b]===0;b++,m=m.sqr());if(++b<v.length)for(var E=m.sqr();b<v.length;b++,E=E.sqr())v[b]!==0&&(m=m.mul(E));return m},a.prototype.iushln=function(l){n(typeof l=="number"&&l>=0);var v=l%26,m=(l-v)/26,b=67108863>>>26-v<<26-v,E;if(v!==0){var P=0;for(E=0;E<this.length;E++){var O=this.words[E]&b,S=(this.words[E]|0)-O<<v;this.words[E]=S|P,P=O>>>26-v}P&&(this.words[E]=P,this.length++)}if(m!==0){for(E=this.length-1;E>=0;E--)this.words[E+m]=this.words[E];for(E=0;E<m;E++)this.words[E]=0;this.length+=m}return this._strip()},a.prototype.ishln=function(l){return n(this.negative===0),this.iushln(l)},a.prototype.iushrn=function(l,v,m){n(typeof l=="number"&&l>=0);var b;v?b=(v-v%26)/26:b=0;var E=l%26,P=Math.min((l-E)/26,this.length),O=67108863^67108863>>>E<<E,S=m;if(b-=P,b=Math.max(0,b),S){for(var d=0;d<P;d++)S.words[d]=this.words[d];S.length=P}if(P!==0)if(this.length>P)for(this.length-=P,d=0;d<this.length;d++)this.words[d]=this.words[d+P];else this.words[0]=0,this.length=1;var C=0;for(d=this.length-1;d>=0&&(C!==0||d>=b);d--){var X=this.words[d]|0;this.words[d]=C<<26-E|X>>>E,C=X&O}return S&&C!==0&&(S.words[S.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},a.prototype.ishrn=function(l,v,m){return n(this.negative===0),this.iushrn(l,v,m)},a.prototype.shln=function(l){return this.clone().ishln(l)},a.prototype.ushln=function(l){return this.clone().iushln(l)},a.prototype.shrn=function(l){return this.clone().ishrn(l)},a.prototype.ushrn=function(l){return this.clone().iushrn(l)},a.prototype.testn=function(l){n(typeof l=="number"&&l>=0);var v=l%26,m=(l-v)/26,b=1<<v;if(this.length<=m)return!1;var E=this.words[m];return!!(E&b)},a.prototype.imaskn=function(l){n(typeof l=="number"&&l>=0);var v=l%26,m=(l-v)/26;if(n(this.negative===0,"imaskn works only with positive numbers"),this.length<=m)return this;if(v!==0&&m++,this.length=Math.min(m,this.length),v!==0){var b=67108863^67108863>>>v<<v;this.words[this.length-1]&=b}return this._strip()},a.prototype.maskn=function(l){return this.clone().imaskn(l)},a.prototype.iaddn=function(l){return n(typeof l=="number"),n(l<67108864),l<0?this.isubn(-l):this.negative!==0?this.length===1&&(this.words[0]|0)<=l?(this.words[0]=l-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(l),this.negative=1,this):this._iaddn(l)},a.prototype._iaddn=function(l){this.words[0]+=l;for(var v=0;v<this.length&&this.words[v]>=67108864;v++)this.words[v]-=67108864,v===this.length-1?this.words[v+1]=1:this.words[v+1]++;return this.length=Math.max(this.length,v+1),this},a.prototype.isubn=function(l){if(n(typeof l=="number"),n(l<67108864),l<0)return this.iaddn(-l);if(this.negative!==0)return this.negative=0,this.iaddn(l),this.negative=1,this;if(this.words[0]-=l,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var v=0;v<this.length&&this.words[v]<0;v++)this.words[v]+=67108864,this.words[v+1]-=1;return this._strip()},a.prototype.addn=function(l){return this.clone().iaddn(l)},a.prototype.subn=function(l){return this.clone().isubn(l)},a.prototype.iabs=function(){return this.negative=0,this},a.prototype.abs=function(){return this.clone().iabs()},a.prototype._ishlnsubmul=function(l,v,m){var b=l.length+m,E;this._expand(b);var P,O=0;for(E=0;E<l.length;E++){P=(this.words[E+m]|0)+O;var S=(l.words[E]|0)*v;P-=S&67108863,O=(P>>26)-(S/67108864|0),this.words[E+m]=P&67108863}for(;E<this.length-m;E++)P=(this.words[E+m]|0)+O,O=P>>26,this.words[E+m]=P&67108863;if(O===0)return this._strip();for(n(O===-1),O=0,E=0;E<this.length;E++)P=-(this.words[E]|0)+O,O=P>>26,this.words[E]=P&67108863;return this.negative=1,this._strip()},a.prototype._wordDiv=function(l,v){var m=this.length-l.length,b=this.clone(),E=l,P=E.words[E.length-1]|0,O=this._countBits(P);m=26-O,m!==0&&(E=E.ushln(m),b.iushln(m),P=E.words[E.length-1]|0);var S=b.length-E.length,d;if(v!=="mod"){d=new a(null),d.length=S+1,d.words=new Array(d.length);for(var C=0;C<d.length;C++)d.words[C]=0}var X=b.clone()._ishlnsubmul(E,1,S);X.negative===0&&(b=X,d&&(d.words[S]=1));for(var rt=S-1;rt>=0;rt--){var _=(b.words[E.length+rt]|0)*67108864+(b.words[E.length+rt-1]|0);for(_=Math.min(_/P|0,67108863),b._ishlnsubmul(E,_,rt);b.negative!==0;)_--,b.negative=0,b._ishlnsubmul(E,1,rt),b.isZero()||(b.negative^=1);d&&(d.words[rt]=_)}return d&&d._strip(),b._strip(),v!=="div"&&m!==0&&b.iushrn(m),{div:d||null,mod:b}},a.prototype.divmod=function(l,v,m){if(n(!l.isZero()),this.isZero())return{div:new a(0),mod:new a(0)};var b,E,P;return this.negative!==0&&l.negative===0?(P=this.neg().divmod(l,v),v!=="mod"&&(b=P.div.neg()),v!=="div"&&(E=P.mod.neg(),m&&E.negative!==0&&E.iadd(l)),{div:b,mod:E}):this.negative===0&&l.negative!==0?(P=this.divmod(l.neg(),v),v!=="mod"&&(b=P.div.neg()),{div:b,mod:P.mod}):this.negative&l.negative?(P=this.neg().divmod(l.neg(),v),v!=="div"&&(E=P.mod.neg(),m&&E.negative!==0&&E.isub(l)),{div:P.div,mod:E}):l.length>this.length||this.cmp(l)<0?{div:new a(0),mod:this}:l.length===1?v==="div"?{div:this.divn(l.words[0]),mod:null}:v==="mod"?{div:null,mod:new a(this.modrn(l.words[0]))}:{div:this.divn(l.words[0]),mod:new a(this.modrn(l.words[0]))}:this._wordDiv(l,v)},a.prototype.div=function(l){return this.divmod(l,"div",!1).div},a.prototype.mod=function(l){return this.divmod(l,"mod",!1).mod},a.prototype.umod=function(l){return this.divmod(l,"mod",!0).mod},a.prototype.divRound=function(l){var v=this.divmod(l);if(v.mod.isZero())return v.div;var m=v.div.negative!==0?v.mod.isub(l):v.mod,b=l.ushrn(1),E=l.andln(1),P=m.cmp(b);return P<0||E===1&&P===0?v.div:v.div.negative!==0?v.div.isubn(1):v.div.iaddn(1)},a.prototype.modrn=function(l){var v=l<0;v&&(l=-l),n(l<=67108863);for(var m=(1<<26)%l,b=0,E=this.length-1;E>=0;E--)b=(m*b+(this.words[E]|0))%l;return v?-b:b},a.prototype.modn=function(l){return this.modrn(l)},a.prototype.idivn=function(l){var v=l<0;v&&(l=-l),n(l<=67108863);for(var m=0,b=this.length-1;b>=0;b--){var E=(this.words[b]|0)+m*67108864;this.words[b]=E/l|0,m=E%l}return this._strip(),v?this.ineg():this},a.prototype.divn=function(l){return this.clone().idivn(l)},a.prototype.egcd=function(l){n(l.negative===0),n(!l.isZero());var v=this,m=l.clone();v.negative!==0?v=v.umod(l):v=v.clone();for(var b=new a(1),E=new a(0),P=new a(0),O=new a(1),S=0;v.isEven()&&m.isEven();)v.iushrn(1),m.iushrn(1),++S;for(var d=m.clone(),C=v.clone();!v.isZero();){for(var X=0,rt=1;!(v.words[0]&rt)&&X<26;++X,rt<<=1);if(X>0)for(v.iushrn(X);X-- >0;)(b.isOdd()||E.isOdd())&&(b.iadd(d),E.isub(C)),b.iushrn(1),E.iushrn(1);for(var _=0,W=1;!(m.words[0]&W)&&_<26;++_,W<<=1);if(_>0)for(m.iushrn(_);_-- >0;)(P.isOdd()||O.isOdd())&&(P.iadd(d),O.isub(C)),P.iushrn(1),O.iushrn(1);v.cmp(m)>=0?(v.isub(m),b.isub(P),E.isub(O)):(m.isub(v),P.isub(b),O.isub(E))}return{a:P,b:O,gcd:m.iushln(S)}},a.prototype._invmp=function(l){n(l.negative===0),n(!l.isZero());var v=this,m=l.clone();v.negative!==0?v=v.umod(l):v=v.clone();for(var b=new a(1),E=new a(0),P=m.clone();v.cmpn(1)>0&&m.cmpn(1)>0;){for(var O=0,S=1;!(v.words[0]&S)&&O<26;++O,S<<=1);if(O>0)for(v.iushrn(O);O-- >0;)b.isOdd()&&b.iadd(P),b.iushrn(1);for(var d=0,C=1;!(m.words[0]&C)&&d<26;++d,C<<=1);if(d>0)for(m.iushrn(d);d-- >0;)E.isOdd()&&E.iadd(P),E.iushrn(1);v.cmp(m)>=0?(v.isub(m),b.isub(E)):(m.isub(v),E.isub(b))}var X;return v.cmpn(1)===0?X=b:X=E,X.cmpn(0)<0&&X.iadd(l),X},a.prototype.gcd=function(l){if(this.isZero())return l.abs();if(l.isZero())return this.abs();var v=this.clone(),m=l.clone();v.negative=0,m.negative=0;for(var b=0;v.isEven()&&m.isEven();b++)v.iushrn(1),m.iushrn(1);do{for(;v.isEven();)v.iushrn(1);for(;m.isEven();)m.iushrn(1);var E=v.cmp(m);if(E<0){var P=v;v=m,m=P}else if(E===0||m.cmpn(1)===0)break;v.isub(m)}while(!0);return m.iushln(b)},a.prototype.invm=function(l){return this.egcd(l).a.umod(l)},a.prototype.isEven=function(){return(this.words[0]&1)===0},a.prototype.isOdd=function(){return(this.words[0]&1)===1},a.prototype.andln=function(l){return this.words[0]&l},a.prototype.bincn=function(l){n(typeof l=="number");var v=l%26,m=(l-v)/26,b=1<<v;if(this.length<=m)return this._expand(m+1),this.words[m]|=b,this;for(var E=b,P=m;E!==0&&P<this.length;P++){var O=this.words[P]|0;O+=E,E=O>>>26,O&=67108863,this.words[P]=O}return E!==0&&(this.words[P]=E,this.length++),this},a.prototype.isZero=function(){return this.length===1&&this.words[0]===0},a.prototype.cmpn=function(l){var v=l<0;if(this.negative!==0&&!v)return-1;if(this.negative===0&&v)return 1;this._strip();var m;if(this.length>1)m=1;else{v&&(l=-l),n(l<=67108863,"Number is too big");var b=this.words[0]|0;m=b===l?0:b<l?-1:1}return this.negative!==0?-m|0:m},a.prototype.cmp=function(l){if(this.negative!==0&&l.negative===0)return-1;if(this.negative===0&&l.negative!==0)return 1;var v=this.ucmp(l);return this.negative!==0?-v|0:v},a.prototype.ucmp=function(l){if(this.length>l.length)return 1;if(this.length<l.length)return-1;for(var v=0,m=this.length-1;m>=0;m--){var b=this.words[m]|0,E=l.words[m]|0;if(b!==E){b<E?v=-1:b>E&&(v=1);break}}return v},a.prototype.gtn=function(l){return this.cmpn(l)===1},a.prototype.gt=function(l){return this.cmp(l)===1},a.prototype.gten=function(l){return this.cmpn(l)>=0},a.prototype.gte=function(l){return this.cmp(l)>=0},a.prototype.ltn=function(l){return this.cmpn(l)===-1},a.prototype.lt=function(l){return this.cmp(l)===-1},a.prototype.lten=function(l){return this.cmpn(l)<=0},a.prototype.lte=function(l){return this.cmp(l)<=0},a.prototype.eqn=function(l){return this.cmpn(l)===0},a.prototype.eq=function(l){return this.cmp(l)===0},a.red=function(l){return new lt(l)},a.prototype.toRed=function(l){return n(!this.red,"Already a number in reduction context"),n(this.negative===0,"red works only with positives"),l.convertTo(this)._forceRed(l)},a.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},a.prototype._forceRed=function(l){return this.red=l,this},a.prototype.forceRed=function(l){return n(!this.red,"Already a number in reduction context"),this._forceRed(l)},a.prototype.redAdd=function(l){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,l)},a.prototype.redIAdd=function(l){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,l)},a.prototype.redSub=function(l){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,l)},a.prototype.redISub=function(l){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,l)},a.prototype.redShl=function(l){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,l)},a.prototype.redMul=function(l){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.mul(this,l)},a.prototype.redIMul=function(l){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,l),this.red.imul(this,l)},a.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},a.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},a.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},a.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},a.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},a.prototype.redPow=function(l){return n(this.red&&!l.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,l)};var k={k256:null,p224:null,p192:null,p25519:null};function z(l,v){this.name=l,this.p=new a(v,16),this.n=this.p.bitLength(),this.k=new a(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}z.prototype._tmp=function(){var l=new a(null);return l.words=new Array(Math.ceil(this.n/13)),l},z.prototype.ireduce=function(l){var v=l,m;do this.split(v,this.tmp),v=this.imulK(v),v=v.iadd(this.tmp),m=v.bitLength();while(m>this.n);var b=m<this.n?-1:v.ucmp(this.p);return b===0?(v.words[0]=0,v.length=1):b>0?v.isub(this.p):v.strip!==void 0?v.strip():v._strip(),v},z.prototype.split=function(l,v){l.iushrn(this.n,0,v)},z.prototype.imulK=function(l){return l.imul(this.k)};function w(){z.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}s(w,z),w.prototype.split=function(l,v){for(var m=4194303,b=Math.min(l.length,9),E=0;E<b;E++)v.words[E]=l.words[E];if(v.length=b,l.length<=9){l.words[0]=0,l.length=1;return}var P=l.words[9];for(v.words[v.length++]=P&m,E=10;E<l.length;E++){var O=l.words[E]|0;l.words[E-10]=(O&m)<<4|P>>>22,P=O}P>>>=22,l.words[E-10]=P,P===0&&l.length>10?l.length-=10:l.length-=9},w.prototype.imulK=function(l){l.words[l.length]=0,l.words[l.length+1]=0,l.length+=2;for(var v=0,m=0;m<l.length;m++){var b=l.words[m]|0;v+=b*977,l.words[m]=v&67108863,v=b*64+(v/67108864|0)}return l.words[l.length-1]===0&&(l.length--,l.words[l.length-1]===0&&l.length--),l};function q(){z.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}s(q,z);function ht(){z.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}s(ht,z);function ut(){z.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}s(ut,z),ut.prototype.imulK=function(l){for(var v=0,m=0;m<l.length;m++){var b=(l.words[m]|0)*19+v,E=b&67108863;b>>>=26,l.words[m]=E,v=b}return v!==0&&(l.words[l.length++]=v),l},a._prime=function(l){if(k[l])return k[l];var v;if(l==="k256")v=new w;else if(l==="p224")v=new q;else if(l==="p192")v=new ht;else if(l==="p25519")v=new ut;else throw new Error("Unknown prime "+l);return k[l]=v,v};function lt(l){if(typeof l=="string"){var v=a._prime(l);this.m=v.p,this.prime=v}else n(l.gtn(1),"modulus must be greater than 1"),this.m=l,this.prime=null}lt.prototype._verify1=function(l){n(l.negative===0,"red works only with positives"),n(l.red,"red works only with red numbers")},lt.prototype._verify2=function(l,v){n((l.negative|v.negative)===0,"red works only with positives"),n(l.red&&l.red===v.red,"red works only with red numbers")},lt.prototype.imod=function(l){return this.prime?this.prime.ireduce(l)._forceRed(this):(A(l,l.umod(this.m)._forceRed(this)),l)},lt.prototype.neg=function(l){return l.isZero()?l.clone():this.m.sub(l)._forceRed(this)},lt.prototype.add=function(l,v){this._verify2(l,v);var m=l.add(v);return m.cmp(this.m)>=0&&m.isub(this.m),m._forceRed(this)},lt.prototype.iadd=function(l,v){this._verify2(l,v);var m=l.iadd(v);return m.cmp(this.m)>=0&&m.isub(this.m),m},lt.prototype.sub=function(l,v){this._verify2(l,v);var m=l.sub(v);return m.cmpn(0)<0&&m.iadd(this.m),m._forceRed(this)},lt.prototype.isub=function(l,v){this._verify2(l,v);var m=l.isub(v);return m.cmpn(0)<0&&m.iadd(this.m),m},lt.prototype.shl=function(l,v){return this._verify1(l),this.imod(l.ushln(v))},lt.prototype.imul=function(l,v){return this._verify2(l,v),this.imod(l.imul(v))},lt.prototype.mul=function(l,v){return this._verify2(l,v),this.imod(l.mul(v))},lt.prototype.isqr=function(l){return this.imul(l,l.clone())},lt.prototype.sqr=function(l){return this.mul(l,l)},lt.prototype.sqrt=function(l){if(l.isZero())return l.clone();var v=this.m.andln(3);if(n(v%2===1),v===3){var m=this.m.add(new a(1)).iushrn(2);return this.pow(l,m)}for(var b=this.m.subn(1),E=0;!b.isZero()&&b.andln(1)===0;)E++,b.iushrn(1);n(!b.isZero());var P=new a(1).toRed(this),O=P.redNeg(),S=this.m.subn(1).iushrn(1),d=this.m.bitLength();for(d=new a(2*d*d).toRed(this);this.pow(d,S).cmp(O)!==0;)d.redIAdd(O);for(var C=this.pow(d,b),X=this.pow(l,b.addn(1).iushrn(1)),rt=this.pow(l,b),_=E;rt.cmp(P)!==0;){for(var W=rt,D=0;W.cmp(P)!==0;D++)W=W.redSqr();n(D<_);var U=this.pow(C,new a(1).iushln(_-D-1));X=X.redMul(U),C=U.redSqr(),rt=rt.redMul(C),_=D}return X},lt.prototype.invm=function(l){var v=l._invmp(this.m);return v.negative!==0?(v.negative=0,this.imod(v).redNeg()):this.imod(v)},lt.prototype.pow=function(l,v){if(v.isZero())return new a(1).toRed(this);if(v.cmpn(1)===0)return l.clone();var m=4,b=new Array(1<<m);b[0]=new a(1).toRed(this),b[1]=l;for(var E=2;E<b.length;E++)b[E]=this.mul(b[E-1],l);var P=b[0],O=0,S=0,d=v.bitLength()%26;for(d===0&&(d=26),E=v.length-1;E>=0;E--){for(var C=v.words[E],X=d-1;X>=0;X--){var rt=C>>X&1;if(P!==b[0]&&(P=this.sqr(P)),rt===0&&O===0){S=0;continue}O<<=1,O|=rt,S++,!(S!==m&&(E!==0||X!==0))&&(P=this.mul(P,b[O]),S=0,O=0)}d=26}return P},lt.prototype.convertTo=function(l){var v=l.umod(this.m);return v===l?v.clone():v},lt.prototype.convertFrom=function(l){var v=l.clone();return v.red=null,v},a.mont=function(l){return new gt(l)};function gt(l){lt.call(this,l),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new a(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}s(gt,lt),gt.prototype.convertTo=function(l){return this.imod(l.ushln(this.shift))},gt.prototype.convertFrom=function(l){var v=this.imod(l.mul(this.rinv));return v.red=null,v},gt.prototype.imul=function(l,v){if(l.isZero()||v.isZero())return l.words[0]=0,l.length=1,l;var m=l.imul(v),b=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=m.isub(b).iushrn(this.shift),P=E;return E.cmp(this.m)>=0?P=E.isub(this.m):E.cmpn(0)<0&&(P=E.iadd(this.m)),P._forceRed(this)},gt.prototype.mul=function(l,v){if(l.isZero()||v.isZero())return new a(0)._forceRed(this);var m=l.mul(v),b=m.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=m.isub(b).iushrn(this.shift),P=E;return E.cmp(this.m)>=0?P=E.isub(this.m):E.cmpn(0)<0&&(P=E.iadd(this.m)),P._forceRed(this)},gt.prototype.invm=function(l){var v=this.imod(l._invmp(this.m).mul(this.r2));return v._forceRed(this)}})(r,T0)})(U0);var Zt=U0.exports;const B0="bignumber/5.7.0";var za=Zt.BN;const Yi=new er(B0),Rh={},y3=9007199254740991;function w3(r){return r!=null&&(Oe.isBigNumber(r)||typeof r=="number"&&r%1===0||typeof r=="string"&&!!r.match(/^-?[0-9]+$/)||Tr(r)||typeof r=="bigint"||As(r))}let Wd=!1;class Oe{constructor(t,e){t!==Rh&&Yi.throwError("cannot call constructor directly; use BigNumber.from",er.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=e,this._isBigNumber=!0,Object.freeze(this)}fromTwos(t){return br(he(this).fromTwos(t))}toTwos(t){return br(he(this).toTwos(t))}abs(){return this._hex[0]==="-"?Oe.from(this._hex.substring(1)):this}add(t){return br(he(this).add(he(t)))}sub(t){return br(he(this).sub(he(t)))}div(t){return Oe.from(t).isZero()&&Hr("division-by-zero","div"),br(he(this).div(he(t)))}mul(t){return br(he(this).mul(he(t)))}mod(t){const e=he(t);return e.isNeg()&&Hr("division-by-zero","mod"),br(he(this).umod(e))}pow(t){const e=he(t);return e.isNeg()&&Hr("negative-power","pow"),br(he(this).pow(e))}and(t){const e=he(t);return(this.isNegative()||e.isNeg())&&Hr("unbound-bitwise-result","and"),br(he(this).and(e))}or(t){const e=he(t);return(this.isNegative()||e.isNeg())&&Hr("unbound-bitwise-result","or"),br(he(this).or(e))}xor(t){const e=he(t);return(this.isNegative()||e.isNeg())&&Hr("unbound-bitwise-result","xor"),br(he(this).xor(e))}mask(t){return(this.isNegative()||t<0)&&Hr("negative-width","mask"),br(he(this).maskn(t))}shl(t){return(this.isNegative()||t<0)&&Hr("negative-width","shl"),br(he(this).shln(t))}shr(t){return(this.isNegative()||t<0)&&Hr("negative-width","shr"),br(he(this).shrn(t))}eq(t){return he(this).eq(he(t))}lt(t){return he(this).lt(he(t))}lte(t){return he(this).lte(he(t))}gt(t){return he(this).gt(he(t))}gte(t){return he(this).gte(he(t))}isNegative(){return this._hex[0]==="-"}isZero(){return he(this).isZero()}toNumber(){try{return he(this).toNumber()}catch{Hr("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch{}return Yi.throwError("this platform does not support BigInt",er.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(arguments[0]===10?Wd||(Wd=!0,Yi.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):arguments[0]===16?Yi.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",er.errors.UNEXPECTED_ARGUMENT,{}):Yi.throwError("BigNumber.toString does not accept parameters",er.errors.UNEXPECTED_ARGUMENT,{})),he(this).toString(10)}toHexString(){return this._hex}toJSON(t){return{type:"BigNumber",hex:this.toHexString()}}static from(t){if(t instanceof Oe)return t;if(typeof t=="string")return t.match(/^-?0x[0-9a-f]+$/i)?new Oe(Rh,bo(t)):t.match(/^-?[0-9]+$/)?new Oe(Rh,bo(new za(t))):Yi.throwArgumentError("invalid BigNumber string","value",t);if(typeof t=="number")return t%1&&Hr("underflow","BigNumber.from",t),(t>=y3||t<=-9007199254740991)&&Hr("overflow","BigNumber.from",t),Oe.from(String(t));const e=t;if(typeof e=="bigint")return Oe.from(e.toString());if(As(e))return Oe.from(Ar(e));if(e)if(e.toHexString){const n=e.toHexString();if(typeof n=="string")return Oe.from(n)}else{let n=e._hex;if(n==null&&e.type==="BigNumber"&&(n=e.hex),typeof n=="string"&&(Tr(n)||n[0]==="-"&&Tr(n.substring(1))))return Oe.from(n)}return Yi.throwArgumentError("invalid BigNumber value","value",t)}static isBigNumber(t){return!!(t&&t._isBigNumber)}}function bo(r){if(typeof r!="string")return bo(r.toString(16));if(r[0]==="-")return r=r.substring(1),r[0]==="-"&&Yi.throwArgumentError("invalid hex","value",r),r=bo(r),r==="0x00"?r:"-"+r;if(r.substring(0,2)!=="0x"&&(r="0x"+r),r==="0x")return"0x00";for(r.length%2&&(r="0x0"+r.substring(2));r.length>4&&r.substring(0,4)==="0x00";)r="0x"+r.substring(4);return r}function br(r){return Oe.from(bo(r))}function he(r){const t=Oe.from(r).toHexString();return t[0]==="-"?new za("-"+t.substring(3),16):new za(t.substring(2),16)}function Hr(r,t,e){const n={fault:r,operation:t};return e!=null&&(n.value=e),Yi.throwError(r,er.errors.NUMERIC_FAULT,n)}function b3(r){return new za(r,36).toString(16)}const fr=new er(B0),mo={},L0=Oe.from(0),k0=Oe.from(-1);function $0(r,t,e,n){const s={fault:t,operation:e};return n!==void 0&&(s.value=n),fr.throwError(r,er.errors.NUMERIC_FAULT,s)}let vo="0";for(;vo.length<256;)vo+=vo;function Mu(r){if(typeof r!="number")try{r=Oe.from(r).toNumber()}catch{}return typeof r=="number"&&r>=0&&r<=256&&!(r%1)?"1"+vo.substring(0,r):fr.throwArgumentError("invalid decimal size","decimals",r)}function Oh(r,t){t==null&&(t=0);const e=Mu(t);r=Oe.from(r);const n=r.lt(L0);n&&(r=r.mul(k0));let s=r.mod(e).toString();for(;s.length<e.length-1;)s="0"+s;s=s.match(/^([0-9]*[1-9]|0)(0*)/)[1];const a=r.div(e).toString();return e.length===1?r=a:r=a+"."+s,n&&(r="-"+r),r}function Gi(r,t){t==null&&(t=0);const e=Mu(t);(typeof r!="string"||!r.match(/^-?[0-9.]+$/))&&fr.throwArgumentError("invalid decimal value","value",r);const n=r.substring(0,1)==="-";n&&(r=r.substring(1)),r==="."&&fr.throwArgumentError("missing value","value",r);const s=r.split(".");s.length>2&&fr.throwArgumentError("too many decimal points","value",r);let a=s[0],h=s[1];for(a||(a="0"),h||(h="0");h[h.length-1]==="0";)h=h.substring(0,h.length-1);for(h.length>e.length-1&&$0("fractional component exceeds decimals","underflow","parseFixed"),h===""&&(h="0");h.length<e.length-1;)h+="0";const u=Oe.from(a),f=Oe.from(h);let y=u.mul(e).add(f);return n&&(y=y.mul(k0)),y}let Th=class iu{constructor(t,e,n,s){t!==mo&&fr.throwError("cannot use FixedFormat constructor; use FixedFormat.from",er.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.signed=e,this.width=n,this.decimals=s,this.name=(e?"":"u")+"fixed"+String(n)+"x"+String(s),this._multiplier=Mu(s),Object.freeze(this)}static from(t){if(t instanceof iu)return t;typeof t=="number"&&(t=`fixed128x${t}`);let e=!0,n=128,s=18;if(typeof t=="string"){if(t!=="fixed")if(t==="ufixed")e=!1;else{const a=t.match(/^(u?)fixed([0-9]+)x([0-9]+)$/);a||fr.throwArgumentError("invalid fixed format","format",t),e=a[1]!=="u",n=parseInt(a[2]),s=parseInt(a[3])}}else if(t){const a=(h,u,f)=>t[h]==null?f:(typeof t[h]!==u&&fr.throwArgumentError("invalid fixed format ("+h+" not "+u+")","format."+h,t[h]),t[h]);e=a("signed","boolean",e),n=a("width","number",n),s=a("decimals","number",s)}return n%8&&fr.throwArgumentError("invalid fixed format width (not byte aligned)","format.width",n),s>80&&fr.throwArgumentError("invalid fixed format (decimals too large)","format.decimals",s),new iu(mo,e,n,s)}},j0=class ur{constructor(t,e,n,s){t!==mo&&fr.throwError("cannot use FixedNumber constructor; use FixedNumber.from",er.errors.UNSUPPORTED_OPERATION,{operation:"new FixedFormat"}),this.format=s,this._hex=e,this._value=n,this._isFixedNumber=!0,Object.freeze(this)}_checkFormat(t){this.format.name!==t.format.name&&fr.throwArgumentError("incompatible format; use fixedNumber.toFormat","other",t)}addUnsafe(t){this._checkFormat(t);const e=Gi(this._value,this.format.decimals),n=Gi(t._value,t.format.decimals);return ur.fromValue(e.add(n),this.format.decimals,this.format)}subUnsafe(t){this._checkFormat(t);const e=Gi(this._value,this.format.decimals),n=Gi(t._value,t.format.decimals);return ur.fromValue(e.sub(n),this.format.decimals,this.format)}mulUnsafe(t){this._checkFormat(t);const e=Gi(this._value,this.format.decimals),n=Gi(t._value,t.format.decimals);return ur.fromValue(e.mul(n).div(this.format._multiplier),this.format.decimals,this.format)}divUnsafe(t){this._checkFormat(t);const e=Gi(this._value,this.format.decimals),n=Gi(t._value,t.format.decimals);return ur.fromValue(e.mul(this.format._multiplier).div(n),this.format.decimals,this.format)}floor(){const t=this.toString().split(".");t.length===1&&t.push("0");let e=ur.from(t[0],this.format);const n=!t[1].match(/^(0*)$/);return this.isNegative()&&n&&(e=e.subUnsafe(Xd.toFormat(e.format))),e}ceiling(){const t=this.toString().split(".");t.length===1&&t.push("0");let e=ur.from(t[0],this.format);const n=!t[1].match(/^(0*)$/);return!this.isNegative()&&n&&(e=e.addUnsafe(Xd.toFormat(e.format))),e}round(t){t==null&&(t=0);const e=this.toString().split(".");if(e.length===1&&e.push("0"),(t<0||t>80||t%1)&&fr.throwArgumentError("invalid decimal count","decimals",t),e[1].length<=t)return this;const n=ur.from("1"+vo.substring(0,t),this.format),s=_3.toFormat(this.format);return this.mulUnsafe(n).addUnsafe(s).floor().divUnsafe(n)}isZero(){return this._value==="0.0"||this._value==="0"}isNegative(){return this._value[0]==="-"}toString(){return this._value}toHexString(t){if(t==null)return this._hex;t%8&&fr.throwArgumentError("invalid byte width","width",t);const e=Oe.from(this._hex).fromTwos(this.format.width).toTwos(t).toHexString();return Ci(e,t/8)}toUnsafeFloat(){return parseFloat(this.toString())}toFormat(t){return ur.fromString(this._value,t)}static fromValue(t,e,n){return n==null&&e!=null&&!w3(e)&&(n=e,e=null),e==null&&(e=0),n==null&&(n="fixed"),ur.fromString(Oh(t,e),Th.from(n))}static fromString(t,e){e==null&&(e="fixed");const n=Th.from(e),s=Gi(t,n.decimals);!n.signed&&s.lt(L0)&&$0("unsigned value cannot be negative","overflow","value",t);let a=null;n.signed?a=s.toTwos(n.width).toHexString():(a=s.toHexString(),a=Ci(a,n.width/8));const h=Oh(s,n.decimals);return new ur(mo,a,h,n)}static fromBytes(t,e){e==null&&(e="fixed");const n=Th.from(e);if(Le(t).length>n.width/8)throw new Error("overflow");let s=Oe.from(t);n.signed&&(s=s.fromTwos(n.width));const a=s.toTwos((n.signed?0:1)+n.width).toHexString(),h=Oh(s,n.decimals);return new ur(mo,a,h,n)}static from(t,e){if(typeof t=="string")return ur.fromString(t,e);if(As(t))return ur.fromBytes(t,e);try{return ur.fromValue(t,0,e)}catch(n){if(n.code!==er.errors.INVALID_ARGUMENT)throw n}return fr.throwArgumentError("invalid FixedNumber value","value",t)}static isFixedNumber(t){return!!(t&&t._isFixedNumber)}};const Xd=j0.from(1),_3=j0.from("0.5"),A3="strings/5.7.0",E3=new er(A3);var Ha;(function(r){r.current="",r.NFC="NFC",r.NFD="NFD",r.NFKC="NFKC",r.NFKD="NFKD"})(Ha||(Ha={}));var Zd;(function(r){r.UNEXPECTED_CONTINUE="unexpected continuation byte",r.BAD_PREFIX="bad codepoint prefix",r.OVERRUN="string overrun",r.MISSING_CONTINUE="missing continuation byte",r.OUT_OF_RANGE="out of UTF-8 range",r.UTF16_SURROGATE="UTF-16 surrogate",r.OVERLONG="overlong representation"})(Zd||(Zd={}));function Fh(r,t=Ha.current){t!=Ha.current&&(E3.checkNormalize(),r=r.normalize(t));let e=[];for(let n=0;n<r.length;n++){const s=r.charCodeAt(n);if(s<128)e.push(s);else if(s<2048)e.push(s>>6|192),e.push(s&63|128);else if((s&64512)==55296){n++;const a=r.charCodeAt(n);if(n>=r.length||(a&64512)!==56320)throw new Error("invalid utf-8 string");const h=65536+((s&1023)<<10)+(a&1023);e.push(h>>18|240),e.push(h>>12&63|128),e.push(h>>6&63|128),e.push(h&63|128)}else e.push(s>>12|224),e.push(s>>6&63|128),e.push(s&63|128)}return Le(e)}function I3(r){if(r.length%4!==0)throw new Error("bad data");let t=[];for(let e=0;e<r.length;e+=4)t.push(parseInt(r.substring(e,e+4),16));return t}function Dh(r,t){t||(t=function(s){return[parseInt(s,16)]});let e=0,n={};return r.split(",").forEach(s=>{let a=s.split(":");e+=parseInt(a[0],16),n[e]=t(a[1])}),n}function tp(r){let t=0;return r.split(",").map(e=>{let n=e.split("-");n.length===1?n[1]="0":n[1]===""&&(n[1]="1");let s=t+parseInt(n[0],16);return t=parseInt(n[1],16),{l:s,h:t}})}tp("221,13-1b,5f-,40-10,51-f,11-3,3-3,2-2,2-4,8,2,15,2d,28-8,88,48,27-,3-5,11-20,27-,8,28,3-5,12,18,b-a,1c-4,6-16,2-d,2-2,2,1b-4,17-9,8f-,10,f,1f-2,1c-34,33-14e,4,36-,13-,6-2,1a-f,4,9-,3-,17,8,2-2,5-,2,8-,3-,4-8,2-3,3,6-,16-6,2-,7-3,3-,17,8,3,3,3-,2,6-3,3-,4-a,5,2-6,10-b,4,8,2,4,17,8,3,6-,b,4,4-,2-e,2-4,b-10,4,9-,3-,17,8,3-,5-,9-2,3-,4-7,3-3,3,4-3,c-10,3,7-2,4,5-2,3,2,3-2,3-2,4-2,9,4-3,6-2,4,5-8,2-e,d-d,4,9,4,18,b,6-3,8,4,5-6,3-8,3-3,b-11,3,9,4,18,b,6-3,8,4,5-6,3-6,2,3-3,b-11,3,9,4,18,11-3,7-,4,5-8,2-7,3-3,b-11,3,13-2,19,a,2-,8-2,2-3,7,2,9-11,4-b,3b-3,1e-24,3,2-,3,2-,2-5,5,8,4,2,2-,3,e,4-,6,2,7-,b-,3-21,49,23-5,1c-3,9,25,10-,2-2f,23,6,3,8-2,5-5,1b-45,27-9,2a-,2-3,5b-4,45-4,53-5,8,40,2,5-,8,2,5-,28,2,5-,20,2,5-,8,2,5-,8,8,18,20,2,5-,8,28,14-5,1d-22,56-b,277-8,1e-2,52-e,e,8-a,18-8,15-b,e,4,3-b,5e-2,b-15,10,b-5,59-7,2b-555,9d-3,5b-5,17-,7-,27-,7-,9,2,2,2,20-,36,10,f-,7,14-,4,a,54-3,2-6,6-5,9-,1c-10,13-1d,1c-14,3c-,10-6,32-b,240-30,28-18,c-14,a0,115-,3,66-,b-76,5,5-,1d,24,2,5-2,2,8-,35-2,19,f-10,1d-3,311-37f,1b,5a-b,d7-19,d-3,41,57-,68-4,29-3,5f,29-37,2e-2,25-c,2c-2,4e-3,30,78-3,64-,20,19b7-49,51a7-59,48e-2,38-738,2ba5-5b,222f-,3c-94,8-b,6-4,1b,6,2,3,3,6d-20,16e-f,41-,37-7,2e-2,11-f,5-b,18-,b,14,5-3,6,88-,2,bf-2,7-,7-,7-,4-2,8,8-9,8-2ff,20,5-b,1c-b4,27-,27-cbb1,f7-9,28-2,b5-221,56,48,3-,2-,3-,5,d,2,5,3,42,5-,9,8,1d,5,6,2-2,8,153-3,123-3,33-27fd,a6da-5128,21f-5df,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3-fffd,3,2-1d,61-ff7d"),"ad,34f,1806,180b,180c,180d,200b,200c,200d,2060,feff".split(",").map(r=>parseInt(r,16)),Dh("b5:3bc,c3:ff,7:73,2:253,5:254,3:256,1:257,5:259,1:25b,3:260,1:263,2:269,1:268,5:26f,1:272,2:275,7:280,3:283,5:288,3:28a,1:28b,5:292,3f:195,1:1bf,29:19e,125:3b9,8b:3b2,1:3b8,1:3c5,3:3c6,1:3c0,1a:3ba,1:3c1,1:3c3,2:3b8,1:3b5,1bc9:3b9,1c:1f76,1:1f77,f:1f7a,1:1f7b,d:1f78,1:1f79,1:1f7c,1:1f7d,107:63,5:25b,4:68,1:68,1:68,3:69,1:69,1:6c,3:6e,4:70,1:71,1:72,1:72,1:72,7:7a,2:3c9,2:7a,2:6b,1:e5,1:62,1:63,3:65,1:66,2:6d,b:3b3,1:3c0,6:64,1b574:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3,20:3b8,1a:3c3"),Dh("179:1,2:1,2:1,5:1,2:1,a:4f,a:1,8:1,2:1,2:1,3:1,5:1,3:1,4:1,2:1,3:1,4:1,8:2,1:1,2:2,1:1,2:2,27:2,195:26,2:25,1:25,1:25,2:40,2:3f,1:3f,33:1,11:-6,1:-9,1ac7:-3a,6d:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,b:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,c:-8,2:-8,2:-8,2:-8,9:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,1:-8,49:-8,1:-8,1:-4a,1:-4a,d:-56,1:-56,1:-56,1:-56,d:-8,1:-8,f:-8,1:-8,3:-7"),Dh("df:00730073,51:00690307,19:02BC006E,a7:006A030C,18a:002003B9,16:03B903080301,20:03C503080301,1d7:05650582,190f:00680331,1:00740308,1:0077030A,1:0079030A,1:006102BE,b6:03C50313,2:03C503130300,2:03C503130301,2:03C503130342,2a:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F0003B9,1:1F0103B9,1:1F0203B9,1:1F0303B9,1:1F0403B9,1:1F0503B9,1:1F0603B9,1:1F0703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F2003B9,1:1F2103B9,1:1F2203B9,1:1F2303B9,1:1F2403B9,1:1F2503B9,1:1F2603B9,1:1F2703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,1:1F6003B9,1:1F6103B9,1:1F6203B9,1:1F6303B9,1:1F6403B9,1:1F6503B9,1:1F6603B9,1:1F6703B9,3:1F7003B9,1:03B103B9,1:03AC03B9,2:03B10342,1:03B1034203B9,5:03B103B9,6:1F7403B9,1:03B703B9,1:03AE03B9,2:03B70342,1:03B7034203B9,5:03B703B9,6:03B903080300,1:03B903080301,3:03B90342,1:03B903080342,b:03C503080300,1:03C503080301,1:03C10313,2:03C50342,1:03C503080342,b:1F7C03B9,1:03C903B9,1:03CE03B9,2:03C90342,1:03C9034203B9,5:03C903B9,ac:00720073,5b:00B00063,6:00B00066,d:006E006F,a:0073006D,1:00740065006C,1:0074006D,124f:006800700061,2:00610075,2:006F0076,b:00700061,1:006E0061,1:03BC0061,1:006D0061,1:006B0061,1:006B0062,1:006D0062,1:00670062,3:00700066,1:006E0066,1:03BC0066,4:0068007A,1:006B0068007A,1:006D0068007A,1:00670068007A,1:00740068007A,15:00700061,1:006B00700061,1:006D00700061,1:006700700061,8:00700076,1:006E0076,1:03BC0076,1:006D0076,1:006B0076,1:006D0076,1:00700077,1:006E0077,1:03BC0077,1:006D0077,1:006B0077,1:006D0077,1:006B03C9,1:006D03C9,2:00620071,3:00632215006B0067,1:0063006F002E,1:00640062,1:00670079,2:00680070,2:006B006B,1:006B006D,9:00700068,2:00700070006D,1:00700072,2:00730076,1:00770062,c723:00660066,1:00660069,1:0066006C,1:006600660069,1:00660066006C,1:00730074,1:00730074,d:05740576,1:05740565,1:0574056B,1:057E0576,1:0574056D",I3),tp("80-20,2a0-,39c,32,f71,18e,7f2-f,19-7,30-4,7-5,f81-b,5,a800-20ff,4d1-1f,110,fa-6,d174-7,2e84-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,ffff-,2,1f-5f,ff7f-20001");function S3(r){r=atob(r);const t=[];for(let e=0;e<r.length;e++)t.push(r.charCodeAt(e));return Le(t)}function z0(r,t){t==null&&(t=1);const e=[],n=e.forEach,s=function(a,h){n.call(a,function(u){h>0&&Array.isArray(u)?s(u,h-1):e.push(u)})};return s(r,t),e}function x3(r){const t={};for(let e=0;e<r.length;e++){const n=r[e];t[n[0]]=n[1]}return t}function M3(r){let t=0;function e(){return r[t++]<<8|r[t++]}let n=e(),s=1,a=[0,1];for(let k=1;k<n;k++)a.push(s+=e());let h=e(),u=t;t+=h;let f=0,y=0;function A(){return f==0&&(y=y<<8|r[t++],f=8),y>>--f&1}const x=31,T=Math.pow(2,x),R=T>>>1,$=R>>1,Q=T-1;let V=0;for(let k=0;k<x;k++)V=V<<1|A();let Z=[],H=0,J=T;for(;;){let k=Math.floor(((V-H+1)*s-1)/J),z=0,w=n;for(;w-z>1;){let ut=z+w>>>1;k<a[ut]?w=ut:z=ut}if(z==0)break;Z.push(z);let q=H+Math.floor(J*a[z]/s),ht=H+Math.floor(J*a[z+1]/s)-1;for(;!((q^ht)&R);)V=V<<1&Q|A(),q=q<<1&Q,ht=ht<<1&Q|1;for(;q&~ht&$;)V=V&R|V<<1&Q>>>1|A(),q=q<<1^R,ht=(ht^R)<<1|R|1;H=q,J=1+ht-q}let B=n-4;return Z.map(k=>{switch(k-B){case 3:return B+65792+(r[u++]<<16|r[u++]<<8|r[u++]);case 2:return B+256+(r[u++]<<8|r[u++]);case 1:return B+r[u++];default:return k-1}})}function P3(r){let t=0;return()=>r[t++]}function C3(r){return P3(M3(r))}function N3(r){return r&1?~r>>1:r>>1}function R3(r,t){let e=Array(r);for(let n=0;n<r;n++)e[n]=1+t();return e}function ep(r,t){let e=Array(r);for(let n=0,s=-1;n<r;n++)e[n]=s+=1+t();return e}function O3(r,t){let e=Array(r);for(let n=0,s=0;n<r;n++)e[n]=s+=N3(t());return e}function Ka(r,t){let e=ep(r(),r),n=r(),s=ep(n,r),a=R3(n,r);for(let h=0;h<n;h++)for(let u=0;u<a[h];u++)e.push(s[h]+u);return t?e.map(h=>t[h]):e}function T3(r){let t=[];for(;;){let e=r();if(e==0)break;t.push(D3(e,r))}for(;;){let e=r()-1;if(e<0)break;t.push(q3(e,r))}return x3(z0(t))}function F3(r){let t=[];for(;;){let e=r();if(e==0)break;t.push(e)}return t}function H0(r,t,e){let n=Array(r).fill(void 0).map(()=>[]);for(let s=0;s<t;s++)O3(r,e).forEach((a,h)=>n[h].push(a));return n}function D3(r,t){let e=1+t(),n=t(),s=F3(t),a=H0(s.length,1+r,t);return z0(a.map((h,u)=>{const f=h[0],y=h.slice(1);return Array(s[u]).fill(void 0).map((A,x)=>{let T=x*n;return[f+x*e,y.map(R=>R+T)]})}))}function q3(r,t){let e=1+t();return H0(e,1+r,t).map(n=>[n[0],n.slice(1)])}function U3(r){let t=Ka(r).sort((n,s)=>n-s);return e();function e(){let n=[];for(;;){let y=Ka(r,t);if(y.length==0)break;n.push({set:new Set(y),node:e()})}n.sort((y,A)=>A.set.size-y.set.size);let s=r(),a=s%3;s=s/3|0;let h=!!(s&1);s>>=1;let u=s==1,f=s==2;return{branches:n,valid:a,fe0f:h,save:u,check:f}}}function B3(){return C3(S3("AEQF2AO2DEsA2wIrAGsBRABxAN8AZwCcAEwAqgA0AGwAUgByADcATAAVAFYAIQAyACEAKAAYAFgAGwAjABQAMAAmADIAFAAfABQAKwATACoADgAbAA8AHQAYABoAGQAxADgALAAoADwAEwA9ABMAGgARAA4ADwAWABMAFgAIAA8AHgQXBYMA5BHJAS8JtAYoAe4AExozi0UAH21tAaMnBT8CrnIyhrMDhRgDygIBUAEHcoFHUPe8AXBjAewCjgDQR8IICIcEcQLwATXCDgzvHwBmBoHNAqsBdBcUAykgDhAMShskMgo8AY8jqAQfAUAfHw8BDw87MioGlCIPBwZCa4ELatMAAMspJVgsDl8AIhckSg8XAHdvTwBcIQEiDT4OPhUqbyECAEoAS34Aej8Ybx83JgT/Xw8gHxZ/7w8RICxPHA9vBw+Pfw8PHwAPFv+fAsAvCc8vEr8ivwD/EQ8Bol8OEBa/A78hrwAPCU8vESNvvwWfHwNfAVoDHr+ZAAED34YaAdJPAK7PLwSEgDLHAGo1Pz8Pvx9fUwMrpb8O/58VTzAPIBoXIyQJNF8hpwIVAT8YGAUADDNBaX3RAMomJCg9EhUeA29MABsZBTMNJipjOhc19gcIDR8bBwQHEggCWi6DIgLuAQYA+BAFCha3A5XiAEsqM7UFFgFLhAMjFTMYE1Klnw74nRVBG/ASCm0BYRN/BrsU3VoWy+S0vV8LQx+vN8gF2AC2AK5EAWwApgYDKmAAroQ0NDQ0AT+OCg7wAAIHRAbpNgVcBV0APTA5BfbPFgMLzcYL/QqqA82eBALKCjQCjqYCht0/k2+OAsXQAoP3ASTKDgDw6ACKAUYCMpIKJpRaAE4A5womABzZvs0REEKiACIQAd5QdAECAj4Ywg/wGqY2AVgAYADYvAoCGAEubA0gvAY2ALAAbpbvqpyEAGAEpgQAJgAG7gAgAEACmghUFwCqAMpAINQIwC4DthRAAPcycKgApoIdABwBfCisABoATwBqASIAvhnSBP8aH/ECeAKXAq40NjgDBTwFYQU6AXs3oABgAD4XNgmcCY1eCl5tIFZeUqGgyoNHABgAEQAaABNwWQAmABMATPMa3T34ADldyprmM1M2XociUQgLzvwAXT3xABgAEQAaABNwIGFAnADD8AAgAD4BBJWzaCcIAIEBFMAWwKoAAdq9BWAF5wLQpALEtQAKUSGkahR4GnJM+gsAwCgeFAiUAECQ0BQuL8AAIAAAADKeIheclvFqQAAETr4iAMxIARMgAMIoHhQIAn0E0pDQFC4HhznoAAAAIAI2C0/4lvFqQAAETgBJJwYCAy4ABgYAFAA8MBKYEH4eRhTkAjYeFcgACAYAeABsOqyQ5gRwDayqugEgaIIAtgoACgDmEABmBAWGme5OBJJA2m4cDeoAmITWAXwrMgOgAGwBCh6CBXYF1Tzg1wKAAFdiuABRAFwAXQBsAG8AdgBrAHYAbwCEAHEwfxQBVE5TEQADVFhTBwBDANILAqcCzgLTApQCrQL6vAAMAL8APLhNBKkE6glGKTAU4Dr4N2EYEwBCkABKk8rHAbYBmwIoAiU4Ajf/Aq4CowCAANIChzgaNBsCsTgeODcFXrgClQKdAqQBiQGYAqsCsjTsNHsfNPA0ixsAWTWiOAMFPDQSNCk2BDZHNow2TTZUNhk28Jk9VzI3QkEoAoICoQKwAqcAQAAxBV4FXbS9BW47YkIXP1ciUqs05DS/FwABUwJW11e6nHuYZmSh/RAYA8oMKvZ8KASoUAJYWAJ6ILAsAZSoqjpgA0ocBIhmDgDWAAawRDQoAAcuAj5iAHABZiR2AIgiHgCaAU68ACxuHAG0ygM8MiZIAlgBdF4GagJqAPZOHAMuBgoATkYAsABiAHgAMLoGDPj0HpKEBAAOJgAuALggTAHWAeAMEDbd20Uege0ADwAWADkAQgA9OHd+2MUQZBBhBgNNDkxxPxUQArEPqwvqERoM1irQ090ANK4H8ANYB/ADWANYB/AH8ANYB/ADWANYA1gDWBwP8B/YxRBkD00EcgWTBZAE2wiIJk4RhgctCNdUEnQjHEwDSgEBIypJITuYMxAlR0wRTQgIATZHbKx9PQNMMbBU+pCnA9AyVDlxBgMedhKlAC8PeCE1uk6DekxxpQpQT7NX9wBFBgASqwAS5gBJDSgAUCwGPQBI4zTYABNGAE2bAE3KAExdGABKaAbgAFBXAFCOAFBJABI2SWdObALDOq0//QomCZhvwHdTBkIQHCemEPgMNAG2ATwN7kvZBPIGPATKH34ZGg/OlZ0Ipi3eDO4m5C6igFsj9iqEBe5L9TzeC05RaQ9aC2YJ5DpkgU8DIgEOIowK3g06CG4Q9ArKbA3mEUYHOgPWSZsApgcCCxIdNhW2JhFirQsKOXgG/Br3C5AmsBMqev0F1BoiBk4BKhsAANAu6IWxWjJcHU9gBgQLJiPIFKlQIQ0mQLh4SRocBxYlqgKSQ3FKiFE3HpQh9zw+DWcuFFF9B/Y8BhlQC4I8n0asRQ8R0z6OPUkiSkwtBDaALDAnjAnQD4YMunxzAVoJIgmyDHITMhEYN8YIOgcaLpclJxYIIkaWYJsE+KAD9BPSAwwFQAlCBxQDthwuEy8VKgUOgSXYAvQ21i60ApBWgQEYBcwPJh/gEFFH4Q7qCJwCZgOEJewALhUiABginAhEZABgj9lTBi7MCMhqbSN1A2gU6GIRdAeSDlgHqBw0FcAc4nDJXgyGCSiksAlcAXYJmgFgBOQICjVcjKEgQmdUi1kYnCBiQUBd/QIyDGYVoES+h3kCjA9sEhwBNgF0BzoNAgJ4Ee4RbBCWCOyGBTW2M/k6JgRQIYQgEgooA1BszwsoJvoM+WoBpBJjAw00PnfvZ6xgtyUX/gcaMsZBYSHyC5NPzgydGsIYQ1QvGeUHwAP0GvQn60FYBgADpAQUOk4z7wS+C2oIjAlAAEoOpBgH2BhrCnKM0QEyjAG4mgNYkoQCcJAGOAcMAGgMiAV65gAeAqgIpAAGANADWAA6Aq4HngAaAIZCAT4DKDABIuYCkAOUCDLMAZYwAfQqBBzEDBYA+DhuSwLDsgKAa2ajBd5ZAo8CSjYBTiYEBk9IUgOwcuIA3ABMBhTgSAEWrEvMG+REAeBwLADIAPwABjYHBkIBzgH0bgC4AWALMgmjtLYBTuoqAIQAFmwB2AKKAN4ANgCA8gFUAE4FWvoF1AJQSgESMhksWGIBvAMgATQBDgB6BsyOpsoIIARuB9QCEBwV4gLvLwe2AgMi4BPOQsYCvd9WADIXUu5eZwqoCqdeaAC0YTQHMnM9UQAPH6k+yAdy/BZIiQImSwBQ5gBQQzSaNTFWSTYBpwGqKQK38AFtqwBI/wK37gK3rQK3sAK6280C0gK33AK3zxAAUEIAUD9SklKDArekArw5AEQAzAHCO147WTteO1k7XjtZO147WTteO1kDmChYI03AVU0oJqkKbV9GYewMpw3VRMk6ShPcYFJgMxPJLbgUwhXPJVcZPhq9JwYl5VUKDwUt1GYxCC00dhe9AEApaYNCY4ceMQpMHOhTklT5LRwAskujM7ANrRsWREEFSHXuYisWDwojAmSCAmJDXE6wXDchAqH4AmiZAmYKAp+FOBwMAmY8AmYnBG8EgAN/FAN+kzkHOXgYOYM6JCQCbB4CMjc4CwJtyAJtr/CLADRoRiwBaADfAOIASwYHmQyOAP8MwwAOtgJ3MAJ2o0ACeUxEAni7Hl3cRa9G9AJ8QAJ6yQJ9CgJ88UgBSH5kJQAsFklZSlwWGErNAtECAtDNSygDiFADh+dExpEzAvKiXQQDA69Lz0wuJgTQTU1NsAKLQAKK2cIcCB5EaAa4Ao44Ao5dQZiCAo7aAo5deVG1UzYLUtVUhgKT/AKTDQDqAB1VH1WwVdEHLBwplocy4nhnRTw6ApegAu+zWCKpAFomApaQApZ9nQCqWa1aCoJOADwClrYClk9cRVzSApnMApllXMtdCBoCnJw5wzqeApwXAp+cAp65iwAeEDIrEAKd8gKekwC2PmE1YfACntQCoG8BqgKeoCACnk+mY8lkKCYsAiewAiZ/AqD8AqBN2AKmMAKlzwKoAAB+AqfzaH1osgAESmodatICrOQCrK8CrWgCrQMCVx4CVd0CseLYAx9PbJgCsr4OArLpGGzhbWRtSWADJc4Ctl08QG6RAylGArhfArlIFgK5K3hwN3DiAr0aAy2zAzISAr6JcgMDM3ICvhtzI3NQAsPMAsMFc4N0TDZGdOEDPKgDPJsDPcACxX0CxkgCxhGKAshqUgLIRQLJUALJLwJkngLd03h6YniveSZL0QMYpGcDAmH1GfSVJXsMXpNevBICz2wCz20wTFTT9BSgAMeuAs90ASrrA04TfkwGAtwoAtuLAtJQA1JdA1NgAQIDVY2AikABzBfuYUZ2AILPg44C2sgC2d+EEYRKpz0DhqYAMANkD4ZyWvoAVgLfZgLeuXR4AuIw7RUB8zEoAfScAfLTiALr9ALpcXoAAur6AurlAPpIAboC7ooC652Wq5cEAu5AA4XhmHpw4XGiAvMEAGoDjheZlAL3FAORbwOSiAL3mQL52gL4Z5odmqy8OJsfA52EAv77ARwAOp8dn7QDBY4DpmsDptoA0sYDBmuhiaIGCgMMSgFgASACtgNGAJwEgLpoBgC8BGzAEowcggCEDC6kdjoAJAM0C5IKRoABZCgiAIzw3AYBLACkfng9ogigkgNmWAN6AEQCvrkEVqTGAwCsBRbAA+4iQkMCHR072jI2PTbUNsk2RjY5NvA23TZKNiU3EDcZN5I+RTxDRTBCJkK5VBYKFhZfwQCWygU3AJBRHpu+OytgNxa61A40GMsYjsn7BVwFXQVcBV0FaAVdBVwFXQVcBV0FXAVdBVwFXUsaCNyKAK4AAQUHBwKU7oICoW1e7jAEzgPxA+YDwgCkBFDAwADABKzAAOxFLhitA1UFTDeyPkM+bj51QkRCuwTQWWQ8X+0AWBYzsACNA8xwzAGm7EZ/QisoCTAbLDs6fnLfb8H2GccsbgFw13M1HAVkBW/Jxsm9CNRO8E8FDD0FBQw9FkcClOYCoMFegpDfADgcMiA2AJQACB8AsigKAIzIEAJKeBIApY5yPZQIAKQiHb4fvj5BKSRPQrZCOz0oXyxgOywfKAnGbgMClQaCAkILXgdeCD9IIGUgQj5fPoY+dT52Ao5CM0dAX9BTVG9SDzFwWTQAbxBzJF/lOEIQQglCCkKJIAls5AcClQICoKPMODEFxhi6KSAbiyfIRrMjtCgdWCAkPlFBIitCsEJRzAbMAV/OEyQzDg0OAQQEJ36i328/Mk9AybDJsQlq3tDRApUKAkFzXf1d/j9uALYP6hCoFgCTGD8kPsFKQiobrm0+zj0KSD8kPnVCRBwMDyJRTHFgMTJa5rwXQiQ2YfI/JD7BMEJEHGINTw4TOFlIRzwJO0icMQpyPyQ+wzJCRBv6DVgnKB01NgUKj2bwYzMqCoBkznBgEF+zYDIocwRIX+NgHj4HICNfh2C4CwdwFWpTG/lgUhYGAwRfv2Ts8mAaXzVgml/XYIJfuWC4HI1gUF9pYJZgMR6ilQHMAOwLAlDRefC0in4AXAEJA6PjCwc0IamOANMMCAECRQDFNRTZBgd+CwQlRA+r6+gLBDEFBnwUBXgKATIArwAGRAAHA3cDdAN2A3kDdwN9A3oDdQN7A30DfAN4A3oDfQAYEAAlAtYASwMAUAFsAHcKAHcAmgB3AHUAdQB2AHVu8UgAygDAAHcAdQB1AHYAdQALCgB3AAsAmgB3AAsCOwB3AAtu8UgAygDAAHgKAJoAdwB3AHUAdQB2AHUAeAB1AHUAdgB1bvFIAMoAwAALCgCaAHcACwB3AAsCOwB3AAtu8UgAygDAAH4ACwGgALcBpwC6AahdAu0COwLtbvFIAMoAwAALCgCaAu0ACwLtAAsCOwLtAAtu8UgAygDAA24ACwNvAAu0VsQAAzsAABCkjUIpAAsAUIusOggWcgMeBxVsGwL67U/2HlzmWOEeOgALASvuAAseAfpKUpnpGgYJDCIZM6YyARUE9ThqAD5iXQgnAJYJPnOzw0ZAEZxEKsIAkA4DhAHnTAIDxxUDK0lxCQlPYgIvIQVYJQBVqE1GakUAKGYiDToSBA1EtAYAXQJYAIF8GgMHRyAAIAjOe9YncekRAA0KACUrjwE7Ayc6AAYWAqaiKG4McEcqANoN3+Mg9TwCBhIkuCny+JwUQ29L008JluRxu3K+oAdqiHOqFH0AG5SUIfUJ5SxCGfxdipRzqTmT4V5Zb+r1Uo4Vm+NqSSEl2mNvR2JhIa8SpYO6ntdwFXHCWTCK8f2+Hxo7uiG3drDycAuKIMP5bhi06ACnqArH1rz4Rqg//lm6SgJGEVbF9xJHISaR6HxqxSnkw6shDnelHKNEfGUXSJRJ1GcsmtJw25xrZMDK9gXSm1/YMkdX4/6NKYOdtk/NQ3/NnDASjTc3fPjIjW/5sVfVObX2oTDWkr1dF9f3kxBsD3/3aQO8hPfRz+e0uEiJqt1161griu7gz8hDDwtpy+F+BWtefnKHZPAxcZoWbnznhJpy0e842j36bcNzGnIEusgGX0a8ZxsnjcSsPDZ09yZ36fCQbriHeQ72JRMILNl6ePPf2HWoVwgWAm1fb3V2sAY0+B6rAXqSwPBgseVmoqsBTSrm91+XasMYYySI8eeRxH3ZvHkMz3BQ5aJ3iUVbYPNM3/7emRtjlsMgv/9VyTsyt/mK+8fgWeT6SoFaclXqn42dAIsvAarF5vNNWHzKSkKQ/8Hfk5ZWK7r9yliOsooyBjRhfkHP4Q2DkWXQi6FG/9r/IwbmkV5T7JSopHKn1pJwm9tb5Ot0oyN1Z2mPpKXHTxx2nlK08fKk1hEYA8WgVVWL5lgx0iTv+KdojJeU23ZDjmiubXOxVXJKKi2Wjuh2HLZOFLiSC7Tls5SMh4f+Pj6xUSrNjFqLGehRNB8lC0QSLNmkJJx/wSG3MnjE9T1CkPwJI0wH2lfzwETIiVqUxg0dfu5q39Gt+hwdcxkhhNvQ4TyrBceof3Mhs/IxFci1HmHr4FMZgXEEczPiGCx0HRwzAqDq2j9AVm1kwN0mRVLWLylgtoPNapF5cY4Y1wJh/e0BBwZj44YgZrDNqvD/9Hv7GFYdUQeDJuQ3EWI4HaKqavU1XjC/n41kT4L79kqGq0kLhdTZvgP3TA3fS0ozVz+5piZsoOtIvBUFoMKbNcmBL6YxxaUAusHB38XrS8dQMnQwJfUUkpRoGr5AUeWicvBTzyK9g77+yCkf5PAysL7r/JjcZgrbvRpMW9iyaxZvKO6ceZN2EwIxKwVFPuvFuiEPGCoagbMo+SpydLrXqBzNCDGFCrO/rkcwa2xhokQZ5CdZ0AsU3JfSqJ6n5I14YA+P/uAgfhPU84Tlw7cEFfp7AEE8ey4sP12PTt4Cods1GRgDOB5xvyiR5m+Bx8O5nBCNctU8BevfV5A08x6RHd5jcwPTMDSZJOedIZ1cGQ704lxbAzqZOP05ZxaOghzSdvFBHYqomATARyAADK4elP8Ly3IrUZKfWh23Xy20uBUmLS4Pfagu9+oyVa2iPgqRP3F2CTUsvJ7+RYnN8fFZbU/HVvxvcFFDKkiTqV5UBZ3Gz54JAKByi9hkKMZJvuGgcSYXFmw08UyoQyVdfTD1/dMkCHXcTGAKeROgArsvmRrQTLUOXioOHGK2QkjHuoYFgXciZoTJd6Fs5q1QX1G+p/e26hYsEf7QZD1nnIyl/SFkNtYYmmBhpBrxl9WbY0YpHWRuw2Ll/tj9mD8P4snVzJl4F9J+1arVeTb9E5r2ILH04qStjxQNwn3m4YNqxmaNbLAqW2TN6LidwuJRqS+NXbtqxoeDXpxeGWmxzSkWxjkyCkX4NQRme6q5SAcC+M7+9ETfA/EwrzQajKakCwYyeunP6ZFlxU2oMEn1Pz31zeStW74G406ZJFCl1wAXIoUKkWotYEpOuXB1uVNxJ63dpJEqfxBeptwIHNrPz8BllZoIcBoXwgfJ+8VAUnVPvRvexnw0Ma/WiGYuJO5y8QTvEYBigFmhUxY5RqzE8OcywN/8m4UYrlaniJO75XQ6KSo9+tWHlu+hMi0UVdiKQp7NelnoZUzNaIyBPVeOwK6GNp+FfHuPOoyhaWuNvTYFkvxscMQWDh+zeFCFkgwbXftiV23ywJ4+uwRqmg9k3KzwIQpzppt8DBBOMbrqwQM5Gb05sEwdKzMiAqOloaA/lr0KA+1pr0/+HiWoiIjHA/wir2nIuS3PeU/ji3O6ZwoxcR1SZ9FhtLC5S0FIzFhbBWcGVP/KpxOPSiUoAdWUpqKH++6Scz507iCcxYI6rdMBICPJZea7OcmeFw5mObJSiqpjg2UoWNIs+cFhyDSt6geV5qgi3FunmwwDoGSMgerFOZGX1m0dMCYo5XOruxO063dwENK9DbnVM9wYFREzh4vyU1WYYJ/LRRp6oxgjqP/X5a8/4Af6p6NWkQferzBmXme0zY/4nwMJm/wd1tIqSwGz+E3xPEAOoZlJit3XddD7/BT1pllzOx+8bmQtANQ/S6fZexc6qi3W+Q2xcmXTUhuS5mpHQRvcxZUN0S5+PL9lXWUAaRZhEH8hTdAcuNMMCuVNKTEGtSUKNi3O6KhSaTzck8csZ2vWRZ+d7mW8c4IKwXIYd25S/zIftPkwPzufjEvOHWVD1m+FjpDVUTV0DGDuHj6QnaEwLu/dEgdLQOg9E1Sro9XHJ8ykLAwtPu+pxqKDuFexqON1sKQm7rwbE1E68UCfA/erovrTCG+DBSNg0l4goDQvZN6uNlbyLpcZAwj2UclycvLpIZMgv4yRlpb3YuMftozorbcGVHt/VeDV3+Fdf1TP0iuaCsPi2G4XeGhsyF1ubVDxkoJhmniQ0/jSg/eYML9KLfnCFgISWkp91eauR3IQvED0nAPXK+6hPCYs+n3+hCZbiskmVMG2da+0EsZPonUeIY8EbfusQXjsK/eFDaosbPjEfQS0RKG7yj5GG69M7MeO1HmiUYocgygJHL6M1qzUDDwUSmr99V7Sdr2F3JjQAJY+F0yH33Iv3+C9M38eML7gTgmNu/r2bUMiPvpYbZ6v1/IaESirBHNa7mPKn4dEmYg7v/+HQgPN1G79jBQ1+soydfDC2r+h2Bl/KIc5KjMK7OH6nb1jLsNf0EHVe2KBiE51ox636uyG6Lho0t3J34L5QY/ilE3mikaF4HKXG1mG1rCevT1Vv6GavltxoQe/bMrpZvRggnBxSEPEeEzkEdOxTnPXHVjUYdw8JYvjB/o7Eegc3Ma+NUxLLnsK0kJlinPmUHzHGtrk5+CAbVzFOBqpyy3QVUnzTDfC/0XD94/okH+OB+i7g9lolhWIjSnfIb+Eq43ZXOWmwvjyV/qqD+t0e+7mTEM74qP/Ozt8nmC7mRpyu63OB4KnUzFc074SqoyPUAgM+/TJGFo6T44EHnQU4X4z6qannVqgw/U7zCpwcmXV1AubIrvOmkKHazJAR55ePjp5tLBsN8vAqs3NAHdcEHOR2xQ0lsNAFzSUuxFQCFYvXLZJdOj9p4fNq6p0HBGUik2YzaI4xySy91KzhQ0+q1hjxvImRwPRf76tChlRkhRCi74NXZ9qUNeIwP+s5p+3m5nwPdNOHgSLD79n7O9m1n1uDHiMntq4nkYwV5OZ1ENbXxFd4PgrlvavZsyUO4MqYlqqn1O8W/I1dEZq5dXhrbETLaZIbC2Kj/Aa/QM+fqUOHdf0tXAQ1huZ3cmWECWSXy/43j35+Mvq9xws7JKseriZ1pEWKc8qlzNrGPUGcVgOa9cPJYIJsGnJTAUsEcDOEVULO5x0rXBijc1lgXEzQQKhROf8zIV82w8eswc78YX11KYLWQRcgHNJElBxfXr72lS2RBSl07qTKorO2uUDZr3sFhYsvnhLZn0A94KRzJ/7DEGIAhW5ZWFpL8gEwu1aLA9MuWZzNwl8Oze9Y+bX+v9gywRVnoB5I/8kXTXU3141yRLYrIOOz6SOnyHNy4SieqzkBXharjfjqq1q6tklaEbA8Qfm2DaIPs7OTq/nvJBjKfO2H9bH2cCMh1+5gspfycu8f/cuuRmtDjyqZ7uCIMyjdV3a+p3fqmXsRx4C8lujezIFHnQiVTXLXuI1XrwN3+siYYj2HHTvESUx8DlOTXpak9qFRK+L3mgJ1WsD7F4cu1aJoFoYQnu+wGDMOjJM3kiBQWHCcvhJ/HRdxodOQp45YZaOTA22Nb4XKCVxqkbwMYFhzYQYIAnCW8FW14uf98jhUG2zrKhQQ0q0CEq0t5nXyvUyvR8DvD69LU+g3i+HFWQMQ8PqZuHD+sNKAV0+M6EJC0szq7rEr7B5bQ8BcNHzvDMc9eqB5ZCQdTf80Obn4uzjwpYU7SISdtV0QGa9D3Wrh2BDQtpBKxaNFV+/Cy2P/Sv+8s7Ud0Fd74X4+o/TNztWgETUapy+majNQ68Lq3ee0ZO48VEbTZYiH1Co4OlfWef82RWeyUXo7woM03PyapGfikTnQinoNq5z5veLpeMV3HCAMTaZmA1oGLAn7XS3XYsz+XK7VMQsc4XKrmDXOLU/pSXVNUq8dIqTba///3x6LiLS6xs1xuCAYSfcQ3+rQgmu7uvf3THKt5Ooo97TqcbRqxx7EASizaQCBQllG/rYxVapMLgtLbZS64w1MDBMXX+PQpBKNwqUKOf2DDRDUXQf9EhOS0Qj4nTmlA8dzSLz/G1d+Ud8MTy/6ghhdiLpeerGY/UlDOfiuqFsMUU5/UYlP+BAmgRLuNpvrUaLlVkrqDievNVEAwF+4CoM1MZTmjxjJMsKJq+u8Zd7tNCUFy6LiyYXRJQ4VyvEQFFaCGKsxIwQkk7EzZ6LTJq2hUuPhvAW+gQnSG6J+MszC+7QCRHcnqDdyNRJ6T9xyS87A6MDutbzKGvGktpbXqtzWtXb9HsfK2cBMomjN9a4y+TaJLnXxAeX/HWzmf4cR4vALt/P4w4qgKY04ml4ZdLOinFYS6cup3G/1ie4+t1eOnpBNlqGqs75ilzkT4+DsZQxNvaSKJ//6zIbbk/M7LOhFmRc/1R+kBtz7JFGdZm/COotIdvQoXpTqP/1uqEUmCb/QWoGLMwO5ANcHzxdY48IGP5+J+zKOTBFZ4Pid+GTM+Wq12MV/H86xEJptBa6T+p3kgpwLedManBHC2GgNrFpoN2xnrMz9WFWX/8/ygSBkavq2Uv7FdCsLEYLu9LLIvAU0bNRDtzYl+/vXmjpIvuJFYjmI0im6QEYqnIeMsNjXG4vIutIGHijeAG/9EDBozKV5cldkHbLxHh25vT+ZEzbhXlqvpzKJwcEgfNwLAKFeo0/pvEE10XDB+EXRTXtSzJozQKFFAJhMxYkVaCW+E9AL7tMeU8acxidHqzb6lX4691UsDpy/LLRmT+epgW56+5Cw8tB4kMUv6s9lh3eRKbyGs+H/4mQMaYzPTf2OOdokEn+zzgvoD3FqNKk8QqGAXVsqcGdXrT62fSPkR2vROFi68A6se86UxRUk4cajfPyCC4G5wDhD+zNq4jodQ4u4n/m37Lr36n4LIAAsVr02dFi9AiwA81MYs2rm4eDlDNmdMRvEKRHfBwW5DdMNp0jPFZMeARqF/wL4XBfd+EMLBfMzpH5GH6NaW+1vrvMdg+VxDzatk3MXgO3ro3P/DpcC6+Mo4MySJhKJhSR01SGGGp5hPWmrrUgrv3lDnP+HhcI3nt3YqBoVAVTBAQT5iuhTg8nvPtd8ZeYj6w1x6RqGUBrSku7+N1+BaasZvjTk64RoIDlL8brpEcJx3OmY7jLoZsswdtmhfC/G21llXhITOwmvRDDeTTPbyASOa16cF5/A1fZAidJpqju3wYAy9avPR1ya6eNp9K8XYrrtuxlqi+bDKwlfrYdR0RRiKRVTLOH85+ZY7XSmzRpfZBJjaTa81VDcJHpZnZnSQLASGYW9l51ZV/h7eVzTi3Hv6hUsgc/51AqJRTkpbFVLXXszoBL8nBX0u/0jBLT8nH+fJePbrwURT58OY+UieRjd1vs04w0VG5VN2U6MoGZkQzKN/ptz0Q366dxoTGmj7i1NQGHi9GgnquXFYdrCfZBmeb7s0T6yrdlZH5cZuwHFyIJ/kAtGsTg0xH5taAAq44BAk1CPk9KVVbqQzrCUiFdF/6gtlPQ8bHHc1G1W92MXGZ5HEHftyLYs8mbD/9xYRUWkHmlM0zC2ilJlnNgV4bfALpQghxOUoZL7VTqtCHIaQSXm+YUMnpkXybnV+A6xlm2CVy8fn0Xlm2XRa0+zzOa21JWWmixfiPMSCZ7qA4rS93VN3pkpF1s5TonQjisHf7iU9ZGvUPOAKZcR1pbeVf/Ul7OhepGCaId9wOtqo7pJ7yLcBZ0pFkOF28y4zEI/kcUNmutBHaQpBdNM8vjCS6HZRokkeo88TBAjGyG7SR+6vUgTcyK9Imalj0kuxz0wmK+byQU11AiJFk/ya5dNduRClcnU64yGu/ieWSeOos1t3ep+RPIWQ2pyTYVbZltTbsb7NiwSi3AV+8KLWk7LxCnfZUetEM8ThnsSoGH38/nyAwFguJp8FjvlHtcWZuU4hPva0rHfr0UhOOJ/F6vS62FW7KzkmRll2HEc7oUq4fyi5T70Vl7YVIfsPHUCdHesf9Lk7WNVWO75JDkYbMI8TOW8JKVtLY9d6UJRITO8oKo0xS+o99Yy04iniGHAaGj88kEWgwv0OrHdY/nr76DOGNS59hXCGXzTKUvDl9iKpLSWYN1lxIeyywdNpTkhay74w2jFT6NS8qkjo5CxA1yfSYwp6AJIZNKIeEK5PJAW7ORgWgwp0VgzYpqovMrWxbu+DGZ6Lhie1RAqpzm8VUzKJOH3mCzWuTOLsN3VT/dv2eeYe9UjbR8YTBsLz7q60VN1sU51k+um1f8JxD5pPhbhSC8rRaB454tmh6YUWrJI3+GWY0qeWioj/tbkYITOkJaeuGt4JrJvHA+l0Gu7kY7XOaa05alMnRWVCXqFgLIwSY4uF59Ue5SU4QKuc/HamDxbr0x6csCetXGoP7Qn1Bk/J9DsynO/UD6iZ1Hyrz+jit0hDCwi/E9OjgKTbB3ZQKQ/0ZOvevfNHG0NK4Aj3Cp7NpRk07RT1i/S0EL93Ag8GRgKI9CfpajKyK6+Jj/PI1KO5/85VAwz2AwzP8FTBb075IxCXv6T9RVvWT2tUaqxDS92zrGUbWzUYk9mSs82pECH+fkqsDt93VW++4YsR/dHCYcQSYTO/KaBMDj9LSD/J/+z20Kq8XvZUAIHtm9hRPP3ItbuAu2Hm5lkPs92pd7kCxgRs0xOVBnZ13ccdA0aunrwv9SdqElJRC3g+oCu+nXyCgmXUs9yMjTMAIHfxZV+aPKcZeUBWt057Xo85Ks1Ir5gzEHCWqZEhrLZMuF11ziGtFQUds/EESajhagzcKsxamcSZxGth4UII+adPhQkUnx2WyN+4YWR+r3f8MnkyGFuR4zjzxJS8WsQYR5PTyRaD9ixa6Mh741nBHbzfjXHskGDq179xaRNrCIB1z1xRfWfjqw2pHc1zk9xlPpL8sQWAIuETZZhbnmL54rceXVNRvUiKrrqIkeogsl0XXb17ylNb0f4GA9Wd44vffEG8FSZGHEL2fbaTGRcSiCeA8PmA/f6Hz8HCS76fXUHwgwkzSwlI71ekZ7Fapmlk/KC+Hs8hUcw3N2LN5LhkVYyizYFl/uPeVP5lsoJHhhfWvvSWruCUW1ZcJOeuTbrDgywJ/qG07gZJplnTvLcYdNaH0KMYOYMGX+rB4NGPFmQsNaIwlWrfCezxre8zXBrsMT+edVLbLqN1BqB76JH4BvZTqUIMfGwPGEn+EnmTV86fPBaYbFL3DFEhjB45CewkXEAtJxk4/Ms2pPXnaRqdky0HOYdcUcE2zcXq4vaIvW2/v0nHFJH2XXe22ueDmq/18XGtELSq85j9X8q0tcNSSKJIX8FTuJF/Pf8j5PhqG2u+osvsLxYrvvfeVJL+4tkcXcr9JV7v0ERmj/X6fM3NC4j6dS1+9Umr2oPavqiAydTZPLMNRGY23LO9zAVDly7jD+70G5TPPLdhRIl4WxcYjLnM+SNcJ26FOrkrISUtPObIz5Zb3AG612krnpy15RMW+1cQjlnWFI6538qky9axd2oJmHIHP08KyP0ubGO+TQNOYuv2uh17yCIvR8VcStw7o1g0NM60sk+8Tq7YfIBJrtp53GkvzXH7OA0p8/n/u1satf/VJhtR1l8Wa6Gmaug7haSpaCaYQax6ta0mkutlb+eAOSG1aobM81D9A4iS1RRlzBBoVX6tU1S6WE2N9ORY6DfeLRC4l9Rvr5h95XDWB2mR1d4WFudpsgVYwiTwT31ljskD8ZyDOlm5DkGh9N/UB/0AI5Xvb8ZBmai2hQ4BWMqFwYnzxwB26YHSOv9WgY3JXnvoN+2R4rqGVh/LLDMtpFP+SpMGJNWvbIl5SOodbCczW2RKleksPoUeGEzrjtKHVdtZA+kfqO+rVx/iclCqwoopepvJpSTDjT+b9GWylGRF8EDbGlw6eUzmJM95Ovoz+kwLX3c2fTjFeYEsE7vUZm3mqdGJuKh2w9/QGSaqRHs99aScGOdDqkFcACoqdbBoQqqjamhH6Q9ng39JCg3lrGJwd50Qk9ovnqBTr8MME7Ps2wiVfygUmPoUBJJfJWX5Nda0nuncbFkA=="))}const Aa=B3();new Set(Ka(Aa)),new Set(Ka(Aa)),T3(Aa),U3(Aa);const L3=new Uint8Array(32);L3.fill(0);const k3=`Ethereum Signed Message:
`;function K0(r){return typeof r=="string"&&(r=Fh(r)),xu(f3([Fh(k3),Fh(String(r.length)),r]))}const $3="address/5.7.0",lo=new er($3);function rp(r){Tr(r,20)||lo.throwArgumentError("invalid address","address",r),r=r.toLowerCase();const t=r.substring(2).split(""),e=new Uint8Array(40);for(let s=0;s<40;s++)e[s]=t[s].charCodeAt(0);const n=Le(xu(e));for(let s=0;s<40;s+=2)n[s>>1]>>4>=8&&(t[s]=t[s].toUpperCase()),(n[s>>1]&15)>=8&&(t[s+1]=t[s+1].toUpperCase());return"0x"+t.join("")}const j3=9007199254740991;function z3(r){return Math.log10?Math.log10(r):Math.log(r)/Math.LN10}const Pu={};for(let r=0;r<10;r++)Pu[String(r)]=String(r);for(let r=0;r<26;r++)Pu[String.fromCharCode(65+r)]=String(10+r);const ip=Math.floor(z3(j3));function H3(r){r=r.toUpperCase(),r=r.substring(4)+r.substring(0,2)+"00";let t=r.split("").map(n=>Pu[n]).join("");for(;t.length>=ip;){let n=t.substring(0,ip);t=parseInt(n,10)%97+t.substring(n.length)}let e=String(98-parseInt(t,10)%97);for(;e.length<2;)e="0"+e;return e}function K3(r){let t=null;if(typeof r!="string"&&lo.throwArgumentError("invalid address","address",r),r.match(/^(0x)?[0-9a-fA-F]{40}$/))r.substring(0,2)!=="0x"&&(r="0x"+r),t=rp(r),r.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==r&&lo.throwArgumentError("bad address checksum","address",r);else if(r.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(r.substring(2,4)!==H3(r)&&lo.throwArgumentError("bad icap checksum","address",r),t=b3(r.substring(4));t.length<40;)t="0"+t;t=rp("0x"+t)}else lo.throwArgumentError("invalid address","address",r);return t}function eo(r,t,e){Object.defineProperty(r,t,{enumerable:!0,value:e,writable:!1})}const V3=new Uint8Array(32);V3.fill(0),Oe.from(-1);const G3=Oe.from(0),Q3=Oe.from(1);Oe.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Ci(Q3.toHexString(),32),Ci(G3.toHexString(),32);var Ii={},ue={},Co=V0;function V0(r,t){if(!r)throw new Error(t||"Assertion failed")}V0.equal=function(r,t,e){if(r!=t)throw new Error(e||"Assertion failed: "+r+" != "+t)};var nu={exports:{}};typeof Object.create=="function"?nu.exports=function(r,t){t&&(r.super_=t,r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}))}:nu.exports=function(r,t){if(t){r.super_=t;var e=function(){};e.prototype=t.prototype,r.prototype=new e,r.prototype.constructor=r}};var J3=Co,Y3=nu.exports;ue.inherits=Y3;function W3(r,t){return(r.charCodeAt(t)&64512)!==55296||t<0||t+1>=r.length?!1:(r.charCodeAt(t+1)&64512)===56320}function X3(r,t){if(Array.isArray(r))return r.slice();if(!r)return[];var e=[];if(typeof r=="string")if(t){if(t==="hex")for(r=r.replace(/[^a-z0-9]+/ig,""),r.length%2!==0&&(r="0"+r),s=0;s<r.length;s+=2)e.push(parseInt(r[s]+r[s+1],16))}else for(var n=0,s=0;s<r.length;s++){var a=r.charCodeAt(s);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):W3(r,s)?(a=65536+((a&1023)<<10)+(r.charCodeAt(++s)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}else for(s=0;s<r.length;s++)e[s]=r[s]|0;return e}ue.toArray=X3;function Z3(r){for(var t="",e=0;e<r.length;e++)t+=Q0(r[e].toString(16));return t}ue.toHex=Z3;function G0(r){var t=r>>>24|r>>>8&65280|r<<8&16711680|(r&255)<<24;return t>>>0}ue.htonl=G0;function t_(r,t){for(var e="",n=0;n<r.length;n++){var s=r[n];t==="little"&&(s=G0(s)),e+=J0(s.toString(16))}return e}ue.toHex32=t_;function Q0(r){return r.length===1?"0"+r:r}ue.zero2=Q0;function J0(r){return r.length===7?"0"+r:r.length===6?"00"+r:r.length===5?"000"+r:r.length===4?"0000"+r:r.length===3?"00000"+r:r.length===2?"000000"+r:r.length===1?"0000000"+r:r}ue.zero8=J0;function e_(r,t,e,n){var s=e-t;J3(s%4===0);for(var a=new Array(s/4),h=0,u=t;h<a.length;h++,u+=4){var f;n==="big"?f=r[u]<<24|r[u+1]<<16|r[u+2]<<8|r[u+3]:f=r[u+3]<<24|r[u+2]<<16|r[u+1]<<8|r[u],a[h]=f>>>0}return a}ue.join32=e_;function r_(r,t){for(var e=new Array(r.length*4),n=0,s=0;n<r.length;n++,s+=4){var a=r[n];t==="big"?(e[s]=a>>>24,e[s+1]=a>>>16&255,e[s+2]=a>>>8&255,e[s+3]=a&255):(e[s+3]=a>>>24,e[s+2]=a>>>16&255,e[s+1]=a>>>8&255,e[s]=a&255)}return e}ue.split32=r_;function i_(r,t){return r>>>t|r<<32-t}ue.rotr32=i_;function n_(r,t){return r<<t|r>>>32-t}ue.rotl32=n_;function s_(r,t){return r+t>>>0}ue.sum32=s_;function o_(r,t,e){return r+t+e>>>0}ue.sum32_3=o_;function a_(r,t,e,n){return r+t+e+n>>>0}ue.sum32_4=a_;function c_(r,t,e,n,s){return r+t+e+n+s>>>0}ue.sum32_5=c_;function h_(r,t,e,n){var s=r[t],a=r[t+1],h=n+a>>>0,u=(h<n?1:0)+e+s;r[t]=u>>>0,r[t+1]=h}ue.sum64=h_;function u_(r,t,e,n){var s=t+n>>>0,a=(s<t?1:0)+r+e;return a>>>0}ue.sum64_hi=u_;function l_(r,t,e,n){var s=t+n;return s>>>0}ue.sum64_lo=l_;function f_(r,t,e,n,s,a,h,u){var f=0,y=t;y=y+n>>>0,f+=y<t?1:0,y=y+a>>>0,f+=y<a?1:0,y=y+u>>>0,f+=y<u?1:0;var A=r+e+s+h+f;return A>>>0}ue.sum64_4_hi=f_;function d_(r,t,e,n,s,a,h,u){var f=t+n+a+u;return f>>>0}ue.sum64_4_lo=d_;function p_(r,t,e,n,s,a,h,u,f,y){var A=0,x=t;x=x+n>>>0,A+=x<t?1:0,x=x+a>>>0,A+=x<a?1:0,x=x+u>>>0,A+=x<u?1:0,x=x+y>>>0,A+=x<y?1:0;var T=r+e+s+h+f+A;return T>>>0}ue.sum64_5_hi=p_;function g_(r,t,e,n,s,a,h,u,f,y){var A=t+n+a+u+y;return A>>>0}ue.sum64_5_lo=g_;function m_(r,t,e){var n=t<<32-e|r>>>e;return n>>>0}ue.rotr64_hi=m_;function v_(r,t,e){var n=r<<32-e|t>>>e;return n>>>0}ue.rotr64_lo=v_;function y_(r,t,e){return r>>>e}ue.shr64_hi=y_;function w_(r,t,e){var n=r<<32-e|t>>>e;return n>>>0}ue.shr64_lo=w_;var Es={},np=ue,b_=Co;function Ea(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Es.BlockHash=Ea,Ea.prototype.update=function(r,t){if(r=np.toArray(r,t),this.pending?this.pending=this.pending.concat(r):this.pending=r,this.pendingTotal+=r.length,this.pending.length>=this._delta8){r=this.pending;var e=r.length%this._delta8;this.pending=r.slice(r.length-e,r.length),this.pending.length===0&&(this.pending=null),r=np.join32(r,0,r.length-e,this.endian);for(var n=0;n<r.length;n+=this._delta32)this._update(r,n,n+this._delta32)}return this},Ea.prototype.digest=function(r){return this.update(this._pad()),b_(this.pending===null),this._digest(r)},Ea.prototype._pad=function(){var r=this.pendingTotal,t=this._delta8,e=t-(r+this.padLength)%t,n=new Array(e+this.padLength);n[0]=128;for(var s=1;s<e;s++)n[s]=0;if(r<<=3,this.endian==="big"){for(var a=8;a<this.padLength;a++)n[s++]=0;n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=r>>>24&255,n[s++]=r>>>16&255,n[s++]=r>>>8&255,n[s++]=r&255}else for(n[s++]=r&255,n[s++]=r>>>8&255,n[s++]=r>>>16&255,n[s++]=r>>>24&255,n[s++]=0,n[s++]=0,n[s++]=0,n[s++]=0,a=8;a<this.padLength;a++)n[s++]=0;return n};var hs={},qi={},__=ue,Ni=__.rotr32;function A_(r,t,e,n){if(r===0)return Y0(t,e,n);if(r===1||r===3)return X0(t,e,n);if(r===2)return W0(t,e,n)}qi.ft_1=A_;function Y0(r,t,e){return r&t^~r&e}qi.ch32=Y0;function W0(r,t,e){return r&t^r&e^t&e}qi.maj32=W0;function X0(r,t,e){return r^t^e}qi.p32=X0;function E_(r){return Ni(r,2)^Ni(r,13)^Ni(r,22)}qi.s0_256=E_;function I_(r){return Ni(r,6)^Ni(r,11)^Ni(r,25)}qi.s1_256=I_;function S_(r){return Ni(r,7)^Ni(r,18)^r>>>3}qi.g0_256=S_;function x_(r){return Ni(r,17)^Ni(r,19)^r>>>10}qi.g1_256=x_;var vs=ue,M_=Es,P_=qi,qh=vs.rotl32,ro=vs.sum32,C_=vs.sum32_5,N_=P_.ft_1,Z0=M_.BlockHash,R_=[1518500249,1859775393,2400959708,3395469782];function Mi(){if(!(this instanceof Mi))return new Mi;Z0.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}vs.inherits(Mi,Z0);var O_=Mi;Mi.blockSize=512,Mi.outSize=160,Mi.hmacStrength=80,Mi.padLength=64,Mi.prototype._update=function(r,t){for(var e=this.W,n=0;n<16;n++)e[n]=r[t+n];for(;n<e.length;n++)e[n]=qh(e[n-3]^e[n-8]^e[n-14]^e[n-16],1);var s=this.h[0],a=this.h[1],h=this.h[2],u=this.h[3],f=this.h[4];for(n=0;n<e.length;n++){var y=~~(n/20),A=C_(qh(s,5),N_(y,a,h,u),f,e[n],R_[y]);f=u,u=h,h=qh(a,30),a=s,s=A}this.h[0]=ro(this.h[0],s),this.h[1]=ro(this.h[1],a),this.h[2]=ro(this.h[2],h),this.h[3]=ro(this.h[3],u),this.h[4]=ro(this.h[4],f)},Mi.prototype._digest=function(r){return r==="hex"?vs.toHex32(this.h,"big"):vs.split32(this.h,"big")};var ys=ue,T_=Es,Is=qi,F_=Co,ei=ys.sum32,D_=ys.sum32_4,q_=ys.sum32_5,U_=Is.ch32,B_=Is.maj32,L_=Is.s0_256,k_=Is.s1_256,$_=Is.g0_256,j_=Is.g1_256,tg=T_.BlockHash,z_=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Pi(){if(!(this instanceof Pi))return new Pi;tg.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=z_,this.W=new Array(64)}ys.inherits(Pi,tg);var eg=Pi;Pi.blockSize=512,Pi.outSize=256,Pi.hmacStrength=192,Pi.padLength=64,Pi.prototype._update=function(r,t){for(var e=this.W,n=0;n<16;n++)e[n]=r[t+n];for(;n<e.length;n++)e[n]=D_(j_(e[n-2]),e[n-7],$_(e[n-15]),e[n-16]);var s=this.h[0],a=this.h[1],h=this.h[2],u=this.h[3],f=this.h[4],y=this.h[5],A=this.h[6],x=this.h[7];for(F_(this.k.length===e.length),n=0;n<e.length;n++){var T=q_(x,k_(f),U_(f,y,A),this.k[n],e[n]),R=ei(L_(s),B_(s,a,h));x=A,A=y,y=f,f=ei(u,T),u=h,h=a,a=s,s=ei(T,R)}this.h[0]=ei(this.h[0],s),this.h[1]=ei(this.h[1],a),this.h[2]=ei(this.h[2],h),this.h[3]=ei(this.h[3],u),this.h[4]=ei(this.h[4],f),this.h[5]=ei(this.h[5],y),this.h[6]=ei(this.h[6],A),this.h[7]=ei(this.h[7],x)},Pi.prototype._digest=function(r){return r==="hex"?ys.toHex32(this.h,"big"):ys.split32(this.h,"big")};var su=ue,rg=eg;function Xi(){if(!(this instanceof Xi))return new Xi;rg.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}su.inherits(Xi,rg);var H_=Xi;Xi.blockSize=512,Xi.outSize=224,Xi.hmacStrength=192,Xi.padLength=64,Xi.prototype._digest=function(r){return r==="hex"?su.toHex32(this.h.slice(0,7),"big"):su.split32(this.h.slice(0,7),"big")};var Ir=ue,K_=Es,V_=Co,Ri=Ir.rotr64_hi,Oi=Ir.rotr64_lo,ig=Ir.shr64_hi,ng=Ir.shr64_lo,pn=Ir.sum64,Uh=Ir.sum64_hi,Bh=Ir.sum64_lo,G_=Ir.sum64_4_hi,Q_=Ir.sum64_4_lo,J_=Ir.sum64_5_hi,Y_=Ir.sum64_5_lo,sg=K_.BlockHash,W_=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function oi(){if(!(this instanceof oi))return new oi;sg.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=W_,this.W=new Array(160)}Ir.inherits(oi,sg);var og=oi;oi.blockSize=1024,oi.outSize=512,oi.hmacStrength=192,oi.padLength=128,oi.prototype._prepareBlock=function(r,t){for(var e=this.W,n=0;n<32;n++)e[n]=r[t+n];for(;n<e.length;n+=2){var s=c5(e[n-4],e[n-3]),a=h5(e[n-4],e[n-3]),h=e[n-14],u=e[n-13],f=o5(e[n-30],e[n-29]),y=a5(e[n-30],e[n-29]),A=e[n-32],x=e[n-31];e[n]=G_(s,a,h,u,f,y,A,x),e[n+1]=Q_(s,a,h,u,f,y,A,x)}},oi.prototype._update=function(r,t){this._prepareBlock(r,t);var e=this.W,n=this.h[0],s=this.h[1],a=this.h[2],h=this.h[3],u=this.h[4],f=this.h[5],y=this.h[6],A=this.h[7],x=this.h[8],T=this.h[9],R=this.h[10],$=this.h[11],Q=this.h[12],V=this.h[13],Z=this.h[14],H=this.h[15];V_(this.k.length===e.length);for(var J=0;J<e.length;J+=2){var B=Z,k=H,z=n5(x,T),w=s5(x,T),q=X_(x,T,R,$,Q),ht=Z_(x,T,R,$,Q,V),ut=this.k[J],lt=this.k[J+1],gt=e[J],l=e[J+1],v=J_(B,k,z,w,q,ht,ut,lt,gt,l),m=Y_(B,k,z,w,q,ht,ut,lt,gt,l);B=r5(n,s),k=i5(n,s),z=t5(n,s,a,h,u),w=e5(n,s,a,h,u,f);var b=Uh(B,k,z,w),E=Bh(B,k,z,w);Z=Q,H=V,Q=R,V=$,R=x,$=T,x=Uh(y,A,v,m),T=Bh(A,A,v,m),y=u,A=f,u=a,f=h,a=n,h=s,n=Uh(v,m,b,E),s=Bh(v,m,b,E)}pn(this.h,0,n,s),pn(this.h,2,a,h),pn(this.h,4,u,f),pn(this.h,6,y,A),pn(this.h,8,x,T),pn(this.h,10,R,$),pn(this.h,12,Q,V),pn(this.h,14,Z,H)},oi.prototype._digest=function(r){return r==="hex"?Ir.toHex32(this.h,"big"):Ir.split32(this.h,"big")};function X_(r,t,e,n,s){var a=r&e^~r&s;return a<0&&(a+=4294967296),a}function Z_(r,t,e,n,s,a){var h=t&n^~t&a;return h<0&&(h+=4294967296),h}function t5(r,t,e,n,s){var a=r&e^r&s^e&s;return a<0&&(a+=4294967296),a}function e5(r,t,e,n,s,a){var h=t&n^t&a^n&a;return h<0&&(h+=4294967296),h}function r5(r,t){var e=Ri(r,t,28),n=Ri(t,r,2),s=Ri(t,r,7),a=e^n^s;return a<0&&(a+=4294967296),a}function i5(r,t){var e=Oi(r,t,28),n=Oi(t,r,2),s=Oi(t,r,7),a=e^n^s;return a<0&&(a+=4294967296),a}function n5(r,t){var e=Ri(r,t,14),n=Ri(r,t,18),s=Ri(t,r,9),a=e^n^s;return a<0&&(a+=4294967296),a}function s5(r,t){var e=Oi(r,t,14),n=Oi(r,t,18),s=Oi(t,r,9),a=e^n^s;return a<0&&(a+=4294967296),a}function o5(r,t){var e=Ri(r,t,1),n=Ri(r,t,8),s=ig(r,t,7),a=e^n^s;return a<0&&(a+=4294967296),a}function a5(r,t){var e=Oi(r,t,1),n=Oi(r,t,8),s=ng(r,t,7),a=e^n^s;return a<0&&(a+=4294967296),a}function c5(r,t){var e=Ri(r,t,19),n=Ri(t,r,29),s=ig(r,t,6),a=e^n^s;return a<0&&(a+=4294967296),a}function h5(r,t){var e=Oi(r,t,19),n=Oi(t,r,29),s=ng(r,t,6),a=e^n^s;return a<0&&(a+=4294967296),a}var ou=ue,ag=og;function Zi(){if(!(this instanceof Zi))return new Zi;ag.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}ou.inherits(Zi,ag);var u5=Zi;Zi.blockSize=1024,Zi.outSize=384,Zi.hmacStrength=192,Zi.padLength=128,Zi.prototype._digest=function(r){return r==="hex"?ou.toHex32(this.h.slice(0,12),"big"):ou.split32(this.h.slice(0,12),"big")},hs.sha1=O_,hs.sha224=H_,hs.sha256=eg,hs.sha384=u5,hs.sha512=og;var cg={},qn=ue,l5=Es,Ia=qn.rotl32,sp=qn.sum32,io=qn.sum32_3,op=qn.sum32_4,hg=l5.BlockHash;function Si(){if(!(this instanceof Si))return new Si;hg.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}qn.inherits(Si,hg),cg.ripemd160=Si,Si.blockSize=512,Si.outSize=160,Si.hmacStrength=192,Si.padLength=64,Si.prototype._update=function(r,t){for(var e=this.h[0],n=this.h[1],s=this.h[2],a=this.h[3],h=this.h[4],u=e,f=n,y=s,A=a,x=h,T=0;T<80;T++){var R=sp(Ia(op(e,ap(T,n,s,a),r[p5[T]+t],f5(T)),m5[T]),h);e=h,h=a,a=Ia(s,10),s=n,n=R,R=sp(Ia(op(u,ap(79-T,f,y,A),r[g5[T]+t],d5(T)),v5[T]),x),u=x,x=A,A=Ia(y,10),y=f,f=R}R=io(this.h[1],s,A),this.h[1]=io(this.h[2],a,x),this.h[2]=io(this.h[3],h,u),this.h[3]=io(this.h[4],e,f),this.h[4]=io(this.h[0],n,y),this.h[0]=R},Si.prototype._digest=function(r){return r==="hex"?qn.toHex32(this.h,"little"):qn.split32(this.h,"little")};function ap(r,t,e,n){return r<=15?t^e^n:r<=31?t&e|~t&n:r<=47?(t|~e)^n:r<=63?t&n|e&~n:t^(e|~n)}function f5(r){return r<=15?0:r<=31?1518500249:r<=47?1859775393:r<=63?2400959708:2840853838}function d5(r){return r<=15?1352829926:r<=31?1548603684:r<=47?1836072691:r<=63?2053994217:0}var p5=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g5=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],m5=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v5=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],y5=ue,w5=Co;function gs(r,t,e){if(!(this instanceof gs))return new gs(r,t,e);this.Hash=r,this.blockSize=r.blockSize/8,this.outSize=r.outSize/8,this.inner=null,this.outer=null,this._init(y5.toArray(t,e))}var b5=gs;gs.prototype._init=function(r){r.length>this.blockSize&&(r=new this.Hash().update(r).digest()),w5(r.length<=this.blockSize);for(var t=r.length;t<this.blockSize;t++)r.push(0);for(t=0;t<r.length;t++)r[t]^=54;for(this.inner=new this.Hash().update(r),t=0;t<r.length;t++)r[t]^=106;this.outer=new this.Hash().update(r)},gs.prototype.update=function(r,t){return this.inner.update(r,t),this},gs.prototype.digest=function(r){return this.outer.update(this.inner.digest()),this.outer.digest(r)},function(r){var t=r;t.utils=ue,t.common=Es,t.sha=hs,t.ripemd=cg,t.hmac=b5,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160}(Ii);function Ss(r,t,e){return e={path:t,exports:{},require:function(n,s){return _5(n,s??e.path)}},r(e,e.exports),e.exports}function _5(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}var Cu=ug;function ug(r,t){if(!r)throw new Error(t||"Assertion failed")}ug.equal=function(r,t,e){if(r!=t)throw new Error(e||"Assertion failed: "+r+" != "+t)};var ai=Ss(function(r,t){var e=t;function n(h,u){if(Array.isArray(h))return h.slice();if(!h)return[];var f=[];if(typeof h!="string"){for(var y=0;y<h.length;y++)f[y]=h[y]|0;return f}if(u==="hex"){h=h.replace(/[^a-z0-9]+/ig,""),h.length%2!==0&&(h="0"+h);for(var y=0;y<h.length;y+=2)f.push(parseInt(h[y]+h[y+1],16))}else for(var y=0;y<h.length;y++){var A=h.charCodeAt(y),x=A>>8,T=A&255;x?f.push(x,T):f.push(T)}return f}e.toArray=n;function s(h){return h.length===1?"0"+h:h}e.zero2=s;function a(h){for(var u="",f=0;f<h.length;f++)u+=s(h[f].toString(16));return u}e.toHex=a,e.encode=function(h,u){return u==="hex"?a(h):h}}),Fr=Ss(function(r,t){var e=t;e.assert=Cu,e.toArray=ai.toArray,e.zero2=ai.zero2,e.toHex=ai.toHex,e.encode=ai.encode;function n(f,y,A){var x=new Array(Math.max(f.bitLength(),A)+1);x.fill(0);for(var T=1<<y+1,R=f.clone(),$=0;$<x.length;$++){var Q,V=R.andln(T-1);R.isOdd()?(V>(T>>1)-1?Q=(T>>1)-V:Q=V,R.isubn(Q)):Q=0,x[$]=Q,R.iushrn(1)}return x}e.getNAF=n;function s(f,y){var A=[[],[]];f=f.clone(),y=y.clone();for(var x=0,T=0,R;f.cmpn(-x)>0||y.cmpn(-T)>0;){var $=f.andln(3)+x&3,Q=y.andln(3)+T&3;$===3&&($=-1),Q===3&&(Q=-1);var V;$&1?(R=f.andln(7)+x&7,(R===3||R===5)&&Q===2?V=-$:V=$):V=0,A[0].push(V);var Z;Q&1?(R=y.andln(7)+T&7,(R===3||R===5)&&$===2?Z=-Q:Z=Q):Z=0,A[1].push(Z),2*x===V+1&&(x=1-x),2*T===Z+1&&(T=1-T),f.iushrn(1),y.iushrn(1)}return A}e.getJSF=s;function a(f,y,A){var x="_"+y;f.prototype[y]=function(){return this[x]!==void 0?this[x]:this[x]=A.call(this)}}e.cachedProperty=a;function h(f){return typeof f=="string"?e.toArray(f,"hex"):f}e.parseBytes=h;function u(f){return new Zt(f,"hex","le")}e.intFromLE=u}),Sa=Fr.getNAF,A5=Fr.getJSF,Va=Fr.assert;function vn(r,t){this.type=r,this.p=new Zt(t.p,16),this.red=t.prime?Zt.red(t.prime):Zt.mont(this.p),this.zero=new Zt(0).toRed(this.red),this.one=new Zt(1).toRed(this.red),this.two=new Zt(2).toRed(this.red),this.n=t.n&&new Zt(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var e=this.n&&this.p.div(this.n);!e||e.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Ln=vn;vn.prototype.point=function(){throw new Error("Not implemented")},vn.prototype.validate=function(){throw new Error("Not implemented")},vn.prototype._fixedNafMul=function(r,t){Va(r.precomputed);var e=r._getDoubles(),n=Sa(t,1,this._bitLength),s=(1<<e.step+1)-(e.step%2===0?2:1);s/=3;var a=[],h,u;for(h=0;h<n.length;h+=e.step){u=0;for(var f=h+e.step-1;f>=h;f--)u=(u<<1)+n[f];a.push(u)}for(var y=this.jpoint(null,null,null),A=this.jpoint(null,null,null),x=s;x>0;x--){for(h=0;h<a.length;h++)u=a[h],u===x?A=A.mixedAdd(e.points[h]):u===-x&&(A=A.mixedAdd(e.points[h].neg()));y=y.add(A)}return y.toP()},vn.prototype._wnafMul=function(r,t){var e=4,n=r._getNAFPoints(e);e=n.wnd;for(var s=n.points,a=Sa(t,e,this._bitLength),h=this.jpoint(null,null,null),u=a.length-1;u>=0;u--){for(var f=0;u>=0&&a[u]===0;u--)f++;if(u>=0&&f++,h=h.dblp(f),u<0)break;var y=a[u];Va(y!==0),r.type==="affine"?y>0?h=h.mixedAdd(s[y-1>>1]):h=h.mixedAdd(s[-y-1>>1].neg()):y>0?h=h.add(s[y-1>>1]):h=h.add(s[-y-1>>1].neg())}return r.type==="affine"?h.toP():h},vn.prototype._wnafMulAdd=function(r,t,e,n,s){var a=this._wnafT1,h=this._wnafT2,u=this._wnafT3,f=0,y,A,x;for(y=0;y<n;y++){x=t[y];var T=x._getNAFPoints(r);a[y]=T.wnd,h[y]=T.points}for(y=n-1;y>=1;y-=2){var R=y-1,$=y;if(a[R]!==1||a[$]!==1){u[R]=Sa(e[R],a[R],this._bitLength),u[$]=Sa(e[$],a[$],this._bitLength),f=Math.max(u[R].length,f),f=Math.max(u[$].length,f);continue}var Q=[t[R],null,null,t[$]];t[R].y.cmp(t[$].y)===0?(Q[1]=t[R].add(t[$]),Q[2]=t[R].toJ().mixedAdd(t[$].neg())):t[R].y.cmp(t[$].y.redNeg())===0?(Q[1]=t[R].toJ().mixedAdd(t[$]),Q[2]=t[R].add(t[$].neg())):(Q[1]=t[R].toJ().mixedAdd(t[$]),Q[2]=t[R].toJ().mixedAdd(t[$].neg()));var V=[-3,-1,-5,-7,0,7,5,1,3],Z=A5(e[R],e[$]);for(f=Math.max(Z[0].length,f),u[R]=new Array(f),u[$]=new Array(f),A=0;A<f;A++){var H=Z[0][A]|0,J=Z[1][A]|0;u[R][A]=V[(H+1)*3+(J+1)],u[$][A]=0,h[R]=Q}}var B=this.jpoint(null,null,null),k=this._wnafT4;for(y=f;y>=0;y--){for(var z=0;y>=0;){var w=!0;for(A=0;A<n;A++)k[A]=u[A][y]|0,k[A]!==0&&(w=!1);if(!w)break;z++,y--}if(y>=0&&z++,B=B.dblp(z),y<0)break;for(A=0;A<n;A++){var q=k[A];q!==0&&(q>0?x=h[A][q-1>>1]:q<0&&(x=h[A][-q-1>>1].neg()),x.type==="affine"?B=B.mixedAdd(x):B=B.add(x))}}for(y=0;y<n;y++)h[y]=null;return s?B:B.toP()};function Kr(r,t){this.curve=r,this.type=t,this.precomputed=null}vn.BasePoint=Kr,Kr.prototype.eq=function(){throw new Error("Not implemented")},Kr.prototype.validate=function(){return this.curve.validate(this)},vn.prototype.decodePoint=function(r,t){r=Fr.toArray(r,t);var e=this.p.byteLength();if((r[0]===4||r[0]===6||r[0]===7)&&r.length-1===2*e){r[0]===6?Va(r[r.length-1]%2===0):r[0]===7&&Va(r[r.length-1]%2===1);var n=this.point(r.slice(1,1+e),r.slice(1+e,1+2*e));return n}else if((r[0]===2||r[0]===3)&&r.length-1===e)return this.pointFromX(r.slice(1,1+e),r[0]===3);throw new Error("Unknown point format")},Kr.prototype.encodeCompressed=function(r){return this.encode(r,!0)},Kr.prototype._encode=function(r){var t=this.curve.p.byteLength(),e=this.getX().toArray("be",t);return r?[this.getY().isEven()?2:3].concat(e):[4].concat(e,this.getY().toArray("be",t))},Kr.prototype.encode=function(r,t){return Fr.encode(this._encode(t),r)},Kr.prototype.precompute=function(r){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,r),t.beta=this._getBeta(),this.precomputed=t,this},Kr.prototype._hasDoubles=function(r){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return t?t.points.length>=Math.ceil((r.bitLength()+1)/t.step):!1},Kr.prototype._getDoubles=function(r,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var e=[this],n=this,s=0;s<t;s+=r){for(var a=0;a<r;a++)n=n.dbl();e.push(n)}return{step:r,points:e}},Kr.prototype._getNAFPoints=function(r){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],e=(1<<r)-1,n=e===1?null:this.dbl(),s=1;s<e;s++)t[s]=t[s-1].add(n);return{wnd:r,points:t}},Kr.prototype._getBeta=function(){return null},Kr.prototype.dblp=function(r){for(var t=this,e=0;e<r;e++)t=t.dbl();return t};var Nu=Ss(function(r){typeof Object.create=="function"?r.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(t,e){if(e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}}}),E5=Fr.assert;function Jr(r){Ln.call(this,"short",r),this.a=new Zt(r.a,16).toRed(this.red),this.b=new Zt(r.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(r),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Nu(Jr,Ln);var I5=Jr;Jr.prototype._getEndomorphism=function(r){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var t,e;if(r.beta)t=new Zt(r.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);t=n[0].cmp(n[1])<0?n[0]:n[1],t=t.toRed(this.red)}if(r.lambda)e=new Zt(r.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(t))===0?e=s[0]:(e=s[1],E5(this.g.mul(e).x.cmp(this.g.x.redMul(t))===0))}var a;return r.basis?a=r.basis.map(function(h){return{a:new Zt(h.a,16),b:new Zt(h.b,16)}}):a=this._getEndoBasis(e),{beta:t,lambda:e,basis:a}}},Jr.prototype._getEndoRoots=function(r){var t=r===this.p?this.red:Zt.mont(r),e=new Zt(2).toRed(t).redInvm(),n=e.redNeg(),s=new Zt(3).toRed(t).redNeg().redSqrt().redMul(e),a=n.redAdd(s).fromRed(),h=n.redSub(s).fromRed();return[a,h]},Jr.prototype._getEndoBasis=function(r){for(var t=this.n.ushrn(Math.floor(this.n.bitLength()/2)),e=r,n=this.n.clone(),s=new Zt(1),a=new Zt(0),h=new Zt(0),u=new Zt(1),f,y,A,x,T,R,$,Q=0,V,Z;e.cmpn(0)!==0;){var H=n.div(e);V=n.sub(H.mul(e)),Z=h.sub(H.mul(s));var J=u.sub(H.mul(a));if(!A&&V.cmp(t)<0)f=$.neg(),y=s,A=V.neg(),x=Z;else if(A&&++Q===2)break;$=V,n=e,e=V,h=s,s=Z,u=a,a=J}T=V.neg(),R=Z;var B=A.sqr().add(x.sqr()),k=T.sqr().add(R.sqr());return k.cmp(B)>=0&&(T=f,R=y),A.negative&&(A=A.neg(),x=x.neg()),T.negative&&(T=T.neg(),R=R.neg()),[{a:A,b:x},{a:T,b:R}]},Jr.prototype._endoSplit=function(r){var t=this.endo.basis,e=t[0],n=t[1],s=n.b.mul(r).divRound(this.n),a=e.b.neg().mul(r).divRound(this.n),h=s.mul(e.a),u=a.mul(n.a),f=s.mul(e.b),y=a.mul(n.b),A=r.sub(h).sub(u),x=f.add(y).neg();return{k1:A,k2:x}},Jr.prototype.pointFromX=function(r,t){r=new Zt(r,16),r.red||(r=r.toRed(this.red));var e=r.redSqr().redMul(r).redIAdd(r.redMul(this.a)).redIAdd(this.b),n=e.redSqrt();if(n.redSqr().redSub(e).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(t&&!s||!t&&s)&&(n=n.redNeg()),this.point(r,n)},Jr.prototype.validate=function(r){if(r.inf)return!0;var t=r.x,e=r.y,n=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(n).redIAdd(this.b);return e.redSqr().redISub(s).cmpn(0)===0},Jr.prototype._endoWnafMulAdd=function(r,t,e){for(var n=this._endoWnafT1,s=this._endoWnafT2,a=0;a<r.length;a++){var h=this._endoSplit(t[a]),u=r[a],f=u._getBeta();h.k1.negative&&(h.k1.ineg(),u=u.neg(!0)),h.k2.negative&&(h.k2.ineg(),f=f.neg(!0)),n[a*2]=u,n[a*2+1]=f,s[a*2]=h.k1,s[a*2+1]=h.k2}for(var y=this._wnafMulAdd(1,n,s,a*2,e),A=0;A<a*2;A++)n[A]=null,s[A]=null;return y};function Ye(r,t,e,n){Ln.BasePoint.call(this,r,"affine"),t===null&&e===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Zt(t,16),this.y=new Zt(e,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Nu(Ye,Ln.BasePoint),Jr.prototype.point=function(r,t,e){return new Ye(this,r,t,e)},Jr.prototype.pointFromJSON=function(r,t){return Ye.fromJSON(this,r,t)},Ye.prototype._getBeta=function(){if(this.curve.endo){var r=this.precomputed;if(r&&r.beta)return r.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(r){var e=this.curve,n=function(s){return e.point(s.x.redMul(e.endo.beta),s.y)};r.beta=t,t.precomputed={beta:null,naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(n)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(n)}}}return t}},Ye.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},Ye.fromJSON=function(r,t,e){typeof t=="string"&&(t=JSON.parse(t));var n=r.point(t[0],t[1],e);if(!t[2])return n;function s(h){return r.point(h[0],h[1],e)}var a=t[2];return n.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[n].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[n].concat(a.naf.points.map(s))}},n},Ye.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},Ye.prototype.isInfinity=function(){return this.inf},Ye.prototype.add=function(r){if(this.inf)return r;if(r.inf)return this;if(this.eq(r))return this.dbl();if(this.neg().eq(r))return this.curve.point(null,null);if(this.x.cmp(r.x)===0)return this.curve.point(null,null);var t=this.y.redSub(r.y);t.cmpn(0)!==0&&(t=t.redMul(this.x.redSub(r.x).redInvm()));var e=t.redSqr().redISub(this.x).redISub(r.x),n=t.redMul(this.x.redSub(e)).redISub(this.y);return this.curve.point(e,n)},Ye.prototype.dbl=function(){if(this.inf)return this;var r=this.y.redAdd(this.y);if(r.cmpn(0)===0)return this.curve.point(null,null);var t=this.curve.a,e=this.x.redSqr(),n=r.redInvm(),s=e.redAdd(e).redIAdd(e).redIAdd(t).redMul(n),a=s.redSqr().redISub(this.x.redAdd(this.x)),h=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,h)},Ye.prototype.getX=function(){return this.x.fromRed()},Ye.prototype.getY=function(){return this.y.fromRed()},Ye.prototype.mul=function(r){return r=new Zt(r,16),this.isInfinity()?this:this._hasDoubles(r)?this.curve._fixedNafMul(this,r):this.curve.endo?this.curve._endoWnafMulAdd([this],[r]):this.curve._wnafMul(this,r)},Ye.prototype.mulAdd=function(r,t,e){var n=[this,t],s=[r,e];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)},Ye.prototype.jmulAdd=function(r,t,e){var n=[this,t],s=[r,e];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)},Ye.prototype.eq=function(r){return this===r||this.inf===r.inf&&(this.inf||this.x.cmp(r.x)===0&&this.y.cmp(r.y)===0)},Ye.prototype.neg=function(r){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(r&&this.precomputed){var e=this.precomputed,n=function(s){return s.neg()};t.precomputed={naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return t},Ye.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var r=this.curve.jpoint(this.x,this.y,this.curve.one);return r};function tr(r,t,e,n){Ln.BasePoint.call(this,r,"jacobian"),t===null&&e===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Zt(0)):(this.x=new Zt(t,16),this.y=new Zt(e,16),this.z=new Zt(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Nu(tr,Ln.BasePoint),Jr.prototype.jpoint=function(r,t,e){return new tr(this,r,t,e)},tr.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var r=this.z.redInvm(),t=r.redSqr(),e=this.x.redMul(t),n=this.y.redMul(t).redMul(r);return this.curve.point(e,n)},tr.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},tr.prototype.add=function(r){if(this.isInfinity())return r;if(r.isInfinity())return this;var t=r.z.redSqr(),e=this.z.redSqr(),n=this.x.redMul(t),s=r.x.redMul(e),a=this.y.redMul(t.redMul(r.z)),h=r.y.redMul(e.redMul(this.z)),u=n.redSub(s),f=a.redSub(h);if(u.cmpn(0)===0)return f.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var y=u.redSqr(),A=y.redMul(u),x=n.redMul(y),T=f.redSqr().redIAdd(A).redISub(x).redISub(x),R=f.redMul(x.redISub(T)).redISub(a.redMul(A)),$=this.z.redMul(r.z).redMul(u);return this.curve.jpoint(T,R,$)},tr.prototype.mixedAdd=function(r){if(this.isInfinity())return r.toJ();if(r.isInfinity())return this;var t=this.z.redSqr(),e=this.x,n=r.x.redMul(t),s=this.y,a=r.y.redMul(t).redMul(this.z),h=e.redSub(n),u=s.redSub(a);if(h.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var f=h.redSqr(),y=f.redMul(h),A=e.redMul(f),x=u.redSqr().redIAdd(y).redISub(A).redISub(A),T=u.redMul(A.redISub(x)).redISub(s.redMul(y)),R=this.z.redMul(h);return this.curve.jpoint(x,T,R)},tr.prototype.dblp=function(r){if(r===0)return this;if(this.isInfinity())return this;if(!r)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var e=this;for(t=0;t<r;t++)e=e.dbl();return e}var n=this.curve.a,s=this.curve.tinv,a=this.x,h=this.y,u=this.z,f=u.redSqr().redSqr(),y=h.redAdd(h);for(t=0;t<r;t++){var A=a.redSqr(),x=y.redSqr(),T=x.redSqr(),R=A.redAdd(A).redIAdd(A).redIAdd(n.redMul(f)),$=a.redMul(x),Q=R.redSqr().redISub($.redAdd($)),V=$.redISub(Q),Z=R.redMul(V);Z=Z.redIAdd(Z).redISub(T);var H=y.redMul(u);t+1<r&&(f=f.redMul(T)),a=Q,u=H,y=Z}return this.curve.jpoint(a,y.redMul(s),u)},tr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},tr.prototype._zeroDbl=function(){var r,t,e;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),h=this.x.redAdd(s).redSqr().redISub(n).redISub(a);h=h.redIAdd(h);var u=n.redAdd(n).redIAdd(n),f=u.redSqr().redISub(h).redISub(h),y=a.redIAdd(a);y=y.redIAdd(y),y=y.redIAdd(y),r=f,t=u.redMul(h.redISub(f)).redISub(y),e=this.y.redAdd(this.y)}else{var A=this.x.redSqr(),x=this.y.redSqr(),T=x.redSqr(),R=this.x.redAdd(x).redSqr().redISub(A).redISub(T);R=R.redIAdd(R);var $=A.redAdd(A).redIAdd(A),Q=$.redSqr(),V=T.redIAdd(T);V=V.redIAdd(V),V=V.redIAdd(V),r=Q.redISub(R).redISub(R),t=$.redMul(R.redISub(r)).redISub(V),e=this.y.redMul(this.z),e=e.redIAdd(e)}return this.curve.jpoint(r,t,e)},tr.prototype._threeDbl=function(){var r,t,e;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),h=this.x.redAdd(s).redSqr().redISub(n).redISub(a);h=h.redIAdd(h);var u=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),f=u.redSqr().redISub(h).redISub(h);r=f;var y=a.redIAdd(a);y=y.redIAdd(y),y=y.redIAdd(y),t=u.redMul(h.redISub(f)).redISub(y),e=this.y.redAdd(this.y)}else{var A=this.z.redSqr(),x=this.y.redSqr(),T=this.x.redMul(x),R=this.x.redSub(A).redMul(this.x.redAdd(A));R=R.redAdd(R).redIAdd(R);var $=T.redIAdd(T);$=$.redIAdd($);var Q=$.redAdd($);r=R.redSqr().redISub(Q),e=this.y.redAdd(this.z).redSqr().redISub(x).redISub(A);var V=x.redSqr();V=V.redIAdd(V),V=V.redIAdd(V),V=V.redIAdd(V),t=R.redMul($.redISub(r)).redISub(V)}return this.curve.jpoint(r,t,e)},tr.prototype._dbl=function(){var r=this.curve.a,t=this.x,e=this.y,n=this.z,s=n.redSqr().redSqr(),a=t.redSqr(),h=e.redSqr(),u=a.redAdd(a).redIAdd(a).redIAdd(r.redMul(s)),f=t.redAdd(t);f=f.redIAdd(f);var y=f.redMul(h),A=u.redSqr().redISub(y.redAdd(y)),x=y.redISub(A),T=h.redSqr();T=T.redIAdd(T),T=T.redIAdd(T),T=T.redIAdd(T);var R=u.redMul(x).redISub(T),$=e.redAdd(e).redMul(n);return this.curve.jpoint(A,R,$)},tr.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var r=this.x.redSqr(),t=this.y.redSqr(),e=this.z.redSqr(),n=t.redSqr(),s=r.redAdd(r).redIAdd(r),a=s.redSqr(),h=this.x.redAdd(t).redSqr().redISub(r).redISub(n);h=h.redIAdd(h),h=h.redAdd(h).redIAdd(h),h=h.redISub(a);var u=h.redSqr(),f=n.redIAdd(n);f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f);var y=s.redIAdd(h).redSqr().redISub(a).redISub(u).redISub(f),A=t.redMul(y);A=A.redIAdd(A),A=A.redIAdd(A);var x=this.x.redMul(u).redISub(A);x=x.redIAdd(x),x=x.redIAdd(x);var T=this.y.redMul(y.redMul(f.redISub(y)).redISub(h.redMul(u)));T=T.redIAdd(T),T=T.redIAdd(T),T=T.redIAdd(T);var R=this.z.redAdd(h).redSqr().redISub(e).redISub(u);return this.curve.jpoint(x,T,R)},tr.prototype.mul=function(r,t){return r=new Zt(r,t),this.curve._wnafMul(this,r)},tr.prototype.eq=function(r){if(r.type==="affine")return this.eq(r.toJ());if(this===r)return!0;var t=this.z.redSqr(),e=r.z.redSqr();if(this.x.redMul(e).redISub(r.x.redMul(t)).cmpn(0)!==0)return!1;var n=t.redMul(this.z),s=e.redMul(r.z);return this.y.redMul(s).redISub(r.y.redMul(n)).cmpn(0)===0},tr.prototype.eqXToP=function(r){var t=this.z.redSqr(),e=r.toRed(this.curve.red).redMul(t);if(this.x.cmp(e)===0)return!0;for(var n=r.clone(),s=this.curve.redN.redMul(t);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(s),this.x.cmp(e)===0)return!0}},tr.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},tr.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Ta=Ss(function(r,t){var e=t;e.base=Ln,e.short=I5,e.mont=null,e.edwards=null}),Fa=Ss(function(r,t){var e=t,n=Fr.assert;function s(u){u.type==="short"?this.curve=new Ta.short(u):u.type==="edwards"?this.curve=new Ta.edwards(u):this.curve=new Ta.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,n(this.g.validate(),"Invalid curve"),n(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=s;function a(u,f){Object.defineProperty(e,u,{configurable:!0,enumerable:!0,get:function(){var y=new s(f);return Object.defineProperty(e,u,{configurable:!0,enumerable:!0,value:y}),y}})}a("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:Ii.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),a("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:Ii.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),a("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:Ii.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),a("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:Ii.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),a("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:Ii.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),a("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ii.sha256,gRed:!1,g:["9"]}),a("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:Ii.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var h;try{h=null.crash()}catch{h=void 0}a("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:Ii.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",h]})});function yn(r){if(!(this instanceof yn))return new yn(r);this.hash=r.hash,this.predResist=!!r.predResist,this.outLen=this.hash.outSize,this.minEntropy=r.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=ai.toArray(r.entropy,r.entropyEnc||"hex"),e=ai.toArray(r.nonce,r.nonceEnc||"hex"),n=ai.toArray(r.pers,r.persEnc||"hex");Cu(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,e,n)}var cp=yn;yn.prototype._init=function(r,t,e){var n=r.concat(t).concat(e);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},yn.prototype._hmac=function(){return new Ii.hmac(this.hash,this.K)},yn.prototype._update=function(r){var t=this._hmac().update(this.V).update([0]);r&&(t=t.update(r)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),r&&(this.K=this._hmac().update(this.V).update([1]).update(r).digest(),this.V=this._hmac().update(this.V).digest())},yn.prototype.reseed=function(r,t,e,n){typeof t!="string"&&(n=e,e=t,t=null),r=ai.toArray(r,t),e=ai.toArray(e,n),Cu(r.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(r.concat(e||[])),this._reseed=1},yn.prototype.generate=function(r,t,e,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof t!="string"&&(n=e,e=t,t=null),e&&(e=ai.toArray(e,n||"hex"),this._update(e));for(var s=[];s.length<r;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var a=s.slice(0,r);return this._update(e),this._reseed++,ai.encode(a,t)};var Lh=Fr.assert;function sr(r,t){this.ec=r,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var kh=sr;sr.fromPublic=function(r,t,e){return t instanceof sr?t:new sr(r,{pub:t,pubEnc:e})},sr.fromPrivate=function(r,t,e){return t instanceof sr?t:new sr(r,{priv:t,privEnc:e})},sr.prototype.validate=function(){var r=this.getPublic();return r.isInfinity()?{result:!1,reason:"Invalid public key"}:r.validate()?r.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},sr.prototype.getPublic=function(r,t){return typeof r=="string"&&(t=r,r=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,r):this.pub},sr.prototype.getPrivate=function(r){return r==="hex"?this.priv.toString(16,2):this.priv},sr.prototype._importPrivate=function(r,t){this.priv=new Zt(r,t||16),this.priv=this.priv.umod(this.ec.curve.n)},sr.prototype._importPublic=function(r,t){if(r.x||r.y){this.ec.curve.type==="mont"?Lh(r.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Lh(r.x&&r.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(r.x,r.y);return}this.pub=this.ec.curve.decodePoint(r,t)},sr.prototype.derive=function(r){return r.validate()||Lh(r.validate(),"public point not validated"),r.mul(this.priv).getX()},sr.prototype.sign=function(r,t,e){return this.ec.sign(r,this,t,e)},sr.prototype.verify=function(r,t){return this.ec.verify(r,t,this)},sr.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var S5=Fr.assert;function ec(r,t){if(r instanceof ec)return r;this._importDER(r,t)||(S5(r.r&&r.s,"Signature without r or s"),this.r=new Zt(r.r,16),this.s=new Zt(r.s,16),r.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=r.recoveryParam)}var xa=ec;function x5(){this.place=0}function $h(r,t){var e=r[t.place++];if(!(e&128))return e;var n=e&15;if(n===0||n>4)return!1;for(var s=0,a=0,h=t.place;a<n;a++,h++)s<<=8,s|=r[h],s>>>=0;return s<=127?!1:(t.place=h,s)}function hp(r){for(var t=0,e=r.length-1;!r[t]&&!(r[t+1]&128)&&t<e;)t++;return t===0?r:r.slice(t)}ec.prototype._importDER=function(r,t){r=Fr.toArray(r,t);var e=new x5;if(r[e.place++]!==48)return!1;var n=$h(r,e);if(n===!1||n+e.place!==r.length||r[e.place++]!==2)return!1;var s=$h(r,e);if(s===!1)return!1;var a=r.slice(e.place,s+e.place);if(e.place+=s,r[e.place++]!==2)return!1;var h=$h(r,e);if(h===!1||r.length!==h+e.place)return!1;var u=r.slice(e.place,h+e.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(u[0]===0)if(u[1]&128)u=u.slice(1);else return!1;return this.r=new Zt(a),this.s=new Zt(u),this.recoveryParam=null,!0};function jh(r,t){if(t<128){r.push(t);return}var e=1+(Math.log(t)/Math.LN2>>>3);for(r.push(e|128);--e;)r.push(t>>>(e<<3)&255);r.push(t)}ec.prototype.toDER=function(r){var t=this.r.toArray(),e=this.s.toArray();for(t[0]&128&&(t=[0].concat(t)),e[0]&128&&(e=[0].concat(e)),t=hp(t),e=hp(e);!e[0]&&!(e[1]&128);)e=e.slice(1);var n=[2];jh(n,t.length),n=n.concat(t),n.push(2),jh(n,e.length);var s=n.concat(e),a=[48];return jh(a,s.length),a=a.concat(s),Fr.encode(a,r)};var M5=function(){throw new Error("unsupported")},lg=Fr.assert;function Qr(r){if(!(this instanceof Qr))return new Qr(r);typeof r=="string"&&(lg(Object.prototype.hasOwnProperty.call(Fa,r),"Unknown curve "+r),r=Fa[r]),r instanceof Fa.PresetCurve&&(r={curve:r}),this.curve=r.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=r.curve.g,this.g.precompute(r.curve.n.bitLength()+1),this.hash=r.hash||r.curve.hash}var P5=Qr;Qr.prototype.keyPair=function(r){return new kh(this,r)},Qr.prototype.keyFromPrivate=function(r,t){return kh.fromPrivate(this,r,t)},Qr.prototype.keyFromPublic=function(r,t){return kh.fromPublic(this,r,t)},Qr.prototype.genKeyPair=function(r){r||(r={});for(var t=new cp({hash:this.hash,pers:r.pers,persEnc:r.persEnc||"utf8",entropy:r.entropy||M5(this.hash.hmacStrength),entropyEnc:r.entropy&&r.entropyEnc||"utf8",nonce:this.n.toArray()}),e=this.n.byteLength(),n=this.n.sub(new Zt(2));;){var s=new Zt(t.generate(e));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}},Qr.prototype._truncateToN=function(r,t){var e=r.byteLength()*8-this.n.bitLength();return e>0&&(r=r.ushrn(e)),!t&&r.cmp(this.n)>=0?r.sub(this.n):r},Qr.prototype.sign=function(r,t,e,n){typeof e=="object"&&(n=e,e=null),n||(n={}),t=this.keyFromPrivate(t,e),r=this._truncateToN(new Zt(r,16));for(var s=this.n.byteLength(),a=t.getPrivate().toArray("be",s),h=r.toArray("be",s),u=new cp({hash:this.hash,entropy:a,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),f=this.n.sub(new Zt(1)),y=0;;y++){var A=n.k?n.k(y):new Zt(u.generate(this.n.byteLength()));if(A=this._truncateToN(A,!0),!(A.cmpn(1)<=0||A.cmp(f)>=0)){var x=this.g.mul(A);if(!x.isInfinity()){var T=x.getX(),R=T.umod(this.n);if(R.cmpn(0)!==0){var $=A.invm(this.n).mul(R.mul(t.getPrivate()).iadd(r));if($=$.umod(this.n),$.cmpn(0)!==0){var Q=(x.getY().isOdd()?1:0)|(T.cmp(R)!==0?2:0);return n.canonical&&$.cmp(this.nh)>0&&($=this.n.sub($),Q^=1),new xa({r:R,s:$,recoveryParam:Q})}}}}}},Qr.prototype.verify=function(r,t,e,n){r=this._truncateToN(new Zt(r,16)),e=this.keyFromPublic(e,n),t=new xa(t,"hex");var s=t.r,a=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var h=a.invm(this.n),u=h.mul(r).umod(this.n),f=h.mul(s).umod(this.n),y;return this.curve._maxwellTrick?(y=this.g.jmulAdd(u,e.getPublic(),f),y.isInfinity()?!1:y.eqXToP(s)):(y=this.g.mulAdd(u,e.getPublic(),f),y.isInfinity()?!1:y.getX().umod(this.n).cmp(s)===0)},Qr.prototype.recoverPubKey=function(r,t,e,n){lg((3&e)===e,"The recovery param is more than two bits"),t=new xa(t,n);var s=this.n,a=new Zt(r),h=t.r,u=t.s,f=e&1,y=e>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&y)throw new Error("Unable to find sencond key candinate");y?h=this.curve.pointFromX(h.add(this.curve.n),f):h=this.curve.pointFromX(h,f);var A=t.r.invm(s),x=s.sub(a).mul(A).umod(s),T=u.mul(A).umod(s);return this.g.mulAdd(x,h,T)},Qr.prototype.getKeyRecoveryParam=function(r,t,e,n){if(t=new xa(t,n),t.recoveryParam!==null)return t.recoveryParam;for(var s=0;s<4;s++){var a;try{a=this.recoverPubKey(r,t,s)}catch{continue}if(a.eq(e))return s}throw new Error("Unable to find valid recovery factor")};var C5=Ss(function(r,t){var e=t;e.version="6.5.4",e.utils=Fr,e.rand=function(){throw new Error("unsupported")},e.curve=Ta,e.curves=Fa,e.ec=P5,e.eddsa=null}),N5=C5.ec;const R5="signing-key/5.7.0",au=new er(R5);let zh=null;function mn(){return zh||(zh=new N5("secp256k1")),zh}class O5{constructor(t){eo(this,"curve","secp256k1"),eo(this,"privateKey",Ar(t)),p3(this.privateKey)!==32&&au.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");const e=mn().keyFromPrivate(Le(this.privateKey));eo(this,"publicKey","0x"+e.getPublic(!1,"hex")),eo(this,"compressedPublicKey","0x"+e.getPublic(!0,"hex")),eo(this,"_isSigningKey",!0)}_addPoint(t){const e=mn().keyFromPublic(Le(this.publicKey)),n=mn().keyFromPublic(Le(t));return"0x"+e.pub.add(n.pub).encodeCompressed("hex")}signDigest(t){const e=mn().keyFromPrivate(Le(this.privateKey)),n=Le(t);n.length!==32&&au.throwArgumentError("bad digest length","digest",t);const s=e.sign(n,{canonical:!0});return q0({recoveryParam:s.recoveryParam,r:Ci("0x"+s.r.toString(16),32),s:Ci("0x"+s.s.toString(16),32)})}computeSharedSecret(t){const e=mn().keyFromPrivate(Le(this.privateKey)),n=mn().keyFromPublic(Le(fg(t)));return Ci("0x"+e.derive(n.getPublic()).toString(16),32)}static isSigningKey(t){return!!(t&&t._isSigningKey)}}function T5(r,t){const e=q0(t),n={r:Le(e.r),s:Le(e.s)};return"0x"+mn().recoverPubKey(Le(r),n,e.recoveryParam).encode("hex",!1)}function fg(r,t){const e=Le(r);return e.length===32?new O5(e).publicKey:e.length===33?"0x"+mn().keyFromPublic(e).getPublic(!1,"hex"):e.length===65?Ar(e):au.throwArgumentError("invalid public or private key","key","[REDACTED]")}var up;(function(r){r[r.legacy=0]="legacy",r[r.eip2930=1]="eip2930",r[r.eip1559=2]="eip1559"})(up||(up={}));function F5(r){const t=fg(r);return K3(Yd(xu(Yd(t,1)),12))}function D5(r,t){return F5(T5(Le(r),t))}const q5="https://rpc.walletconnect.org/v1";async function U5(r,t,e,n,s,a){switch(e.t){case"eip191":return B5(r,t,e.s);case"eip1271":return await L5(r,t,e.s,n,s,a);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${e.t}`)}}function B5(r,t,e){return D5(K0(t),e).toLowerCase()===r.toLowerCase()}async function L5(r,t,e,n,s,a){try{const h="0x1626ba7e",u="0000000000000000000000000000000000000000000000000000000000000040",f="0000000000000000000000000000000000000000000000000000000000000041",y=e.substring(2),A=K0(t).substring(2),x=h+A+u+f+y,T=await fetch(`${a||q5}/?chainId=${n}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:k5(),jsonrpc:"2.0",method:"eth_call",params:[{to:r,data:x},"latest"]})}),{result:R}=await T.json();return R?R.slice(0,h.length).toLowerCase()===h.toLowerCase():!1}catch(h){return console.error("isValidEip1271Signature: ",h),!1}}function k5(){return Date.now()+Math.floor(Math.random()*1e3)}var $5=Object.defineProperty,j5=Object.defineProperties,z5=Object.getOwnPropertyDescriptors,lp=Object.getOwnPropertySymbols,H5=Object.prototype.hasOwnProperty,K5=Object.prototype.propertyIsEnumerable,fp=(r,t,e)=>t in r?$5(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,V5=(r,t)=>{for(var e in t||(t={}))H5.call(t,e)&&fp(r,e,t[e]);if(lp)for(var e of lp(t))K5.call(t,e)&&fp(r,e,t[e]);return r},G5=(r,t)=>j5(r,z5(t));const Q5="did:pkh:",Ru=r=>r==null?void 0:r.split(":"),dg=r=>{const t=r&&Ru(r);if(t)return r.includes(Q5)?t[3]:t[1]},dp=r=>{const t=r&&Ru(r);if(t)return t[2]+":"+t[3]},Ga=r=>{const t=r&&Ru(r);if(t)return t.pop()};async function pp(r){const{cacao:t,projectId:e}=r,{s:n,p:s}=t,a=pg(s,s.iss),h=Ga(s.iss);return await U5(h,a,n,dg(s.iss),e)}const pg=(r,t)=>{const e=`${r.domain} wants you to sign in with your Ethereum account:`,n=Ga(t);if(!r.aud&&!r.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let s=r.statement||void 0;const a=`URI: ${r.aud||r.uri}`,h=`Version: ${r.version}`,u=`Chain ID: ${dg(t)}`,f=`Nonce: ${r.nonce}`,y=`Issued At: ${r.iat}`,A=r.exp?`Expiration Time: ${r.exp}`:void 0,x=r.nbf?`Not Before: ${r.nbf}`:void 0,T=r.requestId?`Request ID: ${r.requestId}`:void 0,R=r.resources?`Resources:${r.resources.map(Q=>`
- ${Q}`).join("")}`:void 0,$=Da(r.resources);if($){const Q=_o($);s=iA(s,Q)}return[e,n,"",s,"",a,h,u,f,y,A,x,T,R].filter(Q=>Q!=null).join(`
`)};function J5(r){return Buffer.from(JSON.stringify(r)).toString("base64")}function Y5(r){return JSON.parse(Buffer.from(r,"base64").toString("utf-8"))}function Un(r){if(!r)throw new Error("No recap provided, value is undefined");if(!r.att)throw new Error("No `att` property found");const t=Object.keys(r.att);if(!(t!=null&&t.length))throw new Error("No resources found in `att` property");t.forEach(e=>{const n=r.att[e];if(Array.isArray(n))throw new Error(`Resource must be an object: ${e}`);if(typeof n!="object")throw new Error(`Resource must be an object: ${e}`);if(!Object.keys(n).length)throw new Error(`Resource object is empty: ${e}`);Object.keys(n).forEach(s=>{const a=n[s];if(!Array.isArray(a))throw new Error(`Ability limits ${s} must be an array of objects, found: ${a}`);if(!a.length)throw new Error(`Value of ${s} is empty array, must be an array with objects`);a.forEach(h=>{if(typeof h!="object")throw new Error(`Ability limits (${s}) must be an array of objects, found: ${h}`)})})})}function W5(r,t,e,n={}){return e==null||e.sort((s,a)=>s.localeCompare(a)),{att:{[r]:X5(t,e,n)}}}function X5(r,t,e={}){t=t==null?void 0:t.sort((s,a)=>s.localeCompare(a));const n=t.map(s=>({[`${r}/${s}`]:[e]}));return Object.assign({},...n)}function gg(r){return Un(r),`urn:recap:${J5(r).replace(/=/g,"")}`}function _o(r){const t=Y5(r.replace("urn:recap:",""));return Un(t),t}function Z5(r,t,e){const n=W5(r,t,e);return gg(n)}function tA(r){return r&&r.includes("urn:recap:")}function eA(r,t){const e=_o(r),n=_o(t),s=rA(e,n);return gg(s)}function rA(r,t){Un(r),Un(t);const e=Object.keys(r.att).concat(Object.keys(t.att)).sort((s,a)=>s.localeCompare(a)),n={att:{}};return e.forEach(s=>{var a,h;Object.keys(((a=r.att)==null?void 0:a[s])||{}).concat(Object.keys(((h=t.att)==null?void 0:h[s])||{})).sort((u,f)=>u.localeCompare(f)).forEach(u=>{var f,y;n.att[s]=G5(V5({},n.att[s]),{[u]:((f=r.att[s])==null?void 0:f[u])||((y=t.att[s])==null?void 0:y[u])})})}),n}function iA(r="",t){Un(t);const e="I further authorize the stated URI to perform the following actions on my behalf: ";if(r.includes(e))return r;const n=[];let s=0;Object.keys(t.att).forEach(u=>{const f=Object.keys(t.att[u]).map(x=>({ability:x.split("/")[0],action:x.split("/")[1]}));f.sort((x,T)=>x.action.localeCompare(T.action));const y={};f.forEach(x=>{y[x.ability]||(y[x.ability]=[]),y[x.ability].push(x.action)});const A=Object.keys(y).map(x=>(s++,`(${s}) '${x}': '${y[x].join("', '")}' for '${u}'.`));n.push(A.join(", ").replace(".,","."))});const a=n.join(" "),h=`${e}${a}`;return`${r?r+" ":""}${h}`}function gp(r){var t;const e=_o(r);Un(e);const n=(t=e.att)==null?void 0:t.eip155;return n?Object.keys(n).map(s=>s.split("/")[1]):[]}function mp(r){const t=_o(r);Un(t);const e=[];return Object.values(t.att).forEach(n=>{Object.values(n).forEach(s=>{var a;(a=s==null?void 0:s[0])!=null&&a.chains&&e.push(s[0].chains)})}),[...new Set(e.flat())]}function Da(r){if(!r)return;const t=r==null?void 0:r[r.length-1];return tA(t)?t:void 0}const mg="base10",pr="base16",wn="base64pad",no="base64url",No="utf8",vg=0,tn=1,Ro=2,nA=0,vp=1,yo=12,Ou=32;function sA(){const r=v0.generateKeyPair();return{privateKey:Er(r.secretKey,pr),publicKey:Er(r.publicKey,pr)}}function cu(){const r=xo.randomBytes(Ou);return Er(r,pr)}function oA(r,t){const e=v0.sharedKey(Yr(r,pr),Yr(t,pr),!0),n=new y6.HKDF(Xa.SHA256,e).expand(Ou);return Er(n,pr)}function qa(r){const t=Xa.hash(Yr(r,pr));return Er(t,pr)}function Wi(r){const t=Xa.hash(Yr(r,No));return Er(t,pr)}function yg(r){return Yr(`${r}`,mg)}function Bn(r){return Number(Er(r,mg))}function aA(r){const t=yg(typeof r.type<"u"?r.type:vg);if(Bn(t)===tn&&typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const e=typeof r.senderPublicKey<"u"?Yr(r.senderPublicKey,pr):void 0,n=typeof r.iv<"u"?Yr(r.iv,pr):xo.randomBytes(yo),s=new m0.ChaCha20Poly1305(Yr(r.symKey,pr)).seal(n,Yr(r.message,No));return wg({type:t,sealed:s,iv:n,senderPublicKey:e,encoding:r.encoding})}function cA(r,t){const e=yg(Ro),n=xo.randomBytes(yo),s=Yr(r,No);return wg({type:e,sealed:s,iv:n,encoding:t})}function hA(r){const t=new m0.ChaCha20Poly1305(Yr(r.symKey,pr)),{sealed:e,iv:n}=Ao({encoded:r.encoded,encoding:r==null?void 0:r.encoding}),s=t.open(n,e);if(s===null)throw new Error("Failed to decrypt");return Er(s,No)}function uA(r,t){const{sealed:e}=Ao({encoded:r,encoding:t});return Er(e,No)}function wg(r){const{encoding:t=wn}=r;if(Bn(r.type)===Ro)return Er(ph([r.type,r.sealed]),t);if(Bn(r.type)===tn){if(typeof r.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Er(ph([r.type,r.senderPublicKey,r.iv,r.sealed]),t)}return Er(ph([r.type,r.iv,r.sealed]),t)}function Ao(r){const{encoded:t,encoding:e=wn}=r,n=Yr(t,e),s=n.slice(nA,vp),a=vp;if(Bn(s)===tn){const y=a+Ou,A=y+yo,x=n.slice(a,y),T=n.slice(y,A),R=n.slice(A);return{type:s,sealed:R,iv:T,senderPublicKey:x}}if(Bn(s)===Ro){const y=n.slice(a),A=xo.randomBytes(yo);return{type:s,sealed:y,iv:A}}const h=a+yo,u=n.slice(a,h),f=n.slice(h);return{type:s,sealed:f,iv:u}}function lA(r,t){const e=Ao({encoded:r,encoding:t==null?void 0:t.encoding});return bg({type:Bn(e.type),senderPublicKey:typeof e.senderPublicKey<"u"?Er(e.senderPublicKey,pr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function bg(r){const t=(r==null?void 0:r.type)||vg;if(t===tn){if(typeof(r==null?void 0:r.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(r==null?void 0:r.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:r==null?void 0:r.senderPublicKey,receiverPublicKey:r==null?void 0:r.receiverPublicKey}}function yp(r){return r.type===tn&&typeof r.senderPublicKey=="string"&&typeof r.receiverPublicKey=="string"}function wp(r){return r.type===Ro}function fA(r){return new Yb.ec("p256").keyFromPublic({x:Buffer.from(r.x,"base64").toString("hex"),y:Buffer.from(r.y,"base64").toString("hex")},"hex")}function dA(r){let t=r.replace(/-/g,"+").replace(/_/g,"/");const e=t.length%4;return e>0&&(t+="=".repeat(4-e)),t}function pA(r){return Buffer.from(dA(r),"base64")}function gA(r,t){const[e,n,s]=r.split("."),a=pA(s);if(a.length!==64)throw new Error("Invalid signature length");const h=a.slice(0,32).toString("hex"),u=a.slice(32,64).toString("hex"),f=`${e}.${n}`,y=new Xa.SHA256().update(Buffer.from(f)).digest(),A=fA(t),x=Buffer.from(y).toString("hex");if(!A.verify(x,{r:h,s:u}))throw new Error("Invalid signature");return eu(r).payload}const mA="irn";function hu(r){return(r==null?void 0:r.relay)||{protocol:mA}}function fo(r){const t=Jb[r];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${r}`);return t}var vA=Object.defineProperty,yA=Object.defineProperties,wA=Object.getOwnPropertyDescriptors,bp=Object.getOwnPropertySymbols,bA=Object.prototype.hasOwnProperty,_A=Object.prototype.propertyIsEnumerable,_p=(r,t,e)=>t in r?vA(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ap=(r,t)=>{for(var e in t||(t={}))bA.call(t,e)&&_p(r,e,t[e]);if(bp)for(var e of bp(t))_A.call(t,e)&&_p(r,e,t[e]);return r},AA=(r,t)=>yA(r,wA(t));function EA(r,t="-"){const e={},n="relay"+t;return Object.keys(r).forEach(s=>{if(s.startsWith(n)){const a=s.replace(n,""),h=r[s];e[a]=h}}),e}function Ep(r){if(!r.includes("wc:")){const f=O0(r);f!=null&&f.includes("wc:")&&(r=f)}r=r.includes("wc://")?r.replace("wc://",""):r,r=r.includes("wc:")?r.replace("wc:",""):r;const t=r.indexOf(":"),e=r.indexOf("?")!==-1?r.indexOf("?"):void 0,n=r.substring(0,t),s=r.substring(t+1,e).split("@"),a=typeof e<"u"?r.substring(e):"",h=La.parse(a),u=typeof h.methods=="string"?h.methods.split(","):void 0;return{protocol:n,topic:IA(s[0]),version:parseInt(s[1],10),symKey:h.symKey,relay:EA(h),methods:u,expiryTimestamp:h.expiryTimestamp?parseInt(h.expiryTimestamp,10):void 0}}function IA(r){return r.startsWith("//")?r.substring(2):r}function SA(r,t="-"){const e="relay",n={};return Object.keys(r).forEach(s=>{const a=e+t+s;r[s]&&(n[a]=r[s])}),n}function Ip(r){return`${r.protocol}:${r.topic}@${r.version}?`+La.stringify(Ap(AA(Ap({symKey:r.symKey},SA(r.relay)),{expiryTimestamp:r.expiryTimestamp}),r.methods?{methods:r.methods.join(",")}:{}))}function Ma(r,t,e){return`${r}?wc_ev=${e}&topic=${t}`}function xs(r){const t=[];return r.forEach(e=>{const[n,s]=e.split(":");t.push(`${n}:${s}`)}),t}function xA(r){const t=[];return Object.values(r).forEach(e=>{t.push(...xs(e.accounts))}),t}function MA(r,t){const e=[];return Object.values(r).forEach(n=>{xs(n.accounts).includes(t)&&e.push(...n.methods)}),e}function PA(r,t){const e=[];return Object.values(r).forEach(n=>{xs(n.accounts).includes(t)&&e.push(...n.events)}),e}function Tu(r){return r.includes(":")}function po(r){return Tu(r)?r.split(":")[0]:r}function CA(r){const t={};return r==null||r.forEach(e=>{const[n,s]=e.split(":");t[n]||(t[n]={accounts:[],chains:[],events:[]}),t[n].accounts.push(e),t[n].chains.push(`${n}:${s}`)}),t}function Sp(r,t){t=t.map(n=>n.replace("did:pkh:",""));const e=CA(t);for(const[n,s]of Object.entries(e))s.methods?s.methods=Ra(s.methods,r):s.methods=r,s.events=["chainChanged","accountsChanged"];return e}const NA={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},RA={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ft(r,t){const{message:e,code:n}=RA[r];return{message:t?`${e} ${t}`:e,code:n}}function be(r,t){const{message:e,code:n}=NA[r];return{message:t?`${e} ${t}`:e,code:n}}function Ti(r,t){return!!Array.isArray(r)}function Eo(r){return Object.getPrototypeOf(r)===Object.prototype&&Object.keys(r).length}function dr(r){return typeof r>"u"}function ze(r,t){return t&&dr(r)?!0:typeof r=="string"&&!!r.trim().length}function Fu(r,t){return t&&dr(r)?!0:typeof r=="number"&&!isNaN(r)}function OA(r,t){const{requiredNamespaces:e}=t,n=Object.keys(r.namespaces),s=Object.keys(e);let a=!0;return Dn(s,n)?(n.forEach(h=>{const{accounts:u,methods:f,events:y}=r.namespaces[h],A=xs(u),x=e[h];(!Dn(S0(h,x),A)||!Dn(x.methods,f)||!Dn(x.events,y))&&(a=!1)}),a):!1}function Qa(r){return ze(r,!1)&&r.includes(":")?r.split(":").length===2:!1}function TA(r){if(ze(r,!1)&&r.includes(":")){const t=r.split(":");if(t.length===3){const e=t[0]+":"+t[1];return!!t[2]&&Qa(e)}}return!1}function FA(r){function t(e){try{return typeof new URL(e)<"u"}catch{return!1}}try{if(ze(r,!1)){if(t(r))return!0;const e=O0(r);return t(e)}}catch{}return!1}function DA(r){var t;return(t=r==null?void 0:r.proposer)==null?void 0:t.publicKey}function qA(r){return r==null?void 0:r.topic}function UA(r,t){let e=null;return ze(r==null?void 0:r.publicKey,!1)||(e=ft("MISSING_OR_INVALID",`${t} controller public key should be a string`)),e}function xp(r){let t=!0;return Ti(r)?r.length&&(t=r.every(e=>ze(e,!1))):t=!1,t}function BA(r,t,e){let n=null;return Ti(t)&&t.length?t.forEach(s=>{n||Qa(s)||(n=be("UNSUPPORTED_CHAINS",`${e}, chain ${s} should be a string and conform to "namespace:chainId" format`))}):Qa(r)||(n=be("UNSUPPORTED_CHAINS",`${e}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function LA(r,t,e){let n=null;return Object.entries(r).forEach(([s,a])=>{if(n)return;const h=BA(s,S0(s,a),`${t} ${e}`);h&&(n=h)}),n}function kA(r,t){let e=null;return Ti(r)?r.forEach(n=>{e||TA(n)||(e=be("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):e=be("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),e}function $A(r,t){let e=null;return Object.values(r).forEach(n=>{if(e)return;const s=kA(n==null?void 0:n.accounts,`${t} namespace`);s&&(e=s)}),e}function jA(r,t){let e=null;return xp(r==null?void 0:r.methods)?xp(r==null?void 0:r.events)||(e=be("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):e=be("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),e}function _g(r,t){let e=null;return Object.values(r).forEach(n=>{if(e)return;const s=jA(n,`${t}, namespace`);s&&(e=s)}),e}function zA(r,t,e){let n=null;if(r&&Eo(r)){const s=_g(r,t);s&&(n=s);const a=LA(r,t,e);a&&(n=a)}else n=ft("MISSING_OR_INVALID",`${t}, ${e} should be an object with data`);return n}function Hh(r,t){let e=null;if(r&&Eo(r)){const n=_g(r,t);n&&(e=n);const s=$A(r,t);s&&(e=s)}else e=ft("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return e}function Ag(r){return ze(r.protocol,!0)}function HA(r,t){let e=!1;return r?r&&Ti(r)&&r.length&&r.forEach(n=>{e=Ag(n)}):e=!0,e}function KA(r){return typeof r=="number"}function _r(r){return typeof r<"u"&&typeof r!==null}function VA(r){return!(!r||typeof r!="object"||!r.code||!Fu(r.code,!1)||!r.message||!ze(r.message,!1))}function GA(r){return!(dr(r)||!ze(r.method,!1))}function QA(r){return!(dr(r)||dr(r.result)&&dr(r.error)||!Fu(r.id,!1)||!ze(r.jsonrpc,!1))}function JA(r){return!(dr(r)||!ze(r.name,!1))}function Mp(r,t){return!(!Qa(t)||!xA(r).includes(t))}function YA(r,t,e){return ze(e,!1)?MA(r,t).includes(e):!1}function WA(r,t,e){return ze(e,!1)?PA(r,t).includes(e):!1}function Pp(r,t,e){let n=null;const s=XA(r),a=ZA(t),h=Object.keys(s),u=Object.keys(a),f=Cp(Object.keys(r)),y=Cp(Object.keys(t)),A=f.filter(x=>!y.includes(x));return A.length&&(n=ft("NON_CONFORMING_NAMESPACES",`${e} namespaces keys don't satisfy requiredNamespaces.
      Required: ${A.toString()}
      Received: ${Object.keys(t).toString()}`)),Dn(h,u)||(n=ft("NON_CONFORMING_NAMESPACES",`${e} namespaces chains don't satisfy required namespaces.
      Required: ${h.toString()}
      Approved: ${u.toString()}`)),Object.keys(t).forEach(x=>{if(!x.includes(":")||n)return;const T=xs(t[x].accounts);T.includes(x)||(n=ft("NON_CONFORMING_NAMESPACES",`${e} namespaces accounts don't satisfy namespace accounts for ${x}
        Required: ${x}
        Approved: ${T.toString()}`))}),h.forEach(x=>{n||(Dn(s[x].methods,a[x].methods)?Dn(s[x].events,a[x].events)||(n=ft("NON_CONFORMING_NAMESPACES",`${e} namespaces events don't satisfy namespace events for ${x}`)):n=ft("NON_CONFORMING_NAMESPACES",`${e} namespaces methods don't satisfy namespace methods for ${x}`))}),n}function XA(r){const t={};return Object.keys(r).forEach(e=>{var n;e.includes(":")?t[e]=r[e]:(n=r[e].chains)==null||n.forEach(s=>{t[s]={methods:r[e].methods,events:r[e].events}})}),t}function Cp(r){return[...new Set(r.map(t=>t.includes(":")?t.split(":")[0]:t))]}function ZA(r){const t={};return Object.keys(r).forEach(e=>{if(e.includes(":"))t[e]=r[e];else{const n=xs(r[e].accounts);n==null||n.forEach(s=>{t[s]={accounts:r[e].accounts.filter(a=>a.includes(`${s}:`)),methods:r[e].methods,events:r[e].events}})}}),t}function tE(r,t){return Fu(r,!1)&&r<=t.max&&r>=t.min}function Np(){const r=Po();return new Promise(t=>{switch(r){case Or.browser:t(eE());break;case Or.reactNative:t(rE());break;case Or.node:t(iE());break;default:t(!0)}})}function eE(){return Mo()&&(navigator==null?void 0:navigator.onLine)}async function rE(){if(_s()&&typeof global<"u"&&global!=null&&global.NetInfo){const r=await(global==null?void 0:global.NetInfo.fetch());return r==null?void 0:r.isConnected}return!0}function iE(){return!0}function nE(r){switch(Po()){case Or.browser:sE(r);break;case Or.reactNative:oE(r);break}}function sE(r){!_s()&&Mo()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)))}function oE(r){_s()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>r(t==null?void 0:t.isConnected)))}const Kh={};class so{static get(t){return Kh[t]}static set(t,e){Kh[t]=e}static delete(t){delete Kh[t]}}class aE extends ws{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let cE=class extends ws{constructor(t,e){super(),this.core=t,this.logger=e,this.records=new Map}},hE=class{constructor(t,e){this.logger=t,this.core=e}},uE=class extends ws{constructor(t,e){super(),this.relayer=t,this.logger=e}},lE=class extends ws{constructor(t){super()}},fE=class{constructor(t,e,n,s){this.core=t,this.logger=e,this.name=n}};class dE extends ws{constructor(t,e){super(),this.relayer=t,this.logger=e}}let pE=class extends ws{constructor(t,e){super(),this.core=t,this.logger=e}},gE=class{constructor(t,e,n){this.core=t,this.logger=e,this.store=n}},mE=class{constructor(t,e){this.projectId=t,this.logger=e}},vE=class{constructor(t,e,n){this.core=t,this.logger=e,this.telemetryEnabled=n}},yE=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},wE=class{constructor(t){this.client=t}};const bE=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),_E=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Rp=r=>r.split("?")[0],Op=10,AE=bE();class EE{constructor(t){if(this.url=t,this.events=new en.EventEmitter,this.registering=!1,!ud(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,e)=>{if(typeof this.socket>"u"){e(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(mu(t))}catch(e){this.onError(t.id,e)}}register(t=this.url){if(!ud(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((n,s)=>{this.events.once("register_error",a=>{this.resetMaxListeners(),s(a)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return s(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((e,n)=>{const s=new URLSearchParams(t).get("origin"),a=Xb.isReactNative()?{headers:{origin:s}}:{rejectUnauthorized:!Zb(t)},h=new AE(t,[],a);_E()?h.onerror=u=>{const f=u;n(this.emitError(f.error))}:h.on("error",u=>{n(this.emitError(u))}),h.onopen=()=>{this.onOpen(h),e(h)}})}onOpen(t){t.onmessage=e=>this.onPayload(e),t.onclose=e=>this.onClose(e),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const e=typeof t.data=="string"?Ba(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const n=this.parseError(e),s=n.message||n.toString(),a=vu(t,s);this.events.emit("payload",a)}parseError(t,e=this.url){return t6(t,Rp(e),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Op&&this.events.setMaxListeners(Op)}emitError(t){const e=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${Rp(this.url)}`));return this.events.emit("register_error",e),e}}const Eg="wc",Ig=2,Sg="core",Fi=`${Eg}@2:${Sg}:`,IE={logger:"error"},SE={database:":memory:"},xE="crypto",Tp="client_ed25519_seed",ME=dt.ONE_DAY,PE="keychain",CE="0.3",NE="messages",RE="0.3",OE=dt.SIX_HOURS,TE="publisher",xg="irn",FE="error",Mg="wss://relay.walletconnect.org",DE="relayer",lr={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},qE="_subscription",Vr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},UE=.1,uu="2.17.0",xe={link_mode:"link_mode",relay:"relay"},BE="0.3",LE="WALLETCONNECT_CLIENT_ID",Fp="WALLETCONNECT_LINK_MODE_APPS",xi={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},kE="subscription",$E="0.3",jE=dt.FIVE_SECONDS*1e3,zE="pairing",HE="0.3",oo={wc_pairingDelete:{req:{ttl:dt.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:dt.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:dt.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:dt.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:dt.ONE_DAY,prompt:!1,tag:0},res:{ttl:dt.ONE_DAY,prompt:!1,tag:0}}},Tn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},ri={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},KE="history",VE="0.3",GE="expirer",Gr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},QE="0.3",JE="verify-api",YE="https://verify.walletconnect.com",Pg="https://verify.walletconnect.org",wo=Pg,WE=`${wo}/v3`,XE=[YE,Pg],ZE="echo",t8="https://echo.walletconnect.com",Ai={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},Ji={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},ii={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},Nn={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},Rn={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},ao={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},e8=.1,r8="event-client",i8=86400,n8="https://pulse.walletconnect.org/batch";function s8(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var s=0;s<r.length;s++){var a=r.charAt(s),h=a.charCodeAt(0);if(e[h]!==255)throw new TypeError(a+" is ambiguous");e[h]=s}var u=r.length,f=r.charAt(0),y=Math.log(u)/Math.log(256),A=Math.log(256)/Math.log(u);function x($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var Q=0,V=0,Z=0,H=$.length;Z!==H&&$[Z]===0;)Z++,Q++;for(var J=(H-Z)*A+1>>>0,B=new Uint8Array(J);Z!==H;){for(var k=$[Z],z=0,w=J-1;(k!==0||z<V)&&w!==-1;w--,z++)k+=256*B[w]>>>0,B[w]=k%u>>>0,k=k/u>>>0;if(k!==0)throw new Error("Non-zero carry");V=z,Z++}for(var q=J-V;q!==J&&B[q]===0;)q++;for(var ht=f.repeat(Q);q<J;++q)ht+=r.charAt(B[q]);return ht}function T($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var Q=0;if($[Q]!==" "){for(var V=0,Z=0;$[Q]===f;)V++,Q++;for(var H=($.length-Q)*y+1>>>0,J=new Uint8Array(H);$[Q];){var B=e[$.charCodeAt(Q)];if(B===255)return;for(var k=0,z=H-1;(B!==0||k<Z)&&z!==-1;z--,k++)B+=u*J[z]>>>0,J[z]=B%256>>>0,B=B/256>>>0;if(B!==0)throw new Error("Non-zero carry");Z=k,Q++}if($[Q]!==" "){for(var w=H-Z;w!==H&&J[w]===0;)w++;for(var q=new Uint8Array(V+(H-w)),ht=V;w!==H;)q[ht++]=J[w++];return q}}}function R($){var Q=T($);if(Q)return Q;throw new Error(`Non-${t} character`)}return{encode:x,decodeUnsafe:T,decode:R}}var o8=s8,a8=o8;const Cg=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},c8=r=>new TextEncoder().encode(r),h8=r=>new TextDecoder().decode(r);class u8{constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class l8{constructor(t,e,n){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Ng(this,t)}}class f8{constructor(t){this.decoders=t}or(t){return Ng(this,t)}decode(t){const e=t[0],n=this.decoders[e];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ng=(r,t)=>new f8({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}});class d8{constructor(t,e,n,s){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=s,this.encoder=new u8(t,e,n),this.decoder=new l8(t,e,s)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const rc=({name:r,prefix:t,encode:e,decode:n})=>new d8(r,t,e,n),Oo=({prefix:r,name:t,alphabet:e})=>{const{encode:n,decode:s}=a8(e,t);return rc({prefix:r,name:t,encode:n,decode:a=>Cg(s(a))})},p8=(r,t,e,n)=>{const s={};for(let A=0;A<t.length;++A)s[t[A]]=A;let a=r.length;for(;r[a-1]==="=";)--a;const h=new Uint8Array(a*e/8|0);let u=0,f=0,y=0;for(let A=0;A<a;++A){const x=s[r[A]];if(x===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<e|x,u+=e,u>=8&&(u-=8,h[y++]=255&f>>u)}if(u>=e||255&f<<8-u)throw new SyntaxError("Unexpected end of data");return h},g8=(r,t,e)=>{const n=t[t.length-1]==="=",s=(1<<e)-1;let a="",h=0,u=0;for(let f=0;f<r.length;++f)for(u=u<<8|r[f],h+=8;h>e;)h-=e,a+=t[s&u>>h];if(h&&(a+=t[s&u<<e-h]),n)for(;a.length*e&7;)a+="=";return a},rr=({name:r,prefix:t,bitsPerChar:e,alphabet:n})=>rc({prefix:t,name:r,encode(s){return g8(s,n,e)},decode(s){return p8(s,n,e,r)}}),m8=rc({prefix:"\0",name:"identity",encode:r=>h8(r),decode:r=>c8(r)});var v8=Object.freeze({__proto__:null,identity:m8});const y8=rr({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var w8=Object.freeze({__proto__:null,base2:y8});const b8=rr({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var _8=Object.freeze({__proto__:null,base8:b8});const A8=Oo({prefix:"9",name:"base10",alphabet:"0123456789"});var E8=Object.freeze({__proto__:null,base10:A8});const I8=rr({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),S8=rr({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var x8=Object.freeze({__proto__:null,base16:I8,base16upper:S8});const M8=rr({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),P8=rr({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),C8=rr({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),N8=rr({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),R8=rr({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),O8=rr({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),T8=rr({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),F8=rr({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),D8=rr({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var q8=Object.freeze({__proto__:null,base32:M8,base32upper:P8,base32pad:C8,base32padupper:N8,base32hex:R8,base32hexupper:O8,base32hexpad:T8,base32hexpadupper:F8,base32z:D8});const U8=Oo({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),B8=Oo({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var L8=Object.freeze({__proto__:null,base36:U8,base36upper:B8});const k8=Oo({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$8=Oo({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var j8=Object.freeze({__proto__:null,base58btc:k8,base58flickr:$8});const z8=rr({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),H8=rr({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),K8=rr({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),V8=rr({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var G8=Object.freeze({__proto__:null,base64:z8,base64pad:H8,base64url:K8,base64urlpad:V8});const Rg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Q8=Rg.reduce((r,t,e)=>(r[e]=t,r),[]),J8=Rg.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function Y8(r){return r.reduce((t,e)=>(t+=Q8[e],t),"")}function W8(r){const t=[];for(const e of r){const n=J8[e.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(n)}return new Uint8Array(t)}const X8=rc({prefix:"🚀",name:"base256emoji",encode:Y8,decode:W8});var Z8=Object.freeze({__proto__:null,base256emoji:X8}),t4=Og,Dp=128,e4=-128,r4=Math.pow(2,31);function Og(r,t,e){t=t||[],e=e||0;for(var n=e;r>=r4;)t[e++]=r&255|Dp,r/=128;for(;r&e4;)t[e++]=r&255|Dp,r>>>=7;return t[e]=r|0,Og.bytes=e-n+1,t}var i4=lu,n4=128,qp=127;function lu(r,n){var e=0,n=n||0,s=0,a=n,h,u=r.length;do{if(a>=u)throw lu.bytes=0,new RangeError("Could not decode varint");h=r[a++],e+=s<28?(h&qp)<<s:(h&qp)*Math.pow(2,s),s+=7}while(h>=n4);return lu.bytes=a-n,e}var s4=Math.pow(2,7),o4=Math.pow(2,14),a4=Math.pow(2,21),c4=Math.pow(2,28),h4=Math.pow(2,35),u4=Math.pow(2,42),l4=Math.pow(2,49),f4=Math.pow(2,56),d4=Math.pow(2,63),p4=function(r){return r<s4?1:r<o4?2:r<a4?3:r<c4?4:r<h4?5:r<u4?6:r<l4?7:r<f4?8:r<d4?9:10},g4={encode:t4,decode:i4,encodingLength:p4},Tg=g4;const Up=(r,t,e=0)=>(Tg.encode(r,t,e),t),Bp=r=>Tg.encodingLength(r),fu=(r,t)=>{const e=t.byteLength,n=Bp(r),s=n+Bp(e),a=new Uint8Array(s+e);return Up(r,a,0),Up(e,a,n),a.set(t,s),new m4(r,e,t,a)};class m4{constructor(t,e,n,s){this.code=t,this.size=e,this.digest=n,this.bytes=s}}const Fg=({name:r,code:t,encode:e})=>new v4(r,t,e);class v4{constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){const e=this.encode(t);return e instanceof Uint8Array?fu(this.code,e):e.then(n=>fu(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Dg=r=>async t=>new Uint8Array(await crypto.subtle.digest(r,t)),y4=Fg({name:"sha2-256",code:18,encode:Dg("SHA-256")}),w4=Fg({name:"sha2-512",code:19,encode:Dg("SHA-512")});var b4=Object.freeze({__proto__:null,sha256:y4,sha512:w4});const qg=0,_4="identity",Ug=Cg,A4=r=>fu(qg,Ug(r)),E4={code:qg,name:_4,encode:Ug,digest:A4};var I4=Object.freeze({__proto__:null,identity:E4});new TextEncoder,new TextDecoder;const Lp={...v8,...w8,..._8,...E8,...x8,...q8,...L8,...j8,...G8,...Z8};({...b4,...I4});function S4(r=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(r):new Uint8Array(r)}function Bg(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}const kp=Bg("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Vh=Bg("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);const t=S4(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),x4={utf8:kp,"utf-8":kp,hex:Lp.base16,latin1:Vh,ascii:Vh,binary:Vh,...Lp};function M4(r,t="utf8"){const e=x4[t];if(!e)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(r,"utf8"):e.decoder.decode(`${e.prefix}${r}`)}class P4{constructor(t,e){this.core=t,this.logger=e,this.keychain=new Map,this.name=PE,this.version=CE,this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,s)=>{this.isInitialized(),this.keychain.set(n,s),await this.persist()},this.get=n=>{this.isInitialized();const s=this.keychain.get(n);if(typeof s>"u"){const{message:a}=ft("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(a)}return s},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=gr(e,this.name)}get context(){return Dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,P0(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?C0(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}}class C4{constructor(t,e,n){this.core=t,this.logger=e,this.name=xE,this.randomSessionIdentifier=cu(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=s=>(this.isInitialized(),this.keychain.has(s)),this.getClientId=async()=>{this.isInitialized();const s=await this.getClientSeed(),a=Ud(s);return I0(a.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const s=sA();return this.setPrivateKey(s.publicKey,s.privateKey)},this.signJWT=async s=>{this.isInitialized();const a=await this.getClientSeed(),h=Ud(a),u=this.randomSessionIdentifier;return await k6(u,s,ME,h)},this.generateSharedKey=(s,a,h)=>{this.isInitialized();const u=this.getPrivateKey(s),f=oA(u,a);return this.setSymKey(f,h)},this.setSymKey=async(s,a)=>{this.isInitialized();const h=a||qa(s);return await this.keychain.set(h,s),h},this.deleteKeyPair=async s=>{this.isInitialized(),await this.keychain.del(s)},this.deleteSymKey=async s=>{this.isInitialized(),await this.keychain.del(s)},this.encode=async(s,a,h)=>{this.isInitialized();const u=bg(h),f=mu(a);if(wp(u))return cA(f,h==null?void 0:h.encoding);if(yp(u)){const T=u.senderPublicKey,R=u.receiverPublicKey;s=await this.generateSharedKey(T,R)}const y=this.getSymKey(s),{type:A,senderPublicKey:x}=u;return aA({type:A,symKey:y,message:f,senderPublicKey:x,encoding:h==null?void 0:h.encoding})},this.decode=async(s,a,h)=>{this.isInitialized();const u=lA(a,h);if(wp(u)){const f=uA(a,h==null?void 0:h.encoding);return Ba(f)}if(yp(u)){const f=u.receiverPublicKey,y=u.senderPublicKey;s=await this.generateSharedKey(f,y)}try{const f=this.getSymKey(s),y=hA({symKey:f,encoded:a,encoding:h==null?void 0:h.encoding});return Ba(y)}catch(f){this.logger.error(`Failed to decode message from topic: '${s}', clientId: '${await this.getClientId()}'`),this.logger.error(f)}},this.getPayloadType=(s,a=wn)=>{const h=Ao({encoded:s,encoding:a});return Bn(h.type)},this.getPayloadSenderPublicKey=(s,a=wn)=>{const h=Ao({encoded:s,encoding:a});return h.senderPublicKey?Er(h.senderPublicKey,pr):void 0},this.core=t,this.logger=gr(e,this.name),this.keychain=n||new P4(this.core,this.logger)}get context(){return Dr(this.logger)}async setPrivateKey(t,e){return await this.keychain.set(t,e),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Tp)}catch{t=cu(),await this.keychain.set(Tp,t)}return M4(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}}class N4 extends hE{constructor(t,e){super(t,e),this.logger=t,this.core=e,this.messages=new Map,this.name=NE,this.version=RE,this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,s)=>{this.isInitialized();const a=Wi(s);let h=this.messages.get(n);return typeof h>"u"&&(h={}),typeof h[a]<"u"||(h[a]=s,this.messages.set(n,h),await this.persist()),a},this.get=n=>{this.isInitialized();let s=this.messages.get(n);return typeof s>"u"&&(s={}),s},this.has=(n,s)=>{this.isInitialized();const a=this.get(n),h=Wi(s);return typeof a[h]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=gr(t,this.name),this.core=e}get context(){return Dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,P0(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?C0(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}}class R4 extends uE{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.events=new en.EventEmitter,this.name=TE,this.queue=new Map,this.publishTimeout=dt.toMiliseconds(dt.ONE_MINUTE),this.failedPublishTimeout=dt.toMiliseconds(dt.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(n,s,a)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:s,opts:a}});const u=(a==null?void 0:a.ttl)||OE,f=hu(a),y=(a==null?void 0:a.prompt)||!1,A=(a==null?void 0:a.tag)||0,x=(a==null?void 0:a.id)||fs().toString(),T={topic:n,message:s,opts:{ttl:u,relay:f,prompt:y,tag:A,id:x,attestation:a==null?void 0:a.attestation}},R=`Failed to publish payload, please try again. id:${x} tag:${A}`,$=Date.now();let Q,V=1;try{for(;Q===void 0;){if(Date.now()-$>this.publishTimeout)throw new Error(R);this.logger.trace({id:x,attempts:V},`publisher.publish - attempt ${V}`),Q=await await ds(this.rpcPublish(n,s,u,f,y,A,x,a==null?void 0:a.attestation).catch(Z=>this.logger.warn(Z)),this.publishTimeout,R),V++,Q||await new Promise(Z=>setTimeout(Z,this.failedPublishTimeout))}this.relayer.events.emit(lr.publish,T),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:x,topic:n,message:s,opts:a}})}catch(Z){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(Z),(h=a==null?void 0:a.internal)!=null&&h.throwOnFailedPublish)throw Z;this.queue.set(x,T)}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.relayer=t,this.logger=gr(e,this.name),this.registerEventListeners()}get context(){return Dr(this.logger)}rpcPublish(t,e,n,s,a,h,u,f){var y,A,x,T;const R={method:fo(s.protocol).publish,params:{topic:t,message:e,ttl:n,prompt:a,tag:h,attestation:f},id:u};return dr((y=R.params)==null?void 0:y.prompt)&&((A=R.params)==null||delete A.prompt),dr((x=R.params)==null?void 0:x.tag)&&((T=R.params)==null||delete T.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:R}),this.relayer.request(R)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:e,message:n,opts:s}=t;await this.publish(e,n,s)})}registerEventListeners(){this.relayer.core.heartbeat.on(Io.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(lr.connection_stalled);return}this.checkQueue()}),this.relayer.on(lr.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class O4{constructor(){this.map=new Map,this.set=(t,e)=>{const n=this.get(t);this.exists(t,e)||this.map.set(t,[...n,e])},this.get=t=>this.map.get(t)||[],this.exists=(t,e)=>this.get(t).includes(e),this.delete=(t,e)=>{if(typeof e>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,e))return;const s=n.filter(a=>a!==e);if(!s.length){this.map.delete(t);return}this.map.set(t,s)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var T4=Object.defineProperty,F4=Object.defineProperties,D4=Object.getOwnPropertyDescriptors,$p=Object.getOwnPropertySymbols,q4=Object.prototype.hasOwnProperty,U4=Object.prototype.propertyIsEnumerable,jp=(r,t,e)=>t in r?T4(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,co=(r,t)=>{for(var e in t||(t={}))q4.call(t,e)&&jp(r,e,t[e]);if($p)for(var e of $p(t))U4.call(t,e)&&jp(r,e,t[e]);return r},Gh=(r,t)=>F4(r,D4(t));class B4 extends dE{constructor(t,e){super(t,e),this.relayer=t,this.logger=e,this.subscriptions=new Map,this.topicMap=new O4,this.events=new en.EventEmitter,this.name=kE,this.version=$E,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Fi,this.subscribeTimeout=dt.toMiliseconds(dt.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(n,s)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}});try{const a=hu(s),h={topic:n,relay:a,transportType:s==null?void 0:s.transportType};this.pending.set(n,h);const u=await this.rpcSubscribe(n,a,s==null?void 0:s.transportType);return typeof u=="string"&&(this.onSubscribe(u,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:s}})),u}catch(a){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(a),a}},this.unsubscribe=async(n,s)=>{await this.restartToComplete(),this.isInitialized(),typeof(s==null?void 0:s.id)<"u"?await this.unsubscribeById(n,s.id,s):await this.unsubscribeByTopic(n,s)},this.isSubscribed=async n=>{if(this.topics.includes(n))return!0;const s=`${this.pendingSubscriptionWatchLabel}_${n}`;return await new Promise((a,h)=>{const u=new dt.Watch;u.start(s);const f=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(f),u.stop(s),a(!0)),u.elapsed(s)>=jE&&(clearInterval(f),u.stop(s),h(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=gr(e,this.name),this.clientId=""}get context(){return Dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,e){let n=!1;try{n=this.getSubscription(t).topic===e}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,e){const n=this.topicMap.get(t);await Promise.all(n.map(async s=>await this.unsubscribeById(t,s,e)))}async unsubscribeById(t,e,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:n}});try{const s=hu(n);await this.rpcUnsubscribe(t,e,s);const a=be("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,e,a),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:e,opts:n}})}catch(s){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(s),s}}async rpcSubscribe(t,e,n=xe.relay){n===xe.relay&&await this.restartToComplete();const s={method:fo(e.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{const a=Wi(t+this.clientId);return n===xe.link_mode?(setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(h=>this.logger.warn(h))},dt.toMiliseconds(dt.ONE_SECOND)),a):await await ds(this.relayer.request(s).catch(h=>this.logger.warn(h)),this.subscribeTimeout)?a:null}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(lr.connection_stalled)}return null}async rpcBatchSubscribe(t){if(!t.length)return;const e=t[0].relay,n={method:fo(e.protocol).batchSubscribe,params:{topics:t.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await ds(this.relayer.request(n).catch(s=>this.logger.warn(s)),this.subscribeTimeout)}catch{this.relayer.events.emit(lr.connection_stalled)}}async rpcBatchFetchMessages(t){if(!t.length)return;const e=t[0].relay,n={method:fo(e.protocol).batchFetchMessages,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});let s;try{s=await await ds(this.relayer.request(n).catch(a=>this.logger.warn(a)),this.subscribeTimeout)}catch{this.relayer.events.emit(lr.connection_stalled)}return s}rpcUnsubscribe(t,e,n){const s={method:fo(n.protocol).unsubscribe,params:{topic:t,id:e}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s}),this.relayer.request(s)}onSubscribe(t,e){this.setSubscription(t,Gh(co({},e),{id:t})),this.pending.delete(e.topic)}onBatchSubscribe(t){t.length&&t.forEach(e=>{this.setSubscription(e.id,co({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(t,e,n){this.events.removeAllListeners(e),this.hasSubscription(e,t)&&this.deleteSubscription(e,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,e){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:e}),this.addSubscription(t,e)}addSubscription(t,e){this.subscriptions.set(t,co({},e)),this.topicMap.set(e.topic,t),this.events.emit(xi.created,e)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const e=this.subscriptions.get(t);if(!e){const{message:n}=ft("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return e}deleteSubscription(t,e){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:e});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(xi.deleted,Gh(co({},n),{reason:e}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(xi.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let e=0;e<t;e++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(n),await this.batchSubscribe(n)}}this.events.emit(xi.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:e}=ft("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const e=await this.rpcBatchSubscribe(t);Ti(e)&&this.onBatchSubscribe(e.map((n,s)=>Gh(co({},t[s]),{id:n})))}async batchFetchMessages(t){if(!t.length)return;this.logger.trace(`Fetching batch messages for ${t.length} subscriptions`);const e=await this.rpcBatchFetchMessages(t);e&&e.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(e.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;const t=[];this.pending.forEach(e=>{t.push(e)}),await this.batchSubscribe(t),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(Io.pulse,async()=>{await this.checkPending()}),this.events.on(xi.created,async t=>{const e=xi.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()}),this.events.on(xi.deleted,async t=>{const e=xi.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen(),this.restartInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.restartInProgress||(clearInterval(e),t())},this.pollingInterval)})}}var L4=Object.defineProperty,zp=Object.getOwnPropertySymbols,k4=Object.prototype.hasOwnProperty,$4=Object.prototype.propertyIsEnumerable,Hp=(r,t,e)=>t in r?L4(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,j4=(r,t)=>{for(var e in t||(t={}))k4.call(t,e)&&Hp(r,e,t[e]);if(zp)for(var e of zp(t))$4.call(t,e)&&Hp(r,e,t[e]);return r};class z4 extends lE{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new en.EventEmitter,this.name=DE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=dt.toMiliseconds(dt.THIRTY_SECONDS+dt.ONE_SECOND),this.request=async e=>{var n,s;this.logger.debug("Publishing Request Payload");const a=e.id||fs().toString();await this.toEstablishConnection();try{const h=this.provider.request(e);this.requestsInFlight.set(a,{promise:h,request:e}),this.logger.trace({id:a,method:e.method,topic:(n=e.params)==null?void 0:n.topic},"relayer.request - attempt to publish...");const u=await new Promise(async(f,y)=>{const A=()=>{y(new Error(`relayer.request - publish interrupted, id: ${a}`))};this.provider.on(Vr.disconnect,A);const x=await h;this.provider.off(Vr.disconnect,A),f(x)});return this.logger.trace({id:a,method:e.method,topic:(s=e.params)==null?void 0:s.topic},"relayer.request - published"),u}catch(h){throw this.logger.debug(`Failed to Publish Request: ${a}`),h}finally{this.requestsInFlight.delete(a)}},this.resetPingTimeout=()=>{if(ja())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,n,s;(s=(n=(e=this.provider)==null?void 0:e.connection)==null?void 0:n.socket)==null||s.terminate()},this.heartBeatTimeout)}catch(e){this.logger.warn(e)}},this.onPayloadHandler=e=>{this.onProviderPayload(e),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit(lr.connect)},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.error(e),this.events.emit(lr.error,e),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(Vr.payload,this.onPayloadHandler),this.provider.on(Vr.connect,this.onConnectHandler),this.provider.on(Vr.disconnect,this.onDisconnectHandler),this.provider.on(Vr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?gr(t.logger,this.name):yu(Ya({level:t.logger||FE})),this.messages=new N4(this.logger,t.core),this.subscriber=new B4(this,this.logger),this.publisher=new R4(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||Mg,this.projectId=t.projectId,this.bundleId=Q6(),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(t){this.logger.warn(t)}}get context(){return Dr(this.logger)}get connected(){var t,e,n;return((n=(e=(t=this.provider)==null?void 0:t.connection)==null?void 0:e.socket)==null?void 0:n.readyState)===1}get connecting(){var t,e,n;return((n=(e=(t=this.provider)==null?void 0:t.connection)==null?void 0:e.socket)==null?void 0:n.readyState)===0}async publish(t,e,n){this.isInitialized(),await this.publisher.publish(t,e,n),await this.recordMessageEvent({topic:t,message:e,publishedAt:Date.now(),transportType:xe.relay})}async subscribe(t,e){var n;this.isInitialized(),(e==null?void 0:e.transportType)==="relay"&&await this.toEstablishConnection();let s=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"",a;const h=u=>{u.topic===t&&(this.subscriber.off(xi.created,h),a())};return await Promise.all([new Promise(u=>{a=u,this.subscriber.on(xi.created,h)}),new Promise(async u=>{s=await this.subscriber.subscribe(t,e)||s,u()})]),s}async unsubscribe(t,e){this.isInitialized(),await this.subscriber.unsubscribe(t,e)}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(t=>t.promise))}catch(t){this.logger.warn(t)}this.hasExperiencedNetworkDisruption||this.connected?await ds(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(t){await this.confirmOnlineStateOrThrow(),t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(e,n)=>{const s=()=>{this.provider.off(Vr.disconnect,s),n(new Error("Connection interrupted while trying to subscribe"))};this.provider.on(Vr.disconnect,s),await ds(this.provider.connect(),dt.toMiliseconds(dt.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{n(a)}).finally(()=>{clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),this.subscriber.start().catch(a=>{this.logger.error(a),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){this.logger.error(e);const n=e;if(this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(n.message))throw e}finally{this.connectionAttemptInProgress=!1}}async restartTransport(t){this.connectionAttemptInProgress||(this.relayUrl=t||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Np())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(t){if((t==null?void 0:t.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const e=t.sort((n,s)=>n.publishedAt-s.publishedAt);this.logger.trace(`Batch of ${e.length} message events sorted`);for(const n of e)try{await this.onMessageEvent(n)}catch(s){this.logger.warn(s)}this.logger.trace(`Batch of ${e.length} message events processed`)}async onLinkMessageEvent(t,e){const{topic:n}=t;if(!e.sessionExists){const s=Qe(dt.FIVE_MINUTES),a={topic:n,expiry:s,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(n,a)}this.events.emit(lr.message,t),await this.recordMessageEvent(t)}startPingTimeout(){var t,e,n,s,a;if(ja())try{(e=(t=this.provider)==null?void 0:t.connection)!=null&&e.socket&&((a=(s=(n=this.provider)==null?void 0:n.connection)==null?void 0:s.socket)==null||a.once("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(h){this.logger.warn(h)}}isConnectionStalled(t){return this.staleConnectionErrors.some(e=>t.includes(e))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new hi(new EE(X6({sdkVersion:uu,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:e,message:n}=t;await this.messages.set(e,n)}async shouldIgnoreMessageEvent(t){const{topic:e,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(e))return this.logger.debug(`Ignoring message for non-subscribed topic ${e}`),!0;const s=this.messages.has(e,n);return s&&this.logger.debug(`Ignoring duplicate message: ${n}`),s}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),wu(t)){if(!t.method.endsWith(qE))return;const e=t.params,{topic:n,message:s,publishedAt:a,attestation:h}=e.data,u={topic:n,message:s,publishedAt:a,transportType:xe.relay,attestation:h};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(j4({type:"event",event:e.id},u)),this.events.emit(e.id,u),await this.acknowledgePayload(t),await this.onMessageEvent(u)}else bu(t)&&this.events.emit(lr.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(lr.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const e=Wa(t.id,!0);await this.provider.connection.send(e)}unregisterProviderListeners(){this.provider.off(Vr.payload,this.onPayloadHandler),this.provider.off(Vr.connect,this.onConnectHandler),this.provider.off(Vr.disconnect,this.onDisconnectHandler),this.provider.off(Vr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let t=await Np();nE(async e=>{t!==e&&(t=e,e?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit(lr.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(t=>this.logger.error(t))},dt.toMiliseconds(UE))))}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&(this.connectionAttemptInProgress&&await new Promise(t=>{const e=setInterval(()=>{this.connected&&(clearInterval(e),t())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var H4=Object.defineProperty,Kp=Object.getOwnPropertySymbols,K4=Object.prototype.hasOwnProperty,V4=Object.prototype.propertyIsEnumerable,Vp=(r,t,e)=>t in r?H4(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Gp=(r,t)=>{for(var e in t||(t={}))K4.call(t,e)&&Vp(r,e,t[e]);if(Kp)for(var e of Kp(t))V4.call(t,e)&&Vp(r,e,t[e]);return r};class kn extends fE{constructor(t,e,n,s=Fi,a=void 0){super(t,e,n,s),this.core=t,this.logger=e,this.name=n,this.map=new Map,this.version=BE,this.cached=[],this.initialized=!1,this.storagePrefix=Fi,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!dr(h)?this.map.set(this.getKey(h),h):DA(h)?this.map.set(h.id,h):qA(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,u)=>{this.isInitialized(),this.map.has(h)?await this.update(h,u):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:u}),this.map.set(h,u),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(u=>Object.keys(h).every(f=>n6(u[f],h[f]))):this.values),this.update=async(h,u)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:u});const f=Gp(Gp({},this.getData(h)),u);this.map.set(h,f),await this.persist()},this.delete=async(h,u)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:u}),this.map.delete(h),this.addToRecentlyDeleted(h),await this.persist())},this.logger=gr(e,this.name),this.storagePrefix=s,this.getKey=a}get context(){return Dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(t){this.recentlyDeleted.push(t),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const e=this.map.get(t);if(!e){if(this.recentlyDeleted.includes(t)){const{message:s}=ft("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${t}`);throw this.logger.error(s),new Error(s)}const{message:n}=ft("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return e}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:e}=ft("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}}class G4{constructor(t,e){this.core=t,this.logger=e,this.name=zE,this.version=HE,this.events=new _u,this.initialized=!1,this.storagePrefix=Fi,this.ignoredPayloadTypes=[tn],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async n=>{this.isInitialized();const s=cu(),a=await this.core.crypto.setSymKey(s),h=Qe(dt.FIVE_MINUTES),u={protocol:xg},f={topic:a,expiry:h,relay:u,active:!1,methods:n==null?void 0:n.methods},y=Ip({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:s,relay:u,expiryTimestamp:h,methods:n==null?void 0:n.methods});return this.events.emit(Tn.create,f),this.core.expirer.set(a,h),await this.pairings.set(a,f),await this.core.relayer.subscribe(a,{transportType:n==null?void 0:n.transportType}),{topic:a,uri:y}},this.pair=async n=>{this.isInitialized();const s=this.core.eventClient.createEvent({properties:{topic:n==null?void 0:n.uri,trace:[Ai.pairing_started]}});this.isValidPair(n,s);const{topic:a,symKey:h,relay:u,expiryTimestamp:f,methods:y}=Ep(n.uri);s.props.properties.topic=a,s.addTrace(Ai.pairing_uri_validation_success),s.addTrace(Ai.pairing_uri_not_expired);let A;if(this.pairings.keys.includes(a)){if(A=this.pairings.get(a),s.addTrace(Ai.existing_pairing),A.active)throw s.setError(Ji.active_pairing_already_exists),new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);s.addTrace(Ai.pairing_not_expired)}const x=f||Qe(dt.FIVE_MINUTES),T={topic:a,relay:u,expiry:x,active:!1,methods:y};this.core.expirer.set(a,x),await this.pairings.set(a,T),s.addTrace(Ai.store_new_pairing),n.activatePairing&&await this.activate({topic:a}),this.events.emit(Tn.create,T),s.addTrace(Ai.emit_inactive_pairing),this.core.crypto.keychain.has(a)||await this.core.crypto.setSymKey(h,a),s.addTrace(Ai.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{s.setError(Ji.no_internet_connection)}try{await this.core.relayer.subscribe(a,{relay:u})}catch(R){throw s.setError(Ji.subscribe_pairing_topic_failure),R}return s.addTrace(Ai.subscribe_pairing_topic_success),T},this.activate=async({topic:n})=>{this.isInitialized();const s=Qe(dt.THIRTY_DAYS);this.core.expirer.set(n,s),await this.pairings.update(n,{active:!0,expiry:s})},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:s}=n;if(this.pairings.keys.includes(s)){const a=await this.sendRequest(s,"wc_pairingPing",{}),{done:h,resolve:u,reject:f}=On();this.events.once(ae("pairing_ping",a),({error:y})=>{y?f(y):u()}),await h()}},this.updateExpiry=async({topic:n,expiry:s})=>{this.isInitialized(),await this.pairings.update(n,{expiry:s})},this.updateMetadata=async({topic:n,metadata:s})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:s})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:s}=n;this.pairings.keys.includes(s)&&(await this.sendRequest(s,"wc_pairingDelete",be("USER_DISCONNECTED")),await this.deletePairing(s))},this.formatUriFromPairing=n=>{this.isInitialized();const{topic:s,relay:a,expiry:h,methods:u}=n,f=this.core.crypto.keychain.get(s);return Ip({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:f,relay:a,expiryTimestamp:h,methods:u})},this.sendRequest=async(n,s,a)=>{const h=Fn(s,a),u=await this.core.crypto.encode(n,h),f=oo[s].req;return this.core.history.set(n,h),this.core.relayer.publish(n,u,f),h.id},this.sendResult=async(n,s,a)=>{const h=Wa(n,a),u=await this.core.crypto.encode(s,h),f=await this.core.history.get(s,n),y=oo[f.request.method].res;await this.core.relayer.publish(s,u,y),await this.core.history.resolve(h)},this.sendError=async(n,s,a)=>{const h=vu(n,a),u=await this.core.crypto.encode(s,h),f=await this.core.history.get(s,n),y=oo[f.request.method]?oo[f.request.method].res:oo.unregistered_method.res;await this.core.relayer.publish(s,u,y),await this.core.history.resolve(h)},this.deletePairing=async(n,s)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,be("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),s?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(s=>gn(s.expiry));await Promise.all(n.map(s=>this.deletePairing(s.topic)))},this.onRelayEventRequest=n=>{const{topic:s,payload:a}=n;switch(a.method){case"wc_pairingPing":return this.onPairingPingRequest(s,a);case"wc_pairingDelete":return this.onPairingDeleteRequest(s,a);default:return this.onUnknownRpcMethodRequest(s,a)}},this.onRelayEventResponse=async n=>{const{topic:s,payload:a}=n,h=(await this.core.history.get(s,a.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(s,a);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(n,s)=>{const{id:a}=s;try{this.isValidPing({topic:n}),await this.sendResult(a,n,!0),this.events.emit(Tn.ping,{id:a,topic:n})}catch(h){await this.sendError(a,n,h),this.logger.error(h)}},this.onPairingPingResponse=(n,s)=>{const{id:a}=s;setTimeout(()=>{Qi(s)?this.events.emit(ae("pairing_ping",a),{}):Ei(s)&&this.events.emit(ae("pairing_ping",a),{error:s.error})},500)},this.onPairingDeleteRequest=async(n,s)=>{const{id:a}=s;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Tn.delete,{id:a,topic:n})}catch(h){await this.sendError(a,n,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(n,s)=>{const{id:a,method:h}=s;try{if(this.registeredMethods.includes(h))return;const u=be("WC_METHOD_UNSUPPORTED",h);await this.sendError(a,n,u),this.logger.error(u)}catch(u){await this.sendError(a,n,u),this.logger.error(u)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(be("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=(n,s)=>{var a;if(!_r(n)){const{message:u}=ft("MISSING_OR_INVALID",`pair() params: ${n}`);throw s.setError(Ji.malformed_pairing_uri),new Error(u)}if(!FA(n.uri)){const{message:u}=ft("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw s.setError(Ji.malformed_pairing_uri),new Error(u)}const h=Ep(n==null?void 0:n.uri);if(!((a=h==null?void 0:h.relay)!=null&&a.protocol)){const{message:u}=ft("MISSING_OR_INVALID","pair() uri#relay-protocol");throw s.setError(Ji.malformed_pairing_uri),new Error(u)}if(!(h!=null&&h.symKey)){const{message:u}=ft("MISSING_OR_INVALID","pair() uri#symKey");throw s.setError(Ji.malformed_pairing_uri),new Error(u)}if(h!=null&&h.expiryTimestamp&&dt.toMiliseconds(h==null?void 0:h.expiryTimestamp)<Date.now()){s.setError(Ji.pairing_expired);const{message:u}=ft("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(u)}},this.isValidPing=async n=>{if(!_r(n)){const{message:a}=ft("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(a)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidDisconnect=async n=>{if(!_r(n)){const{message:a}=ft("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(a)}const{topic:s}=n;await this.isValidPairingTopic(s)},this.isValidPairingTopic=async n=>{if(!ze(n,!1)){const{message:s}=ft("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(s)}if(!this.pairings.keys.includes(n)){const{message:s}=ft("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(s)}if(gn(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:s}=ft("EXPIRED",`pairing topic: ${n}`);throw new Error(s)}},this.core=t,this.logger=gr(e,this.name),this.pairings=new kn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Dr(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(lr.message,async t=>{const{topic:e,message:n,transportType:s}=t;if(!this.pairings.keys.includes(e)||s===xe.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(e,n);try{wu(a)?(this.core.history.set(e,a),this.onRelayEventRequest({topic:e,payload:a})):bu(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:e,payload:a}),this.core.history.delete(e,a.id))}catch(h){this.logger.error(h)}})}registerExpirerEvents(){this.core.expirer.on(Gr.expired,async t=>{const{topic:e}=R0(t.target);e&&this.pairings.keys.includes(e)&&(await this.deletePairing(e,!0),this.events.emit(Tn.expire,{topic:e}))})}}class Q4 extends cE{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.records=new Map,this.events=new en.EventEmitter,this.name=KE,this.version=VE,this.cached=[],this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,s,a)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:s,chainId:a}),this.records.has(s.id))return;const h={id:s.id,topic:n,request:{method:s.method,params:s.params||null},chainId:a,expiry:Qe(dt.THIRTY_DAYS)};this.records.set(h.id,h),this.persist(),this.events.emit(ri.created,h)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const s=await this.getRecord(n.id);typeof s.response>"u"&&(s.response=Ei(n)?{error:n.error}:{result:n.result},this.records.set(s.id,s),this.persist(),this.events.emit(ri.updated,s))},this.get=async(n,s)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:s}),await this.getRecord(s)),this.delete=(n,s)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:s}),this.values.forEach(a=>{if(a.topic===n){if(typeof s<"u"&&a.id!==s)return;this.records.delete(a.id),this.events.emit(ri.deleted,a)}}),this.persist()},this.exists=async(n,s)=>(this.isInitialized(),this.records.has(s)?(await this.getRecord(s)).topic===n:!1),this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=gr(e,this.name)}get context(){return Dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(e=>{if(typeof e.response<"u")return;const n={topic:e.topic,request:Fn(e.request.method,e.request.params,e.id),chainId:e.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const e=this.records.get(t);if(!e){const{message:n}=ft("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return e}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ri.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:e}=ft("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(ri.created,t=>{const e=ri.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.events.on(ri.updated,t=>{const e=ri.updated;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.events.on(ri.deleted,t=>{const e=ri.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,record:t})}),this.core.heartbeat.on(Io.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let t=!1;this.records.forEach(e=>{dt.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.records.delete(e.id),this.events.emit(ri.deleted,e,!1),t=!0)}),t&&this.persist()}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}}class J4 extends pE{constructor(t,e){super(t,e),this.core=t,this.logger=e,this.expirations=new Map,this.events=new en.EventEmitter,this.name=GE,this.version=QE,this.cached=[],this.initialized=!1,this.storagePrefix=Fi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const s=this.formatTarget(n);return typeof this.getExpiration(s)<"u"}catch{return!1}},this.set=(n,s)=>{this.isInitialized();const a=this.formatTarget(n),h={target:a,expiry:s};this.expirations.set(a,h),this.checkExpiry(a,h),this.events.emit(Gr.created,{target:a,expiration:h})},this.get=n=>{this.isInitialized();const s=this.formatTarget(n);return this.getExpiration(s)},this.del=n=>{if(this.isInitialized(),this.has(n)){const s=this.formatTarget(n),a=this.getExpiration(s);this.expirations.delete(s),this.events.emit(Gr.deleted,{target:s,expiration:a})}},this.on=(n,s)=>{this.events.on(n,s)},this.once=(n,s)=>{this.events.once(n,s)},this.off=(n,s)=>{this.events.off(n,s)},this.removeListener=(n,s)=>{this.events.removeListener(n,s)},this.logger=gr(e,this.name)}get context(){return Dr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Z6(t);if(typeof t=="number")return t3(t);const{message:e}=ft("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(e)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Gr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:e}=ft("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),new Error(e)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const e=this.expirations.get(t);if(!e){const{message:n}=ft("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.warn(n),new Error(n)}return e}checkExpiry(t,e){const{expiry:n}=e;dt.toMiliseconds(n)-Date.now()<=0&&this.expire(t,e)}expire(t,e){this.expirations.delete(t),this.events.emit(Gr.expired,{target:t,expiration:e})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,e)=>this.checkExpiry(e,t))}registerEventListeners(){this.core.heartbeat.on(Io.pulse,()=>this.checkExpirations()),this.events.on(Gr.created,t=>{const e=Gr.created;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(Gr.expired,t=>{const e=Gr.expired;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()}),this.events.on(Gr.deleted,t=>{const e=Gr.deleted;this.logger.info(`Emitting ${e}`),this.logger.debug({type:"event",event:e,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}}var Fe={};Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.getLocalStorage=Fe.getLocalStorageOrThrow=Fe.getCrypto=Fe.getCryptoOrThrow=Fe.getLocation=Fe.getLocationOrThrow=Fe.getNavigator=Fe.getNavigatorOrThrow=Lg=Fe.getDocument=Fe.getDocumentOrThrow=Fe.getFromWindowOrThrow=Fe.getFromWindow=void 0;function $n(r){let t;return typeof window<"u"&&typeof window[r]<"u"&&(t=window[r]),t}Fe.getFromWindow=$n;function Ms(r){const t=$n(r);if(!t)throw new Error(`${r} is not defined in Window`);return t}Fe.getFromWindowOrThrow=Ms;function Y4(){return Ms("document")}Fe.getDocumentOrThrow=Y4;function W4(){return $n("document")}var Lg=Fe.getDocument=W4;function X4(){return Ms("navigator")}Fe.getNavigatorOrThrow=X4;function Z4(){return $n("navigator")}Fe.getNavigator=Z4;function tI(){return Ms("location")}Fe.getLocationOrThrow=tI;function eI(){return $n("location")}Fe.getLocation=eI;function rI(){return Ms("crypto")}Fe.getCryptoOrThrow=rI;function iI(){return $n("crypto")}Fe.getCrypto=iI;function nI(){return Ms("localStorage")}Fe.getLocalStorageOrThrow=nI;function sI(){return $n("localStorage")}Fe.getLocalStorage=sI;class oI extends gE{constructor(t,e,n){super(t,e,n),this.core=t,this.logger=e,this.store=n,this.name=JE,this.verifyUrlV3=WE,this.storagePrefix=Fi,this.version=Ig,this.init=async()=>{var s;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&dt.toMiliseconds((s=this.publicKey)==null?void 0:s.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async s=>{if(!Mo()||this.isDevEnv)return;const a=window.location.origin,{id:h,decryptedId:u}=s,f=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${a}&id=${h}&decryptedId=${u}`;try{const y=Lg(),A=this.startAbortTimer(dt.ONE_SECOND*5),x=await new Promise((T,R)=>{const $=()=>{window.removeEventListener("message",V),y.body.removeChild(Q),R("attestation aborted")};this.abortController.signal.addEventListener("abort",$);const Q=y.createElement("iframe");Q.src=f,Q.style.display="none",Q.addEventListener("error",$,{signal:this.abortController.signal});const V=Z=>{if(Z.data&&typeof Z.data=="string")try{const H=JSON.parse(Z.data);if(H.type==="verify_attestation"){if(eu(H.attestation).payload.id!==h)return;clearInterval(A),y.body.removeChild(Q),this.abortController.signal.removeEventListener("abort",$),window.removeEventListener("message",V),T(H.attestation===null?"":H.attestation)}}catch(H){this.logger.warn(H)}};y.body.appendChild(Q),window.addEventListener("message",V,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",x),x}catch(y){this.logger.warn(y)}return""},this.resolve=async s=>{if(this.isDevEnv)return"";const{attestationId:a,hash:h,encryptedId:u}=s;if(a===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(a){if(eu(a).payload.id!==u)return;const y=await this.isValidJwtAttestation(a);if(y){if(!y.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return y}}if(!h)return;const f=this.getVerifyUrl(s==null?void 0:s.verifyUrl);return this.fetchAttestation(h,f)},this.fetchAttestation=async(s,a)=>{this.logger.debug(`resolving attestation: ${s} from url: ${a}`);const h=this.startAbortTimer(dt.ONE_SECOND*5),u=await fetch(`${a}/attestation/${s}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(h),u.status===200?await u.json():void 0},this.getVerifyUrl=s=>{let a=s||wo;return XE.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${wo}`),a=wo),a},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const s=this.startAbortTimer(dt.FIVE_SECONDS),a=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(s),await a.json()}catch(s){this.logger.warn(s)}},this.persistPublicKey=async s=>{this.logger.debug("persisting public key to local storage",s),await this.store.setItem(this.storeKey,s),this.publicKey=s},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async s=>{const a=await this.getPublicKey();try{if(a)return this.validateAttestation(s,a)}catch(u){this.logger.error(u),this.logger.warn("error validating attestation")}const h=await this.fetchAndPersistPublicKey();try{if(h)return this.validateAttestation(s,h)}catch(u){this.logger.error(u),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async a=>{const h=await this.fetchPublicKey();h&&(await this.persistPublicKey(h),a(h))});const s=await this.fetchPromise;return this.fetchPromise=void 0,s},this.validateAttestation=(s,a)=>{const h=gA(s,a.publicKey),u={hasExpired:dt.toMiliseconds(h.exp)<Date.now(),payload:h};if(u.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:u.payload.origin,isScam:u.payload.isScam,isVerified:u.payload.isVerified}},this.logger=gr(e,this.name),this.abortController=new AbortController,this.isDevEnv=Su(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Dr(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),dt.toMiliseconds(t))}}class aI extends mE{constructor(t,e){super(t,e),this.projectId=t,this.logger=e,this.context=ZE,this.registerDeviceToken=async n=>{const{clientId:s,token:a,notificationType:h,enableEncrypted:u=!1}=n,f=`${t8}/${this.projectId}/clients`;await fetch(f,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:s,type:h,token:a,always_raw:u})})},this.logger=gr(e,this.context)}}var cI=Object.defineProperty,Qp=Object.getOwnPropertySymbols,hI=Object.prototype.hasOwnProperty,uI=Object.prototype.propertyIsEnumerable,Jp=(r,t,e)=>t in r?cI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,ho=(r,t)=>{for(var e in t||(t={}))hI.call(t,e)&&Jp(r,e,t[e]);if(Qp)for(var e of Qp(t))uI.call(t,e)&&Jp(r,e,t[e]);return r};class lI extends vE{constructor(t,e,n=!0){super(t,e,n),this.core=t,this.logger=e,this.context=r8,this.storagePrefix=Fi,this.storageVersion=e8,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!Su())try{const s={eventId:zd(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:M0(this.core.relayer.protocol,this.core.relayer.version,uu)}}};await this.sendEvent([s])}catch(s){this.logger.warn(s)}},this.createEvent=s=>{const{event:a="ERROR",type:h="",properties:{topic:u,trace:f}}=s,y=zd(),A=this.core.projectId||"",x=Date.now(),T=ho({eventId:y,timestamp:x,props:{event:a,type:h,properties:{topic:u,trace:f}},bundleId:A,domain:this.getAppDomain()},this.setMethods(y));return this.telemetryEnabled&&(this.events.set(y,T),this.shouldPersist=!0),T},this.getEvent=s=>{const{eventId:a,topic:h}=s;if(a)return this.events.get(a);const u=Array.from(this.events.values()).find(f=>f.props.properties.topic===h);if(u)return ho(ho({},u),this.setMethods(u.eventId))},this.deleteEvent=s=>{const{eventId:a}=s;this.events.delete(a),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(Io.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(s=>{dt.fromMiliseconds(Date.now())-dt.fromMiliseconds(s.timestamp)>i8&&(this.events.delete(s.eventId),this.shouldPersist=!0)})})},this.setMethods=s=>({addTrace:a=>this.addTrace(s,a),setError:a=>this.setError(s,a)}),this.addTrace=(s,a)=>{const h=this.events.get(s);h&&(h.props.properties.trace.push(a),this.events.set(s,h),this.shouldPersist=!0)},this.setError=(s,a)=>{const h=this.events.get(s);h&&(h.props.type=a,h.timestamp=Date.now(),this.events.set(s,h),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const s=await this.core.storage.getItem(this.storageKey)||[];if(!s.length)return;s.forEach(a=>{this.events.set(a.eventId,ho(ho({},a),this.setMethods(a.eventId)))})}catch(s){this.logger.warn(s)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const s=[];for(const[a,h]of this.events)h.props.type&&s.push(h);if(s.length!==0)try{if((await this.sendEvent(s)).ok)for(const a of s)this.events.delete(a.eventId),this.shouldPersist=!0}catch(a){this.logger.warn(a)}},this.sendEvent=async s=>{const a=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${n8}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${uu}${a}`,{method:"POST",body:JSON.stringify(s)})},this.getAppDomain=()=>x0().url,this.logger=gr(e,this.context),this.telemetryEnabled=n,n?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var fI=Object.defineProperty,Yp=Object.getOwnPropertySymbols,dI=Object.prototype.hasOwnProperty,pI=Object.prototype.propertyIsEnumerable,Wp=(r,t,e)=>t in r?fI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Xp=(r,t)=>{for(var e in t||(t={}))dI.call(t,e)&&Wp(r,e,t[e]);if(Yp)for(var e of Yp(t))pI.call(t,e)&&Wp(r,e,t[e]);return r};class Du extends aE{constructor(t){var e;super(t),this.protocol=Eg,this.version=Ig,this.name=Sg,this.events=new en.EventEmitter,this.initialized=!1,this.on=(h,u)=>this.events.on(h,u),this.once=(h,u)=>this.events.once(h,u),this.off=(h,u)=>this.events.off(h,u),this.removeListener=(h,u)=>this.events.removeListener(h,u),this.dispatchEnvelope=({topic:h,message:u,sessionExists:f})=>{if(!h||!u)return;const y={topic:h,message:u,publishedAt:Date.now(),transportType:xe.link_mode};this.relayer.onLinkMessageEvent(y,{sessionExists:f})},this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||Mg,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const n=Ya({level:typeof(t==null?void 0:t.logger)=="string"&&t.logger?t.logger:IE.logger}),{logger:s,chunkLoggerController:a}=e6({opts:n,maxSizeInBytes:t==null?void 0:t.maxLogBlobSizeInBytes,loggerOverride:t==null?void 0:t.logger});this.logChunkController=a,(e=this.logChunkController)!=null&&e.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var h,u;(h=this.logChunkController)!=null&&h.downloadLogsBlobInBrowser&&((u=this.logChunkController)==null||u.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=gr(s,this.name),this.heartbeat=new r6,this.crypto=new C4(this,this.logger,t==null?void 0:t.keychain),this.history=new Q4(this,this.logger),this.expirer=new J4(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new i6(Xp(Xp({},SE),t==null?void 0:t.storageOptions)),this.relayer=new z4({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new G4(this,this.logger),this.verify=new oI(this,this.logger,this.storage),this.echoClient=new aI(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new lI(this,this.logger,t==null?void 0:t.telemetryEnabled)}static async init(t){const e=new Du(t);await e.initialize();const n=await e.crypto.getClientId();return await e.storage.setItem(LE,n),e}get context(){return Dr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var t;return(t=this.logChunkController)==null?void 0:t.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(t){this.linkModeSupportedApps.includes(t)||(this.linkModeSupportedApps.push(t),await this.storage.setItem(Fp,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.eventClient.init(),this.linkModeSupportedApps=await this.storage.getItem(Fp)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const gI=Du,kg="wc",$g=2,jg="client",qu=`${kg}@${$g}:${jg}:`,Qh={name:jg,logger:"error"},Zp="WALLETCONNECT_DEEPLINK_CHOICE",mI="proposal",zg="Proposal expired",vI="session",cs=dt.SEVEN_DAYS,yI="engine",We={wc_sessionPropose:{req:{ttl:dt.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:dt.ONE_DAY,prompt:!1,tag:1104},res:{ttl:dt.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:dt.ONE_DAY,prompt:!1,tag:1106},res:{ttl:dt.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:dt.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:dt.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:dt.ONE_DAY,prompt:!1,tag:1112},res:{ttl:dt.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:dt.ONE_DAY,prompt:!1,tag:1114},res:{ttl:dt.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:dt.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:dt.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:dt.FIVE_MINUTES,prompt:!1,tag:1119}}},Jh={min:dt.FIVE_MINUTES,max:dt.SEVEN_DAYS},_i={idle:"IDLE",active:"ACTIVE"},wI="request",bI=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],_I="wc",AI="auth",EI="authKeys",II="pairingTopics",SI="requests",ic=`${_I}@${1.5}:${AI}:`,Ua=`${ic}:PUB_KEY`;var xI=Object.defineProperty,MI=Object.defineProperties,PI=Object.getOwnPropertyDescriptors,t0=Object.getOwnPropertySymbols,CI=Object.prototype.hasOwnProperty,NI=Object.prototype.propertyIsEnumerable,e0=(r,t,e)=>t in r?xI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Be=(r,t)=>{for(var e in t||(t={}))CI.call(t,e)&&e0(r,e,t[e]);if(t0)for(var e of t0(t))NI.call(t,e)&&e0(r,e,t[e]);return r},ni=(r,t)=>MI(r,PI(t));class RI extends wE{constructor(t){super(t),this.name=yI,this.events=new _u,this.initialized=!1,this.requestQueue={state:_i.idle,queue:[]},this.sessionRequestQueue={state:_i.idle,queue:[]},this.requestQueueDelay=dt.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(We)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},dt.toMiliseconds(this.requestQueueDelay)))},this.connect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const n=ni(Be({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:s,requiredNamespaces:a,optionalNamespaces:h,sessionProperties:u,relays:f}=n;let y=s,A,x=!1;try{y&&(x=this.client.core.pairing.pairings.get(y).active)}catch(B){throw this.client.logger.error(`connect() -> pairing.get(${y}) failed`),B}if(!y||!x){const{topic:B,uri:k}=await this.client.core.pairing.create();y=B,A=k}if(!y){const{message:B}=ft("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(B)}const T=await this.client.core.crypto.generateKeyPair(),R=We.wc_sessionPropose.req.ttl||dt.FIVE_MINUTES,$=Qe(R),Q=Be({requiredNamespaces:a,optionalNamespaces:h,relays:f??[{protocol:xg}],proposer:{publicKey:T,metadata:this.client.metadata},expiryTimestamp:$,pairingTopic:y},u&&{sessionProperties:u}),{reject:V,resolve:Z,done:H}=On(R,zg);this.events.once(ae("session_connect"),async({error:B,session:k})=>{if(B)V(B);else if(k){k.self.publicKey=T;const z=ni(Be({},k),{pairingTopic:Q.pairingTopic,requiredNamespaces:Q.requiredNamespaces,optionalNamespaces:Q.optionalNamespaces,transportType:xe.relay});await this.client.session.set(k.topic,z),await this.setExpiry(k.topic,k.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:k.peer.metadata}),this.cleanupDuplicatePairings(z),Z(z)}});const J=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:Q,throwOnFailedPublish:!0});return await this.setProposal(J,Be({id:J},Q)),{uri:A,approval:H}},this.pair=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(n){throw this.client.logger.error("pair() failed"),n}},this.approve=async e=>{var n,s,a;const h=this.client.core.eventClient.createEvent({properties:{topic:(n=e==null?void 0:e.id)==null?void 0:n.toString(),trace:[ii.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(q){throw h.setError(Nn.no_internet_connection),q}try{await this.isValidProposalId(e==null?void 0:e.id)}catch(q){throw this.client.logger.error(`approve() -> proposal.get(${e==null?void 0:e.id}) failed`),h.setError(Nn.proposal_not_found),q}try{await this.isValidApprove(e)}catch(q){throw this.client.logger.error("approve() -> isValidApprove() failed"),h.setError(Nn.session_approve_namespace_validation_failure),q}const{id:u,relayProtocol:f,namespaces:y,sessionProperties:A,sessionConfig:x}=e,T=this.client.proposal.get(u);this.client.core.eventClient.deleteEvent({eventId:h.eventId});const{pairingTopic:R,proposer:$,requiredNamespaces:Q,optionalNamespaces:V}=T;let Z=(s=this.client.core.eventClient)==null?void 0:s.getEvent({topic:R});Z||(Z=(a=this.client.core.eventClient)==null?void 0:a.createEvent({type:ii.session_approve_started,properties:{topic:R,trace:[ii.session_approve_started,ii.session_namespaces_validation_success]}}));const H=await this.client.core.crypto.generateKeyPair(),J=$.publicKey,B=await this.client.core.crypto.generateSharedKey(H,J),k=Be(Be({relay:{protocol:f??"irn"},namespaces:y,controller:{publicKey:H,metadata:this.client.metadata},expiry:Qe(cs)},A&&{sessionProperties:A}),x&&{sessionConfig:x}),z=xe.relay;Z.addTrace(ii.subscribing_session_topic);try{await this.client.core.relayer.subscribe(B,{transportType:z})}catch(q){throw Z.setError(Nn.subscribe_session_topic_failure),q}Z.addTrace(ii.subscribe_session_topic_success);const w=ni(Be({},k),{topic:B,requiredNamespaces:Q,optionalNamespaces:V,pairingTopic:R,acknowledged:!1,self:k.controller,peer:{publicKey:$.publicKey,metadata:$.metadata},controller:H,transportType:xe.relay});await this.client.session.set(B,w),Z.addTrace(ii.store_session);try{Z.addTrace(ii.publishing_session_settle),await this.sendRequest({topic:B,method:"wc_sessionSettle",params:k,throwOnFailedPublish:!0}).catch(q=>{throw Z==null||Z.setError(Nn.session_settle_publish_failure),q}),Z.addTrace(ii.session_settle_publish_success),Z.addTrace(ii.publishing_session_approve),await this.sendResult({id:u,topic:R,result:{relay:{protocol:f??"irn"},responderPublicKey:H},throwOnFailedPublish:!0}).catch(q=>{throw Z==null||Z.setError(Nn.session_approve_publish_failure),q}),Z.addTrace(ii.session_approve_publish_success)}catch(q){throw this.client.logger.error(q),this.client.session.delete(B,be("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(B),q}return this.client.core.eventClient.deleteEvent({eventId:Z.eventId}),await this.client.core.pairing.updateMetadata({topic:R,metadata:$.metadata}),await this.client.proposal.delete(u,be("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:R}),await this.setExpiry(B,Qe(cs)),{topic:B,acknowledged:()=>Promise.resolve(this.client.session.get(B))}},this.reject=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(h){throw this.client.logger.error("reject() -> isValidReject() failed"),h}const{id:n,reason:s}=e;let a;try{a=this.client.proposal.get(n).pairingTopic}catch(h){throw this.client.logger.error(`reject() -> proposal.get(${n}) failed`),h}a&&(await this.sendError({id:n,topic:a,error:s,rpcOpts:We.wc_sessionPropose.reject}),await this.client.proposal.delete(n,be("USER_DISCONNECTED")))},this.update=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(x){throw this.client.logger.error("update() -> isValidUpdate() failed"),x}const{topic:n,namespaces:s}=e,{done:a,resolve:h,reject:u}=On(),f=os(),y=fs().toString(),A=this.client.session.get(n).namespaces;return this.events.once(ae("session_update",f),({error:x})=>{x?u(x):h()}),await this.client.session.update(n,{namespaces:s}),await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:s},throwOnFailedPublish:!0,clientRpcId:f,relayRpcId:y}).catch(x=>{this.client.logger.error(x),this.client.session.update(n,{namespaces:A}),u(x)}),{acknowledged:a}},this.extend=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(f){throw this.client.logger.error("extend() -> isValidExtend() failed"),f}const{topic:n}=e,s=os(),{done:a,resolve:h,reject:u}=On();return this.events.once(ae("session_extend",s),({error:f})=>{f?u(f):h()}),await this.setExpiry(n,Qe(cs)),this.sendRequest({topic:n,method:"wc_sessionExtend",params:{},clientRpcId:s,throwOnFailedPublish:!0}).catch(f=>{u(f)}),{acknowledged:a}},this.request=async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch($){throw this.client.logger.error("request() -> isValidRequest() failed"),$}const{chainId:n,request:s,topic:a,expiry:h=We.wc_sessionRequest.req.ttl}=e,u=this.client.session.get(a);(u==null?void 0:u.transportType)===xe.relay&&await this.confirmOnlineStateOrThrow();const f=os(),y=fs().toString(),{done:A,resolve:x,reject:T}=On(h,"Request expired. Please try again.");this.events.once(ae("session_request",f),({error:$,result:Q})=>{$?T($):x(Q)});const R=this.getAppLinkIfEnabled(u.peer.metadata,u.transportType);return R?(await this.sendRequest({clientRpcId:f,relayRpcId:y,topic:a,method:"wc_sessionRequest",params:{request:ni(Be({},s),{expiryTimestamp:Qe(h)}),chainId:n},expiry:h,throwOnFailedPublish:!0,appLink:R}).catch($=>T($)),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:n,id:f}),await A()):await Promise.all([new Promise(async $=>{await this.sendRequest({clientRpcId:f,relayRpcId:y,topic:a,method:"wc_sessionRequest",params:{request:ni(Be({},s),{expiryTimestamp:Qe(h)}),chainId:n},expiry:h,throwOnFailedPublish:!0}).catch(Q=>T(Q)),this.client.events.emit("session_request_sent",{topic:a,request:s,chainId:n,id:f}),$()}),new Promise(async $=>{var Q;if(!((Q=u.sessionConfig)!=null&&Q.disableDeepLink)){const V=await i3(this.client.core.storage,Zp);await e3({id:f,topic:a,wcDeepLink:V})}$()}),A()]).then($=>$[2])},this.respond=async e=>{this.isInitialized(),await this.isValidRespond(e);const{topic:n,response:s}=e,{id:a}=s,h=this.client.session.get(n);h.transportType===xe.relay&&await this.confirmOnlineStateOrThrow();const u=this.getAppLinkIfEnabled(h.peer.metadata,h.transportType);Qi(s)?await this.sendResult({id:a,topic:n,result:s.result,throwOnFailedPublish:!0,appLink:u}):Ei(s)&&await this.sendError({id:a,topic:n,error:s.error,appLink:u}),this.cleanupAfterResponse(e)},this.ping=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(s){throw this.client.logger.error("ping() -> isValidPing() failed"),s}const{topic:n}=e;if(this.client.session.keys.includes(n)){const s=os(),a=fs().toString(),{done:h,resolve:u,reject:f}=On();this.events.once(ae("session_ping",s),({error:y})=>{y?f(y):u()}),await Promise.all([this.sendRequest({topic:n,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:s,relayRpcId:a}),h()])}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);const{topic:n,event:s,chainId:a}=e,h=fs().toString();await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:s,chainId:a},throwOnFailedPublish:!0,relayRpcId:h})},this.disconnect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);const{topic:n}=e;if(this.client.session.keys.includes(n))await this.sendRequest({topic:n,method:"wc_sessionDelete",params:be("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:n,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(n))await this.client.core.pairing.disconnect({topic:n});else{const{message:s}=ft("MISMATCHED_TOPIC",`Session or pairing topic not found: ${n}`);throw new Error(s)}},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter(n=>OA(n,e))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(e,n)=>{var s;this.isInitialized(),this.isValidAuthenticate(e);const a=n&&this.client.core.linkModeSupportedApps.includes(n)&&((s=this.client.metadata.redirect)==null?void 0:s.linkMode),h=a?xe.link_mode:xe.relay;h===xe.relay&&await this.confirmOnlineStateOrThrow();const{chains:u,statement:f="",uri:y,domain:A,nonce:x,type:T,exp:R,nbf:$,methods:Q=[],expiry:V}=e,Z=[...e.resources||[]],{topic:H,uri:J}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:h});this.client.logger.info({message:"Generated new pairing",pairing:{topic:H,uri:J}});const B=await this.client.core.crypto.generateKeyPair(),k=qa(B);if(await Promise.all([this.client.auth.authKeys.set(Ua,{responseTopic:k,publicKey:B}),this.client.auth.pairingTopics.set(k,{topic:k,pairingTopic:H})]),await this.client.core.relayer.subscribe(k,{transportType:h}),this.client.logger.info(`sending request to new pairing topic: ${H}`),Q.length>0){const{namespace:P}=go(u[0]);let O=Z5(P,"request",Q);Da(Z)&&(O=eA(O,Z.pop())),Z.push(O)}const z=V&&V>We.wc_sessionAuthenticate.req.ttl?V:We.wc_sessionAuthenticate.req.ttl,w={authPayload:{type:T??"caip122",chains:u,statement:f,aud:y,domain:A,version:"1",nonce:x,iat:new Date().toISOString(),exp:R,nbf:$,resources:Z},requester:{publicKey:B,metadata:this.client.metadata},expiryTimestamp:Qe(z)},q={eip155:{chains:u,methods:[...new Set(["personal_sign",...Q])],events:["chainChanged","accountsChanged"]}},ht={requiredNamespaces:{},optionalNamespaces:q,relays:[{protocol:"irn"}],pairingTopic:H,proposer:{publicKey:B,metadata:this.client.metadata},expiryTimestamp:Qe(We.wc_sessionPropose.req.ttl)},{done:ut,resolve:lt,reject:gt}=On(z,"Request expired"),l=async({error:P,session:O})=>{if(this.events.off(ae("session_request",m),v),P)gt(P);else if(O){O.self.publicKey=B,await this.client.session.set(O.topic,O),await this.setExpiry(O.topic,O.expiry),H&&await this.client.core.pairing.updateMetadata({topic:H,metadata:O.peer.metadata});const S=this.client.session.get(O.topic);await this.deleteProposal(b),lt({session:S})}},v=async P=>{var O,S,d;if(await this.deletePendingAuthRequest(m,{message:"fulfilled",code:0}),P.error){const U=be("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return P.error.code===U.code?void 0:(this.events.off(ae("session_connect"),l),gt(P.error.message))}await this.deleteProposal(b),this.events.off(ae("session_connect"),l);const{cacaos:C,responder:X}=P.result,rt=[],_=[];for(const U of C){await pp({cacao:U,projectId:this.client.core.projectId})||(this.client.logger.error(U,"Signature verification failed"),gt(be("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:L}=U,p=Da(L.resources),F=[dp(L.iss)],et=Ga(L.iss);if(p){const st=gp(p),at=mp(p);rt.push(...st),F.push(...at)}for(const st of F)_.push(`${st}:${et}`)}const W=await this.client.core.crypto.generateSharedKey(B,X.publicKey);let D;rt.length>0&&(D={topic:W,acknowledged:!0,self:{publicKey:B,metadata:this.client.metadata},peer:X,controller:X.publicKey,expiry:Qe(cs),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:H,namespaces:Sp([...new Set(rt)],[...new Set(_)]),transportType:h},await this.client.core.relayer.subscribe(W,{transportType:h}),await this.client.session.set(W,D),H&&await this.client.core.pairing.updateMetadata({topic:H,metadata:X.metadata}),D=this.client.session.get(W)),(O=this.client.metadata.redirect)!=null&&O.linkMode&&(S=X.metadata.redirect)!=null&&S.linkMode&&(d=X.metadata.redirect)!=null&&d.universal&&n&&(this.client.core.addLinkModeSupportedApp(X.metadata.redirect.universal),this.client.session.update(W,{transportType:xe.link_mode})),lt({auths:C,session:D})},m=os(),b=os();this.events.once(ae("session_connect"),l),this.events.once(ae("session_request",m),v);let E;try{if(a){const P=Fn("wc_sessionAuthenticate",w,m);this.client.core.history.set(H,P);const O=await this.client.core.crypto.encode("",P,{type:Ro,encoding:no});E=Ma(n,H,O)}else await Promise.all([this.sendRequest({topic:H,method:"wc_sessionAuthenticate",params:w,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:m}),this.sendRequest({topic:H,method:"wc_sessionPropose",params:ht,expiry:We.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:b})])}catch(P){throw this.events.off(ae("session_connect"),l),this.events.off(ae("session_request",m),v),P}return await this.setProposal(b,Be({id:b},ht)),await this.setAuthRequest(m,{request:ni(Be({},w),{verifyContext:{}}),pairingTopic:H,transportType:h}),{uri:E??J,response:ut}},this.approveSessionAuthenticate=async e=>{const{id:n,auths:s}=e,a=this.client.core.eventClient.createEvent({properties:{topic:n.toString(),trace:[Rn.authenticated_session_approve_started]}});try{this.isInitialized()}catch(V){throw a.setError(ao.no_internet_connection),V}const h=this.getPendingAuthRequest(n);if(!h)throw a.setError(ao.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${n}`);const u=h.transportType||xe.relay;u===xe.relay&&await this.confirmOnlineStateOrThrow();const f=h.requester.publicKey,y=await this.client.core.crypto.generateKeyPair(),A=qa(f),x={type:tn,receiverPublicKey:f,senderPublicKey:y},T=[],R=[];for(const V of s){if(!await pp({cacao:V,projectId:this.client.core.projectId})){a.setError(ao.invalid_cacao);const k=be("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:n,topic:A,error:k,encodeOpts:x}),new Error(k.message)}a.addTrace(Rn.cacaos_verified);const{p:Z}=V,H=Da(Z.resources),J=[dp(Z.iss)],B=Ga(Z.iss);if(H){const k=gp(H),z=mp(H);T.push(...k),J.push(...z)}for(const k of J)R.push(`${k}:${B}`)}const $=await this.client.core.crypto.generateSharedKey(y,f);a.addTrace(Rn.create_authenticated_session_topic);let Q;if((T==null?void 0:T.length)>0){Q={topic:$,acknowledged:!0,self:{publicKey:y,metadata:this.client.metadata},peer:{publicKey:f,metadata:h.requester.metadata},controller:f,expiry:Qe(cs),authentication:s,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:h.pairingTopic,namespaces:Sp([...new Set(T)],[...new Set(R)]),transportType:u},a.addTrace(Rn.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe($,{transportType:u})}catch(V){throw a.setError(ao.subscribe_authenticated_session_topic_failure),V}a.addTrace(Rn.subscribe_authenticated_session_topic_success),await this.client.session.set($,Q),a.addTrace(Rn.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:h.requester.metadata})}a.addTrace(Rn.publishing_authenticated_session_approve);try{await this.sendResult({topic:A,id:n,result:{cacaos:s,responder:{publicKey:y,metadata:this.client.metadata}},encodeOpts:x,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(h.requester.metadata,u)})}catch(V){throw a.setError(ao.authenticated_session_approve_publish_failure),V}return await this.client.auth.requests.delete(n,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:h.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:a.eventId}),{session:Q}},this.rejectSessionAuthenticate=async e=>{this.isInitialized();const{id:n,reason:s}=e,a=this.getPendingAuthRequest(n);if(!a)throw new Error(`Could not find pending auth request with id ${n}`);a.transportType===xe.relay&&await this.confirmOnlineStateOrThrow();const h=a.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),f=qa(h),y={type:tn,receiverPublicKey:h,senderPublicKey:u};await this.sendError({id:n,topic:f,error:s,encodeOpts:y,rpcOpts:We.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(a.requester.metadata,a.transportType)}),await this.client.auth.requests.delete(n,{message:"rejected",code:0}),await this.client.proposal.delete(n,be("USER_DISCONNECTED"))},this.formatAuthMessage=e=>{this.isInitialized();const{request:n,iss:s}=e;return pg(n,s)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)},this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{const n=this.client.core.pairing.pairings.get(e.pairingTopic),s=this.client.core.pairing.pairings.getAll().filter(a=>{var h,u;return((h=a.peerMetadata)==null?void 0:h.url)&&((u=a.peerMetadata)==null?void 0:u.url)===e.peer.metadata.url&&a.topic&&a.topic!==n.topic});if(s.length===0)return;this.client.logger.info(`Cleaning up ${s.length} duplicate pairing(s)`),await Promise.all(s.map(a=>this.client.core.pairing.disconnect({topic:a.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async e=>{var n;const{topic:s,expirerHasDeleted:a=!1,emitEvent:h=!0,id:u=0}=e,{self:f}=this.client.session.get(s);await this.client.core.relayer.unsubscribe(s),await this.client.session.delete(s,be("USER_DISCONNECTED")),this.addToRecentlyDeleted(s,"session"),this.client.core.crypto.keychain.has(f.publicKey)&&await this.client.core.crypto.deleteKeyPair(f.publicKey),this.client.core.crypto.keychain.has(s)&&await this.client.core.crypto.deleteSymKey(s),a||this.client.core.expirer.del(s),this.client.core.storage.removeItem(Zp).catch(y=>this.client.logger.warn(y)),this.getPendingSessionRequests().forEach(y=>{y.topic===s&&this.deletePendingSessionRequest(y.id,be("USER_DISCONNECTED"))}),s===((n=this.sessionRequestQueue.queue[0])==null?void 0:n.topic)&&(this.sessionRequestQueue.state=_i.idle),h&&this.client.events.emit("session_delete",{id:u,topic:s})},this.deleteProposal=async(e,n)=>{if(n)try{const s=this.client.proposal.get(e),a=this.client.core.eventClient.getEvent({topic:s.pairingTopic});a==null||a.setError(Nn.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,be("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")},this.deletePendingSessionRequest=async(e,n,s=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,n),s?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(a=>a.id!==e),s&&(this.sessionRequestQueue.state=_i.idle,this.client.events.emit("session_request_expire",{id:e}))},this.deletePendingAuthRequest=async(e,n,s=!1)=>{await Promise.all([this.client.auth.requests.delete(e,n),s?Promise.resolve():this.client.core.expirer.del(e)])},this.setExpiry=async(e,n)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,n),await this.client.session.update(e,{expiry:n}))},this.setProposal=async(e,n)=>{this.client.core.expirer.set(e,Qe(We.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,n)},this.setAuthRequest=async(e,n)=>{const{request:s,pairingTopic:a,transportType:h=xe.relay}=n;this.client.core.expirer.set(e,s.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:s.authPayload,requester:s.requester,expiryTimestamp:s.expiryTimestamp,id:e,pairingTopic:a,verifyContext:s.verifyContext,transportType:h})},this.setPendingSessionRequest=async e=>{const{id:n,topic:s,params:a,verifyContext:h}=e,u=a.request.expiryTimestamp||Qe(We.wc_sessionRequest.req.ttl);this.client.core.expirer.set(n,u),await this.client.pendingRequest.set(n,{id:n,topic:s,params:a,verifyContext:h})},this.sendRequest=async e=>{const{topic:n,method:s,params:a,expiry:h,relayRpcId:u,clientRpcId:f,throwOnFailedPublish:y,appLink:A}=e,x=Fn(s,a,f);let T;const R=!!A;try{const V=R?no:wn;T=await this.client.core.crypto.encode(n,x,{encoding:V})}catch(V){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${n} failed`),V}let $;if(bI.includes(s)){const V=Wi(JSON.stringify(x)),Z=Wi(T);$=await this.client.core.verify.register({id:Z,decryptedId:V})}const Q=We[s].req;if(Q.attestation=$,h&&(Q.ttl=h),u&&(Q.id=u),this.client.core.history.set(n,x),R){const V=Ma(A,n,T);await global.Linking.openURL(V,this.client.name)}else{const V=We[s].req;h&&(V.ttl=h),u&&(V.id=u),y?(V.internal=ni(Be({},V.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,T,V)):this.client.core.relayer.publish(n,T,V).catch(Z=>this.client.logger.error(Z))}return x.id},this.sendResult=async e=>{const{id:n,topic:s,result:a,throwOnFailedPublish:h,encodeOpts:u,appLink:f}=e,y=Wa(n,a);let A;const x=f&&typeof(global==null?void 0:global.Linking)<"u";try{const R=x?no:wn;A=await this.client.core.crypto.encode(s,y,ni(Be({},u||{}),{encoding:R}))}catch(R){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${s} failed`),R}let T;try{T=await this.client.core.history.get(s,n)}catch(R){throw this.client.logger.error(`sendResult() -> history.get(${s}, ${n}) failed`),R}if(x){const R=Ma(f,s,A);await global.Linking.openURL(R,this.client.name)}else{const R=We[T.request.method].res;h?(R.internal=ni(Be({},R.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,A,R)):this.client.core.relayer.publish(s,A,R).catch($=>this.client.logger.error($))}await this.client.core.history.resolve(y)},this.sendError=async e=>{const{id:n,topic:s,error:a,encodeOpts:h,rpcOpts:u,appLink:f}=e,y=vu(n,a);let A;const x=f&&typeof(global==null?void 0:global.Linking)<"u";try{const R=x?no:wn;A=await this.client.core.crypto.encode(s,y,ni(Be({},h||{}),{encoding:R}))}catch(R){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${s} failed`),R}let T;try{T=await this.client.core.history.get(s,n)}catch(R){throw this.client.logger.error(`sendError() -> history.get(${s}, ${n}) failed`),R}if(x){const R=Ma(f,s,A);await global.Linking.openURL(R,this.client.name)}else{const R=u||We[T.request.method].res;this.client.core.relayer.publish(s,A,R)}await this.client.core.history.resolve(y)},this.cleanup=async()=>{const e=[],n=[];this.client.session.getAll().forEach(s=>{let a=!1;gn(s.expiry)&&(a=!0),this.client.core.crypto.keychain.has(s.topic)||(a=!0),a&&e.push(s.topic)}),this.client.proposal.getAll().forEach(s=>{gn(s.expiryTimestamp)&&n.push(s.id)}),await Promise.all([...e.map(s=>this.deleteSession({topic:s})),...n.map(s=>this.deleteProposal(s))])},this.onRelayEventRequest=async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===_i.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=_i.active;const e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=_i.idle},this.processRequest=async e=>{const{topic:n,payload:s,attestation:a,transportType:h,encryptedId:u}=e,f=s.method;if(!this.shouldIgnorePairingRequest({topic:n,requestMethod:f}))switch(f){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:n,payload:s,attestation:a,encryptedId:u});case"wc_sessionSettle":return await this.onSessionSettleRequest(n,s);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(n,s);case"wc_sessionExtend":return await this.onSessionExtendRequest(n,s);case"wc_sessionPing":return await this.onSessionPingRequest(n,s);case"wc_sessionDelete":return await this.onSessionDeleteRequest(n,s);case"wc_sessionRequest":return await this.onSessionRequest({topic:n,payload:s,attestation:a,encryptedId:u,transportType:h});case"wc_sessionEvent":return await this.onSessionEventRequest(n,s);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:n,payload:s,attestation:a,encryptedId:u,transportType:h});default:return this.client.logger.info(`Unsupported request method ${f}`)}},this.onRelayEventResponse=async e=>{const{topic:n,payload:s,transportType:a}=e,h=(await this.client.core.history.get(n,s.id)).request.method;switch(h){case"wc_sessionPropose":return this.onSessionProposeResponse(n,s,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,s);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,s);case"wc_sessionExtend":return this.onSessionExtendResponse(n,s);case"wc_sessionPing":return this.onSessionPingResponse(n,s);case"wc_sessionRequest":return this.onSessionRequestResponse(n,s);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(n,s);default:return this.client.logger.info(`Unsupported response method ${h}`)}},this.onRelayEventUnknownPayload=e=>{const{topic:n}=e,{message:s}=ft("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(s)},this.shouldIgnorePairingRequest=e=>{const{topic:n,requestMethod:s}=e,a=this.expectedPairingMethodMap.get(n);return!a||a.includes(s)?!1:!!(a.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async e=>{const{topic:n,payload:s,attestation:a,encryptedId:h}=e,{params:u,id:f}=s;try{const y=this.client.core.eventClient.getEvent({topic:n});this.isValidConnect(Be({},s.params));const A=u.expiryTimestamp||Qe(We.wc_sessionPropose.req.ttl),x=Be({id:f,pairingTopic:n,expiryTimestamp:A},u);await this.setProposal(f,x);const T=await this.getVerifyContext({attestationId:a,hash:Wi(JSON.stringify(s)),encryptedId:h,metadata:x.proposer.metadata});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),y==null||y.setError(Ji.proposal_listener_not_found)),y==null||y.addTrace(Ai.emit_session_proposal),this.client.events.emit("session_proposal",{id:f,params:x,verifyContext:T})}catch(y){await this.sendError({id:f,topic:n,error:y,rpcOpts:We.wc_sessionPropose.autoReject}),this.client.logger.error(y)}},this.onSessionProposeResponse=async(e,n,s)=>{const{id:a}=n;if(Qi(n)){const{result:h}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:h});const u=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:u});const f=u.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const y=h.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:y});const A=await this.client.core.crypto.generateSharedKey(f,y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:A});const x=await this.client.core.relayer.subscribe(A,{transportType:s});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:x}),await this.client.core.pairing.activate({topic:e})}else if(Ei(n)){await this.client.proposal.delete(a,be("USER_DISCONNECTED"));const h=ae("session_connect");if(this.events.listenerCount(h)===0)throw new Error(`emitting ${h} without any listeners, 954`);this.events.emit(ae("session_connect"),{error:n.error})}},this.onSessionSettleRequest=async(e,n)=>{const{id:s,params:a}=n;try{this.isValidSessionSettleRequest(a);const{relay:h,controller:u,expiry:f,namespaces:y,sessionProperties:A,sessionConfig:x}=n.params,T=ni(Be(Be({topic:e,relay:h,expiry:f,namespaces:y,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:u.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:u.publicKey,metadata:u.metadata}},A&&{sessionProperties:A}),x&&{sessionConfig:x}),{transportType:xe.relay}),R=ae("session_connect");if(this.events.listenerCount(R)===0)throw new Error(`emitting ${R} without any listeners 997`);this.events.emit(ae("session_connect"),{session:T}),await this.sendResult({id:n.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(h){await this.sendError({id:s,topic:e,error:h}),this.client.logger.error(h)}},this.onSessionSettleResponse=async(e,n)=>{const{id:s}=n;Qi(n)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(ae("session_approve",s),{})):Ei(n)&&(await this.client.session.delete(e,be("USER_DISCONNECTED")),this.events.emit(ae("session_approve",s),{error:n.error}))},this.onSessionUpdateRequest=async(e,n)=>{const{params:s,id:a}=n;try{const h=`${e}_session_update`,u=so.get(h);if(u&&this.isRequestOutOfSync(u,a)){this.client.logger.info(`Discarding out of sync request - ${a}`),this.sendError({id:a,topic:e,error:be("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Be({topic:e},s));try{so.set(h,a),await this.client.session.update(e,{namespaces:s.namespaces}),await this.sendResult({id:a,topic:e,result:!0,throwOnFailedPublish:!0})}catch(f){throw so.delete(h),f}this.client.events.emit("session_update",{id:a,topic:e,params:s})}catch(h){await this.sendError({id:a,topic:e,error:h}),this.client.logger.error(h)}},this.isRequestOutOfSync=(e,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(e.toString().slice(0,-3)),this.onSessionUpdateResponse=(e,n)=>{const{id:s}=n,a=ae("session_update",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);Qi(n)?this.events.emit(ae("session_update",s),{}):Ei(n)&&this.events.emit(ae("session_update",s),{error:n.error})},this.onSessionExtendRequest=async(e,n)=>{const{id:s}=n;try{this.isValidExtend({topic:e}),await this.setExpiry(e,Qe(cs)),await this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:s,topic:e})}catch(a){await this.sendError({id:s,topic:e,error:a}),this.client.logger.error(a)}},this.onSessionExtendResponse=(e,n)=>{const{id:s}=n,a=ae("session_extend",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);Qi(n)?this.events.emit(ae("session_extend",s),{}):Ei(n)&&this.events.emit(ae("session_extend",s),{error:n.error})},this.onSessionPingRequest=async(e,n)=>{const{id:s}=n;try{this.isValidPing({topic:e}),await this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:s,topic:e})}catch(a){await this.sendError({id:s,topic:e,error:a}),this.client.logger.error(a)}},this.onSessionPingResponse=(e,n)=>{const{id:s}=n,a=ae("session_ping",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);setTimeout(()=>{Qi(n)?this.events.emit(ae("session_ping",s),{}):Ei(n)&&this.events.emit(ae("session_ping",s),{error:n.error})},500)},this.onSessionDeleteRequest=async(e,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:e,reason:n.params}),Promise.all([new Promise(a=>{this.client.core.relayer.once(lr.publish,async()=>{a(await this.deleteSession({topic:e,id:s}))})}),this.sendResult({id:s,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:be("USER_DISCONNECTED")})]).catch(a=>this.client.logger.error(a))}catch(a){this.client.logger.error(a)}},this.onSessionRequest=async e=>{var n,s,a;const{topic:h,payload:u,attestation:f,encryptedId:y,transportType:A}=e,{id:x,params:T}=u;try{await this.isValidRequest(Be({topic:h},T));const R=this.client.session.get(h),$=await this.getVerifyContext({attestationId:f,hash:Wi(JSON.stringify(Fn("wc_sessionRequest",T,x))),encryptedId:y,metadata:R.peer.metadata,transportType:A}),Q={id:x,topic:h,params:T,verifyContext:$};await this.setPendingSessionRequest(Q),A===xe.link_mode&&(n=R.peer.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp((s=R.peer.metadata.redirect)==null?void 0:s.universal),(a=this.client.signConfig)!=null&&a.disableRequestQueue?this.emitSessionRequest(Q):(this.addSessionRequestToSessionRequestQueue(Q),this.processSessionRequestQueue())}catch(R){await this.sendError({id:x,topic:h,error:R}),this.client.logger.error(R)}},this.onSessionRequestResponse=(e,n)=>{const{id:s}=n,a=ae("session_request",s);if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners`);Qi(n)?this.events.emit(ae("session_request",s),{result:n.result}):Ei(n)&&this.events.emit(ae("session_request",s),{error:n.error})},this.onSessionEventRequest=async(e,n)=>{const{id:s,params:a}=n;try{const h=`${e}_session_event_${a.event.name}`,u=so.get(h);if(u&&this.isRequestOutOfSync(u,s)){this.client.logger.info(`Discarding out of sync request - ${s}`);return}this.isValidEmit(Be({topic:e},a)),this.client.events.emit("session_event",{id:s,topic:e,params:a}),so.set(h,s)}catch(h){await this.sendError({id:s,topic:e,error:h}),this.client.logger.error(h)}},this.onSessionAuthenticateResponse=(e,n)=>{const{id:s}=n;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:n}),Qi(n)?this.events.emit(ae("session_request",s),{result:n.result}):Ei(n)&&this.events.emit(ae("session_request",s),{error:n.error})},this.onSessionAuthenticateRequest=async e=>{var n;const{topic:s,payload:a,attestation:h,encryptedId:u,transportType:f}=e;try{const{requester:y,authPayload:A,expiryTimestamp:x}=a.params,T=await this.getVerifyContext({attestationId:h,hash:Wi(JSON.stringify(a)),encryptedId:u,metadata:y.metadata,transportType:f}),R={requester:y,pairingTopic:s,id:a.id,authPayload:A,verifyContext:T,expiryTimestamp:x};await this.setAuthRequest(a.id,{request:R,pairingTopic:s,transportType:f}),f===xe.link_mode&&(n=y.metadata.redirect)!=null&&n.universal&&this.client.core.addLinkModeSupportedApp(y.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:s,params:a.params,id:a.id,verifyContext:T})}catch(y){this.client.logger.error(y);const A=a.params.requester.publicKey,x=await this.client.core.crypto.generateKeyPair(),T=this.getAppLinkIfEnabled(a.params.requester.metadata,f),R={type:tn,receiverPublicKey:A,senderPublicKey:x};await this.sendError({id:a.id,topic:s,error:y,encodeOpts:R,rpcOpts:We.wc_sessionAuthenticate.autoReject,appLink:T})}},this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=_i.idle,this.processSessionRequestQueue()},dt.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:e,error:n})=>{const s=this.client.core.history.pending;s.length>0&&s.filter(a=>a.topic===e&&a.request.method==="wc_sessionRequest").forEach(a=>{const h=a.request.id,u=ae("session_request",h);if(this.events.listenerCount(u)===0)throw new Error(`emitting ${u} without any listeners`);this.events.emit(ae("session_request",a.request.id),{error:n})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===_i.active){this.client.logger.info("session request queue is already active.");return}const e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=_i.active,this.emitSessionRequest(e)}catch(n){this.client.logger.error(n)}},this.emitSessionRequest=e=>{this.client.events.emit("session_request",e)},this.onPairingCreated=e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;const n=this.client.proposal.getAll().find(s=>s.pairingTopic===e.topic);n&&this.onSessionProposeRequest({topic:e.topic,payload:Fn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id)})},this.isValidConnect=async e=>{if(!_r(e)){const{message:f}=ft("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw new Error(f)}const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:h,relays:u}=e;if(dr(n)||await this.isValidPairingTopic(n),!HA(u)){const{message:f}=ft("MISSING_OR_INVALID",`connect() relays: ${u}`);throw new Error(f)}!dr(s)&&Eo(s)!==0&&this.validateNamespaces(s,"requiredNamespaces"),!dr(a)&&Eo(a)!==0&&this.validateNamespaces(a,"optionalNamespaces"),dr(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(e,n)=>{const s=zA(e,"connect()",n);if(s)throw new Error(s.message)},this.isValidApprove=async e=>{if(!_r(e))throw new Error(ft("MISSING_OR_INVALID",`approve() params: ${e}`).message);const{id:n,namespaces:s,relayProtocol:a,sessionProperties:h}=e;this.checkRecentlyDeleted(n),await this.isValidProposalId(n);const u=this.client.proposal.get(n),f=Hh(s,"approve()");if(f)throw new Error(f.message);const y=Pp(u.requiredNamespaces,s,"approve()");if(y)throw new Error(y.message);if(!ze(a,!0)){const{message:A}=ft("MISSING_OR_INVALID",`approve() relayProtocol: ${a}`);throw new Error(A)}dr(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async e=>{if(!_r(e)){const{message:a}=ft("MISSING_OR_INVALID",`reject() params: ${e}`);throw new Error(a)}const{id:n,reason:s}=e;if(this.checkRecentlyDeleted(n),await this.isValidProposalId(n),!VA(s)){const{message:a}=ft("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidSessionSettleRequest=e=>{if(!_r(e)){const{message:y}=ft("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw new Error(y)}const{relay:n,controller:s,namespaces:a,expiry:h}=e;if(!Ag(n)){const{message:y}=ft("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const u=UA(s,"onSessionSettleRequest()");if(u)throw new Error(u.message);const f=Hh(a,"onSessionSettleRequest()");if(f)throw new Error(f.message);if(gn(h)){const{message:y}=ft("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async e=>{if(!_r(e)){const{message:f}=ft("MISSING_OR_INVALID",`update() params: ${e}`);throw new Error(f)}const{topic:n,namespaces:s}=e;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const a=this.client.session.get(n),h=Hh(s,"update()");if(h)throw new Error(h.message);const u=Pp(a.requiredNamespaces,s,"update()");if(u)throw new Error(u.message)},this.isValidExtend=async e=>{if(!_r(e)){const{message:s}=ft("MISSING_OR_INVALID",`extend() params: ${e}`);throw new Error(s)}const{topic:n}=e;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n)},this.isValidRequest=async e=>{if(!_r(e)){const{message:f}=ft("MISSING_OR_INVALID",`request() params: ${e}`);throw new Error(f)}const{topic:n,request:s,chainId:a,expiry:h}=e;this.checkRecentlyDeleted(n),await this.isValidSessionTopic(n);const{namespaces:u}=this.client.session.get(n);if(!Mp(u,a)){const{message:f}=ft("MISSING_OR_INVALID",`request() chainId: ${a}`);throw new Error(f)}if(!GA(s)){const{message:f}=ft("MISSING_OR_INVALID",`request() ${JSON.stringify(s)}`);throw new Error(f)}if(!YA(u,a,s.method)){const{message:f}=ft("MISSING_OR_INVALID",`request() method: ${s.method}`);throw new Error(f)}if(h&&!tE(h,Jh)){const{message:f}=ft("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${Jh.min} and ${Jh.max}`);throw new Error(f)}},this.isValidRespond=async e=>{var n;if(!_r(e)){const{message:h}=ft("MISSING_OR_INVALID",`respond() params: ${e}`);throw new Error(h)}const{topic:s,response:a}=e;try{await this.isValidSessionTopic(s)}catch(h){throw(n=e==null?void 0:e.response)!=null&&n.id&&this.cleanupAfterResponse(e),h}if(!QA(a)){const{message:h}=ft("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(a)}`);throw new Error(h)}},this.isValidPing=async e=>{if(!_r(e)){const{message:s}=ft("MISSING_OR_INVALID",`ping() params: ${e}`);throw new Error(s)}const{topic:n}=e;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async e=>{if(!_r(e)){const{message:u}=ft("MISSING_OR_INVALID",`emit() params: ${e}`);throw new Error(u)}const{topic:n,event:s,chainId:a}=e;await this.isValidSessionTopic(n);const{namespaces:h}=this.client.session.get(n);if(!Mp(h,a)){const{message:u}=ft("MISSING_OR_INVALID",`emit() chainId: ${a}`);throw new Error(u)}if(!JA(s)){const{message:u}=ft("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(u)}if(!WA(h,a,s.name)){const{message:u}=ft("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(s)}`);throw new Error(u)}},this.isValidDisconnect=async e=>{if(!_r(e)){const{message:s}=ft("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw new Error(s)}const{topic:n}=e;await this.isValidSessionOrPairingTopic(n)},this.isValidAuthenticate=e=>{const{chains:n,uri:s,domain:a,nonce:h}=e;if(!Array.isArray(n)||n.length===0)throw new Error("chains is required and must be a non-empty array");if(!ze(s,!1))throw new Error("uri is required parameter");if(!ze(a,!1))throw new Error("domain is required parameter");if(!ze(h,!1))throw new Error("nonce is required parameter");if([...new Set(n.map(f=>go(f).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:u}=go(n[0]);if(u!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async e=>{const{attestationId:n,hash:s,encryptedId:a,metadata:h,transportType:u}=e,f={verified:{verifyUrl:h.verifyUrl||wo,validation:"UNKNOWN",origin:h.url||""}};try{if(u===xe.link_mode){const A=this.getAppLinkIfEnabled(h,u);return f.verified.validation=A&&new URL(A).origin===new URL(h.url).origin?"VALID":"INVALID",f}const y=await this.client.core.verify.resolve({attestationId:n,hash:s,encryptedId:a,verifyUrl:h.verifyUrl});y&&(f.verified.origin=y.origin,f.verified.isScam=y.isScam,f.verified.validation=y.origin===new URL(h.url).origin?"VALID":"INVALID")}catch(y){this.client.logger.warn(y)}return this.client.logger.debug(`Verify context: ${JSON.stringify(f)}`),f},this.validateSessionProps=(e,n)=>{Object.values(e).forEach(s=>{if(!ze(s,!1)){const{message:a}=ft("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(s)}`);throw new Error(a)}})},this.getPendingAuthRequest=e=>{const n=this.client.auth.requests.get(e);return typeof n=="object"?n:void 0},this.addToRecentlyDeleted=(e,n)=>{if(this.recentlyDeletedMap.set(e,n),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let s=0;const a=this.recentlyDeletedLimit/2;for(const h of this.recentlyDeletedMap.keys()){if(s++>=a)break;this.recentlyDeletedMap.delete(h)}}},this.checkRecentlyDeleted=e=>{const n=this.recentlyDeletedMap.get(e);if(n){const{message:s}=ft("MISSING_OR_INVALID",`Record was recently deleted - ${n}: ${e}`);throw new Error(s)}},this.isLinkModeEnabled=(e,n)=>{var s,a,h,u,f,y,A,x,T;return!e||n!==xe.link_mode?!1:((a=(s=this.client.metadata)==null?void 0:s.redirect)==null?void 0:a.linkMode)===!0&&((u=(h=this.client.metadata)==null?void 0:h.redirect)==null?void 0:u.universal)!==void 0&&((y=(f=this.client.metadata)==null?void 0:f.redirect)==null?void 0:y.universal)!==""&&((A=e==null?void 0:e.redirect)==null?void 0:A.universal)!==void 0&&((x=e==null?void 0:e.redirect)==null?void 0:x.universal)!==""&&((T=e==null?void 0:e.redirect)==null?void 0:T.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&typeof(global==null?void 0:global.Linking)<"u"},this.getAppLinkIfEnabled=(e,n)=>{var s;return this.isLinkModeEnabled(e,n)?(s=e==null?void 0:e.redirect)==null?void 0:s.universal:void 0},this.handleLinkModeMessage=({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;const n=jd(e,"topic")||"",s=decodeURIComponent(jd(e,"wc_ev")||""),a=this.client.session.keys.includes(n);a&&this.client.session.update(n,{transportType:xe.link_mode}),this.client.core.dispatchEnvelope({topic:n,message:s,sessionExists:a})},this.registerLinkModeListeners=async()=>{var e;if(Su()||_s()&&(e=this.client.metadata.redirect)!=null&&e.linkMode){const n=global==null?void 0:global.Linking;if(typeof n<"u"){n.addEventListener("url",this.handleLinkModeMessage,this.client.name);const s=await n.getInitialURL();s&&setTimeout(()=>{this.handleLinkModeMessage({url:s})},50)}}}}isInitialized(){if(!this.initialized){const{message:t}=ft("NOT_INITIALIZED",this.name);throw new Error(t)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(lr.message,t=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(t):this.onRelayMessage(t)})}async onRelayMessage(t){const{topic:e,message:n,attestation:s,transportType:a}=t,{publicKey:h}=this.client.auth.authKeys.keys.includes(Ua)?this.client.auth.authKeys.get(Ua):{publicKey:void 0},u=await this.client.core.crypto.decode(e,n,{receiverPublicKey:h,encoding:a===xe.link_mode?no:wn});try{wu(u)?(this.client.core.history.set(e,u),this.onRelayEventRequest({topic:e,payload:u,attestation:s,transportType:a,encryptedId:Wi(n)})):bu(u)?(await this.client.core.history.resolve(u),await this.onRelayEventResponse({topic:e,payload:u,transportType:a}),this.client.core.history.delete(e,u.id)):this.onRelayEventUnknownPayload({topic:e,payload:u,transportType:a})}catch(f){this.client.logger.error(f)}}registerExpirerEvents(){this.client.core.expirer.on(Gr.expired,async t=>{const{topic:e,id:n}=R0(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,ft("EXPIRED"),!0);if(n&&this.client.auth.requests.keys.includes(n))return await this.deletePendingAuthRequest(n,ft("EXPIRED"),!0);e?this.client.session.keys.includes(e)&&(await this.deleteSession({topic:e,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:e})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Tn.create,t=>this.onPairingCreated(t)),this.client.core.pairing.events.on(Tn.delete,t=>{this.addToRecentlyDeleted(t.topic,"pairing")})}isValidPairingTopic(t){if(!ze(t,!1)){const{message:e}=ft("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(e)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:e}=ft("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(e)}if(gn(this.client.core.pairing.pairings.get(t).expiry)){const{message:e}=ft("EXPIRED",`pairing topic: ${t}`);throw new Error(e)}}async isValidSessionTopic(t){if(!ze(t,!1)){const{message:e}=ft("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(e)}if(this.checkRecentlyDeleted(t),!this.client.session.keys.includes(t)){const{message:e}=ft("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(e)}if(gn(this.client.session.get(t).expiry)){await this.deleteSession({topic:t});const{message:e}=ft("EXPIRED",`session topic: ${t}`);throw new Error(e)}if(!this.client.core.crypto.keychain.has(t)){const{message:e}=ft("MISSING_OR_INVALID",`session topic does not exist in keychain: ${t}`);throw await this.deleteSession({topic:t}),new Error(e)}}async isValidSessionOrPairingTopic(t){if(this.checkRecentlyDeleted(t),this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(ze(t,!1)){const{message:e}=ft("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(e)}else{const{message:e}=ft("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(e)}}async isValidProposalId(t){if(!KA(t)){const{message:e}=ft("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(e)}if(!this.client.proposal.keys.includes(t)){const{message:e}=ft("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(e)}if(gn(this.client.proposal.get(t).expiryTimestamp)){await this.deleteProposal(t);const{message:e}=ft("EXPIRED",`proposal id: ${t}`);throw new Error(e)}}}class OI extends kn{constructor(t,e){super(t,e,mI,qu),this.core=t,this.logger=e}}class TI extends kn{constructor(t,e){super(t,e,vI,qu),this.core=t,this.logger=e}}class FI extends kn{constructor(t,e){super(t,e,wI,qu,n=>n.id),this.core=t,this.logger=e}}class DI extends kn{constructor(t,e){super(t,e,EI,ic,()=>Ua),this.core=t,this.logger=e}}class qI extends kn{constructor(t,e){super(t,e,II,ic),this.core=t,this.logger=e}}class UI extends kn{constructor(t,e){super(t,e,SI,ic,n=>n.id),this.core=t,this.logger=e}}class BI{constructor(t,e){this.core=t,this.logger=e,this.authKeys=new DI(this.core,this.logger),this.pairingTopics=new qI(this.core,this.logger),this.requests=new UI(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class Uu extends yE{constructor(t){super(t),this.protocol=kg,this.version=$g,this.name=Qh.name,this.events=new en.EventEmitter,this.on=(n,s)=>this.events.on(n,s),this.once=(n,s)=>this.events.once(n,s),this.off=(n,s)=>this.events.off(n,s),this.removeListener=(n,s)=>this.events.removeListener(n,s),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(s){throw this.logger.error(s.message),s}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(s){throw this.logger.error(s.message),s}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(s){throw this.logger.error(s.message),s}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(s){throw this.logger.error(s.message),s}},this.update=async n=>{try{return await this.engine.update(n)}catch(s){throw this.logger.error(s.message),s}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(s){throw this.logger.error(s.message),s}},this.request=async n=>{try{return await this.engine.request(n)}catch(s){throw this.logger.error(s.message),s}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(s){throw this.logger.error(s.message),s}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(s){throw this.logger.error(s.message),s}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(s){throw this.logger.error(s.message),s}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(s){throw this.logger.error(s.message),s}},this.find=n=>{try{return this.engine.find(n)}catch(s){throw this.logger.error(s.message),s}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.authenticate=async(n,s)=>{try{return await this.engine.authenticate(n,s)}catch(a){throw this.logger.error(a.message),a}},this.formatAuthMessage=n=>{try{return this.engine.formatAuthMessage(n)}catch(s){throw this.logger.error(s.message),s}},this.approveSessionAuthenticate=async n=>{try{return await this.engine.approveSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}},this.rejectSessionAuthenticate=async n=>{try{return await this.engine.rejectSessionAuthenticate(n)}catch(s){throw this.logger.error(s.message),s}},this.name=(t==null?void 0:t.name)||Qh.name,this.metadata=(t==null?void 0:t.metadata)||x0(),this.signConfig=t==null?void 0:t.signConfig;const e=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:yu(Ya({level:(t==null?void 0:t.logger)||Qh.logger}));this.core=(t==null?void 0:t.core)||new gI(t),this.logger=gr(e,this.name),this.session=new TI(this.core,this.logger),this.proposal=new OI(this.core,this.logger),this.pendingRequest=new FI(this.core,this.logger),this.engine=new RI(this),this.auth=new BI(this.core,this.logger)}static async init(t){const e=new Uu(t);return await e.initialize(),e}get context(){return Dr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const r0="error",LI="wss://relay.walletconnect.org",kI="wc",$I="universal_provider",i0=`${kI}@2:${$I}:`,Hg="https://rpc.walletconnect.org/v1/",us="generic",jI=`${Hg}bundler`,li={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var uo=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},du={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(r,t){(function(){var e,n="4.17.21",s=200,a="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",u="Invalid `variable` option passed into `_.template`",f="__lodash_hash_undefined__",y=500,A="__lodash_placeholder__",x=1,T=2,R=4,$=1,Q=2,V=1,Z=2,H=4,J=8,B=16,k=32,z=64,w=128,q=256,ht=512,ut=30,lt="...",gt=800,l=16,v=1,m=2,b=3,E=1/0,P=9007199254740991,O=17976931348623157e292,S=NaN,d=4294967295,C=d-1,X=d>>>1,rt=[["ary",w],["bind",V],["bindKey",Z],["curry",J],["curryRight",B],["flip",ht],["partial",k],["partialRight",z],["rearg",q]],_="[object Arguments]",W="[object Array]",D="[object AsyncFunction]",U="[object Boolean]",L="[object Date]",p="[object DOMException]",F="[object Error]",et="[object Function]",st="[object GeneratorFunction]",at="[object Map]",It="[object Number]",xt="[object Null]",At="[object Object]",me="[object Promise]",Ut="[object Proxy]",Et="[object RegExp]",Ot="[object Set]",yt="[object String]",wt="[object Symbol]",Bt="[object Undefined]",mt="[object WeakMap]",bt="[object WeakSet]",Tt="[object ArrayBuffer]",_t="[object DataView]",St="[object Float32Array]",Wt="[object Float64Array]",Mt="[object Int8Array]",Ct="[object Int16Array]",ee="[object Int32Array]",Nt="[object Uint8Array]",Rt="[object Uint8ClampedArray]",He="[object Uint16Array]",se="[object Uint32Array]",fe=/\b__p \+= '';/g,or=/\b(__p \+=) '' \+/g,de=/(__e\(.*?\)|\b__t\)) \+\n'';/g,pe=/&(?:amp|lt|gt|quot|#39);/g,Sr=/[&<>"']/g,$t=RegExp(pe.source),jt=RegExp(Sr.source),Me=/<%-([\s\S]+?)%>/g,zt=/<%([\s\S]+?)%>/g,kt=/<%=([\s\S]+?)%>/g,Pe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ht=/^\w*$/,Kt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,_e=/[\\^$.*+?()[\]{}|]/g,Vt=RegExp(_e.source),Lt=/^\s+/,Ce=/\s/,Gt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qt=/\{\n\/\* \[wrapped with (.+)\] \*/,Ne=/,? & /,Jt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ee=/[()=,{}\[\]\/\s]/,Ui=/\\(\\)?/g,Ie=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ae=/\w*$/,fi=/^[-+]0x[0-9a-f]+$/i,di=/^0b[01]+$/i,pi=/^\[object .+?Constructor\]$/,gi=/^0o[0-7]+$/i,mi=/^(?:0|[1-9]\d*)$/,vi=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,rn=/($^)/,Ps=/['\n\r\u2028\u2029\\]/g,nn="\\ud800-\\udfff",Cs="\\u0300-\\u036f",Ns="\\ufe20-\\ufe2f",Rs="\\u20d0-\\u20ff",zn=Cs+Ns+Rs,Hn="\\u2700-\\u27bf",Kn="a-z\\xdf-\\xf6\\xf8-\\xff",Os="\\xac\\xb1\\xd7\\xf7",Ts="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Fs="\\u2000-\\u206f",Ds=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ku="A-Z\\xc0-\\xd6\\xd8-\\xde",$u="\\ufe0e\\ufe0f",ju=Os+Ts+Fs+Ds,nc="['’]",Gg="["+nn+"]",zu="["+ju+"]",To="["+zn+"]",Hu="\\d+",Qg="["+Hn+"]",Ku="["+Kn+"]",Vu="[^"+nn+ju+Hu+Hn+Kn+ku+"]",sc="\\ud83c[\\udffb-\\udfff]",Jg="(?:"+To+"|"+sc+")",Gu="[^"+nn+"]",oc="(?:\\ud83c[\\udde6-\\uddff]){2}",ac="[\\ud800-\\udbff][\\udc00-\\udfff]",Vn="["+ku+"]",Qu="\\u200d",Ju="(?:"+Ku+"|"+Vu+")",Yg="(?:"+Vn+"|"+Vu+")",Yu="(?:"+nc+"(?:d|ll|m|re|s|t|ve))?",Wu="(?:"+nc+"(?:D|LL|M|RE|S|T|VE))?",Xu=Jg+"?",Zu="["+$u+"]?",Wg="(?:"+Qu+"(?:"+[Gu,oc,ac].join("|")+")"+Zu+Xu+")*",Xg="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Zg="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",tl=Zu+Xu+Wg,t1="(?:"+[Qg,oc,ac].join("|")+")"+tl,e1="(?:"+[Gu+To+"?",To,oc,ac,Gg].join("|")+")",r1=RegExp(nc,"g"),i1=RegExp(To,"g"),cc=RegExp(sc+"(?="+sc+")|"+e1+tl,"g"),n1=RegExp([Vn+"?"+Ku+"+"+Yu+"(?="+[zu,Vn,"$"].join("|")+")",Yg+"+"+Wu+"(?="+[zu,Vn+Ju,"$"].join("|")+")",Vn+"?"+Ju+"+"+Yu,Vn+"+"+Wu,Zg,Xg,Hu,t1].join("|"),"g"),s1=RegExp("["+Qu+nn+zn+$u+"]"),o1=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,a1=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],c1=-1,Te={};Te[St]=Te[Wt]=Te[Mt]=Te[Ct]=Te[ee]=Te[Nt]=Te[Rt]=Te[He]=Te[se]=!0,Te[_]=Te[W]=Te[Tt]=Te[U]=Te[_t]=Te[L]=Te[F]=Te[et]=Te[at]=Te[It]=Te[At]=Te[Et]=Te[Ot]=Te[yt]=Te[mt]=!1;var Re={};Re[_]=Re[W]=Re[Tt]=Re[_t]=Re[U]=Re[L]=Re[St]=Re[Wt]=Re[Mt]=Re[Ct]=Re[ee]=Re[at]=Re[It]=Re[At]=Re[Et]=Re[Ot]=Re[yt]=Re[wt]=Re[Nt]=Re[Rt]=Re[He]=Re[se]=!0,Re[F]=Re[et]=Re[mt]=!1;var h1={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},u1={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},l1={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},f1={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},d1=parseFloat,p1=parseInt,el=typeof uo=="object"&&uo&&uo.Object===Object&&uo,g1=typeof self=="object"&&self&&self.Object===Object&&self,Xe=el||g1||Function("return this")(),hc=t&&!t.nodeType&&t,bn=hc&&!0&&r&&!r.nodeType&&r,rl=bn&&bn.exports===hc,uc=rl&&el.process,qr=function(){try{var G=bn&&bn.require&&bn.require("util").types;return G||uc&&uc.binding&&uc.binding("util")}catch{}}(),il=qr&&qr.isArrayBuffer,nl=qr&&qr.isDate,sl=qr&&qr.isMap,ol=qr&&qr.isRegExp,al=qr&&qr.isSet,cl=qr&&qr.isTypedArray;function xr(G,it,tt){switch(tt.length){case 0:return G.call(it);case 1:return G.call(it,tt[0]);case 2:return G.call(it,tt[0],tt[1]);case 3:return G.call(it,tt[0],tt[1],tt[2])}return G.apply(it,tt)}function m1(G,it,tt,vt){for(var Yt=-1,ge=G==null?0:G.length;++Yt<ge;){var Ke=G[Yt];it(vt,Ke,tt(Ke),G)}return vt}function Ur(G,it){for(var tt=-1,vt=G==null?0:G.length;++tt<vt&&it(G[tt],tt,G)!==!1;);return G}function v1(G,it){for(var tt=G==null?0:G.length;tt--&&it(G[tt],tt,G)!==!1;);return G}function hl(G,it){for(var tt=-1,vt=G==null?0:G.length;++tt<vt;)if(!it(G[tt],tt,G))return!1;return!0}function sn(G,it){for(var tt=-1,vt=G==null?0:G.length,Yt=0,ge=[];++tt<vt;){var Ke=G[tt];it(Ke,tt,G)&&(ge[Yt++]=Ke)}return ge}function Fo(G,it){var tt=G==null?0:G.length;return!!tt&&Gn(G,it,0)>-1}function lc(G,it,tt){for(var vt=-1,Yt=G==null?0:G.length;++vt<Yt;)if(tt(it,G[vt]))return!0;return!1}function De(G,it){for(var tt=-1,vt=G==null?0:G.length,Yt=Array(vt);++tt<vt;)Yt[tt]=it(G[tt],tt,G);return Yt}function on(G,it){for(var tt=-1,vt=it.length,Yt=G.length;++tt<vt;)G[Yt+tt]=it[tt];return G}function fc(G,it,tt,vt){var Yt=-1,ge=G==null?0:G.length;for(vt&&ge&&(tt=G[++Yt]);++Yt<ge;)tt=it(tt,G[Yt],Yt,G);return tt}function y1(G,it,tt,vt){var Yt=G==null?0:G.length;for(vt&&Yt&&(tt=G[--Yt]);Yt--;)tt=it(tt,G[Yt],Yt,G);return tt}function dc(G,it){for(var tt=-1,vt=G==null?0:G.length;++tt<vt;)if(it(G[tt],tt,G))return!0;return!1}var w1=pc("length");function b1(G){return G.split("")}function _1(G){return G.match(Jt)||[]}function ul(G,it,tt){var vt;return tt(G,function(Yt,ge,Ke){if(it(Yt,ge,Ke))return vt=ge,!1}),vt}function Do(G,it,tt,vt){for(var Yt=G.length,ge=tt+(vt?1:-1);vt?ge--:++ge<Yt;)if(it(G[ge],ge,G))return ge;return-1}function Gn(G,it,tt){return it===it?T1(G,it,tt):Do(G,ll,tt)}function A1(G,it,tt,vt){for(var Yt=tt-1,ge=G.length;++Yt<ge;)if(vt(G[Yt],it))return Yt;return-1}function ll(G){return G!==G}function fl(G,it){var tt=G==null?0:G.length;return tt?mc(G,it)/tt:S}function pc(G){return function(it){return it==null?e:it[G]}}function gc(G){return function(it){return G==null?e:G[it]}}function dl(G,it,tt,vt,Yt){return Yt(G,function(ge,Ke,Se){tt=vt?(vt=!1,ge):it(tt,ge,Ke,Se)}),tt}function E1(G,it){var tt=G.length;for(G.sort(it);tt--;)G[tt]=G[tt].value;return G}function mc(G,it){for(var tt,vt=-1,Yt=G.length;++vt<Yt;){var ge=it(G[vt]);ge!==e&&(tt=tt===e?ge:tt+ge)}return tt}function vc(G,it){for(var tt=-1,vt=Array(G);++tt<G;)vt[tt]=it(tt);return vt}function I1(G,it){return De(it,function(tt){return[tt,G[tt]]})}function pl(G){return G&&G.slice(0,yl(G)+1).replace(Lt,"")}function Mr(G){return function(it){return G(it)}}function yc(G,it){return De(it,function(tt){return G[tt]})}function qs(G,it){return G.has(it)}function gl(G,it){for(var tt=-1,vt=G.length;++tt<vt&&Gn(it,G[tt],0)>-1;);return tt}function ml(G,it){for(var tt=G.length;tt--&&Gn(it,G[tt],0)>-1;);return tt}function S1(G,it){for(var tt=G.length,vt=0;tt--;)G[tt]===it&&++vt;return vt}var x1=gc(h1),M1=gc(u1);function P1(G){return"\\"+f1[G]}function C1(G,it){return G==null?e:G[it]}function Qn(G){return s1.test(G)}function N1(G){return o1.test(G)}function R1(G){for(var it,tt=[];!(it=G.next()).done;)tt.push(it.value);return tt}function wc(G){var it=-1,tt=Array(G.size);return G.forEach(function(vt,Yt){tt[++it]=[Yt,vt]}),tt}function vl(G,it){return function(tt){return G(it(tt))}}function an(G,it){for(var tt=-1,vt=G.length,Yt=0,ge=[];++tt<vt;){var Ke=G[tt];(Ke===it||Ke===A)&&(G[tt]=A,ge[Yt++]=tt)}return ge}function qo(G){var it=-1,tt=Array(G.size);return G.forEach(function(vt){tt[++it]=vt}),tt}function O1(G){var it=-1,tt=Array(G.size);return G.forEach(function(vt){tt[++it]=[vt,vt]}),tt}function T1(G,it,tt){for(var vt=tt-1,Yt=G.length;++vt<Yt;)if(G[vt]===it)return vt;return-1}function F1(G,it,tt){for(var vt=tt+1;vt--;)if(G[vt]===it)return vt;return vt}function Jn(G){return Qn(G)?q1(G):w1(G)}function Wr(G){return Qn(G)?U1(G):b1(G)}function yl(G){for(var it=G.length;it--&&Ce.test(G.charAt(it)););return it}var D1=gc(l1);function q1(G){for(var it=cc.lastIndex=0;cc.test(G);)++it;return it}function U1(G){return G.match(cc)||[]}function B1(G){return G.match(n1)||[]}var L1=function G(it){it=it==null?Xe:Yn.defaults(Xe.Object(),it,Yn.pick(Xe,a1));var tt=it.Array,vt=it.Date,Yt=it.Error,ge=it.Function,Ke=it.Math,Se=it.Object,bc=it.RegExp,k1=it.String,Br=it.TypeError,Uo=tt.prototype,$1=ge.prototype,Wn=Se.prototype,Bo=it["__core-js_shared__"],Lo=$1.toString,we=Wn.hasOwnProperty,j1=0,wl=function(){var i=/[^.]+$/.exec(Bo&&Bo.keys&&Bo.keys.IE_PROTO||"");return i?"Symbol(src)_1."+i:""}(),ko=Wn.toString,z1=Lo.call(Se),H1=Xe._,K1=bc("^"+Lo.call(we).replace(_e,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),$o=rl?it.Buffer:e,cn=it.Symbol,jo=it.Uint8Array,bl=$o?$o.allocUnsafe:e,zo=vl(Se.getPrototypeOf,Se),_l=Se.create,Al=Wn.propertyIsEnumerable,Ho=Uo.splice,El=cn?cn.isConcatSpreadable:e,Us=cn?cn.iterator:e,_n=cn?cn.toStringTag:e,Ko=function(){try{var i=xn(Se,"defineProperty");return i({},"",{}),i}catch{}}(),V1=it.clearTimeout!==Xe.clearTimeout&&it.clearTimeout,G1=vt&&vt.now!==Xe.Date.now&&vt.now,Q1=it.setTimeout!==Xe.setTimeout&&it.setTimeout,Vo=Ke.ceil,Go=Ke.floor,_c=Se.getOwnPropertySymbols,J1=$o?$o.isBuffer:e,Il=it.isFinite,Y1=Uo.join,W1=vl(Se.keys,Se),Ve=Ke.max,ir=Ke.min,X1=vt.now,Z1=it.parseInt,Sl=Ke.random,tm=Uo.reverse,Ac=xn(it,"DataView"),Bs=xn(it,"Map"),Ec=xn(it,"Promise"),Xn=xn(it,"Set"),Ls=xn(it,"WeakMap"),ks=xn(Se,"create"),Qo=Ls&&new Ls,Zn={},em=Mn(Ac),rm=Mn(Bs),im=Mn(Ec),nm=Mn(Xn),sm=Mn(Ls),Jo=cn?cn.prototype:e,$s=Jo?Jo.valueOf:e,xl=Jo?Jo.toString:e;function M(i){if(Ue(i)&&!Xt(i)&&!(i instanceof ce)){if(i instanceof Lr)return i;if(we.call(i,"__wrapped__"))return Pf(i)}return new Lr(i)}var ts=function(){function i(){}return function(o){if(!qe(o))return{};if(_l)return _l(o);i.prototype=o;var c=new i;return i.prototype=e,c}}();function Yo(){}function Lr(i,o){this.__wrapped__=i,this.__actions__=[],this.__chain__=!!o,this.__index__=0,this.__values__=e}M.templateSettings={escape:Me,evaluate:zt,interpolate:kt,variable:"",imports:{_:M}},M.prototype=Yo.prototype,M.prototype.constructor=M,Lr.prototype=ts(Yo.prototype),Lr.prototype.constructor=Lr;function ce(i){this.__wrapped__=i,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=d,this.__views__=[]}function om(){var i=new ce(this.__wrapped__);return i.__actions__=mr(this.__actions__),i.__dir__=this.__dir__,i.__filtered__=this.__filtered__,i.__iteratees__=mr(this.__iteratees__),i.__takeCount__=this.__takeCount__,i.__views__=mr(this.__views__),i}function am(){if(this.__filtered__){var i=new ce(this);i.__dir__=-1,i.__filtered__=!0}else i=this.clone(),i.__dir__*=-1;return i}function cm(){var i=this.__wrapped__.value(),o=this.__dir__,c=Xt(i),g=o<0,I=c?i.length:0,N=bv(0,I,this.__views__),j=N.start,K=N.end,Y=K-j,nt=g?K:j-1,ot=this.__iteratees__,ct=ot.length,pt=0,Pt=ir(Y,this.__takeCount__);if(!c||!g&&I==Y&&Pt==Y)return Yl(i,this.__actions__);var Dt=[];t:for(;Y--&&pt<Pt;){nt+=o;for(var re=-1,qt=i[nt];++re<ct;){var oe=ot[re],le=oe.iteratee,Nr=oe.type,hr=le(qt);if(Nr==m)qt=hr;else if(!hr){if(Nr==v)continue t;break t}}Dt[pt++]=qt}return Dt}ce.prototype=ts(Yo.prototype),ce.prototype.constructor=ce;function An(i){var o=-1,c=i==null?0:i.length;for(this.clear();++o<c;){var g=i[o];this.set(g[0],g[1])}}function hm(){this.__data__=ks?ks(null):{},this.size=0}function um(i){var o=this.has(i)&&delete this.__data__[i];return this.size-=o?1:0,o}function lm(i){var o=this.__data__;if(ks){var c=o[i];return c===f?e:c}return we.call(o,i)?o[i]:e}function fm(i){var o=this.__data__;return ks?o[i]!==e:we.call(o,i)}function dm(i,o){var c=this.__data__;return this.size+=this.has(i)?0:1,c[i]=ks&&o===e?f:o,this}An.prototype.clear=hm,An.prototype.delete=um,An.prototype.get=lm,An.prototype.has=fm,An.prototype.set=dm;function Bi(i){var o=-1,c=i==null?0:i.length;for(this.clear();++o<c;){var g=i[o];this.set(g[0],g[1])}}function pm(){this.__data__=[],this.size=0}function gm(i){var o=this.__data__,c=Wo(o,i);if(c<0)return!1;var g=o.length-1;return c==g?o.pop():Ho.call(o,c,1),--this.size,!0}function mm(i){var o=this.__data__,c=Wo(o,i);return c<0?e:o[c][1]}function vm(i){return Wo(this.__data__,i)>-1}function ym(i,o){var c=this.__data__,g=Wo(c,i);return g<0?(++this.size,c.push([i,o])):c[g][1]=o,this}Bi.prototype.clear=pm,Bi.prototype.delete=gm,Bi.prototype.get=mm,Bi.prototype.has=vm,Bi.prototype.set=ym;function Li(i){var o=-1,c=i==null?0:i.length;for(this.clear();++o<c;){var g=i[o];this.set(g[0],g[1])}}function wm(){this.size=0,this.__data__={hash:new An,map:new(Bs||Bi),string:new An}}function bm(i){var o=ha(this,i).delete(i);return this.size-=o?1:0,o}function _m(i){return ha(this,i).get(i)}function Am(i){return ha(this,i).has(i)}function Em(i,o){var c=ha(this,i),g=c.size;return c.set(i,o),this.size+=c.size==g?0:1,this}Li.prototype.clear=wm,Li.prototype.delete=bm,Li.prototype.get=_m,Li.prototype.has=Am,Li.prototype.set=Em;function En(i){var o=-1,c=i==null?0:i.length;for(this.__data__=new Li;++o<c;)this.add(i[o])}function Im(i){return this.__data__.set(i,f),this}function Sm(i){return this.__data__.has(i)}En.prototype.add=En.prototype.push=Im,En.prototype.has=Sm;function Xr(i){var o=this.__data__=new Bi(i);this.size=o.size}function xm(){this.__data__=new Bi,this.size=0}function Mm(i){var o=this.__data__,c=o.delete(i);return this.size=o.size,c}function Pm(i){return this.__data__.get(i)}function Cm(i){return this.__data__.has(i)}function Nm(i,o){var c=this.__data__;if(c instanceof Bi){var g=c.__data__;if(!Bs||g.length<s-1)return g.push([i,o]),this.size=++c.size,this;c=this.__data__=new Li(g)}return c.set(i,o),this.size=c.size,this}Xr.prototype.clear=xm,Xr.prototype.delete=Mm,Xr.prototype.get=Pm,Xr.prototype.has=Cm,Xr.prototype.set=Nm;function Ml(i,o){var c=Xt(i),g=!c&&Pn(i),I=!c&&!g&&dn(i),N=!c&&!g&&!I&&ns(i),j=c||g||I||N,K=j?vc(i.length,k1):[],Y=K.length;for(var nt in i)(o||we.call(i,nt))&&!(j&&(nt=="length"||I&&(nt=="offset"||nt=="parent")||N&&(nt=="buffer"||nt=="byteLength"||nt=="byteOffset")||zi(nt,Y)))&&K.push(nt);return K}function Pl(i){var o=i.length;return o?i[Fc(0,o-1)]:e}function Rm(i,o){return ua(mr(i),In(o,0,i.length))}function Om(i){return ua(mr(i))}function Ic(i,o,c){(c!==e&&!Zr(i[o],c)||c===e&&!(o in i))&&ki(i,o,c)}function js(i,o,c){var g=i[o];(!(we.call(i,o)&&Zr(g,c))||c===e&&!(o in i))&&ki(i,o,c)}function Wo(i,o){for(var c=i.length;c--;)if(Zr(i[c][0],o))return c;return-1}function Tm(i,o,c,g){return hn(i,function(I,N,j){o(g,I,c(I),j)}),g}function Cl(i,o){return i&&wi(o,Je(o),i)}function Fm(i,o){return i&&wi(o,yr(o),i)}function ki(i,o,c){o=="__proto__"&&Ko?Ko(i,o,{configurable:!0,enumerable:!0,value:c,writable:!0}):i[o]=c}function Sc(i,o){for(var c=-1,g=o.length,I=tt(g),N=i==null;++c<g;)I[c]=N?e:sh(i,o[c]);return I}function In(i,o,c){return i===i&&(c!==e&&(i=i<=c?i:c),o!==e&&(i=i>=o?i:o)),i}function kr(i,o,c,g,I,N){var j,K=o&x,Y=o&T,nt=o&R;if(c&&(j=I?c(i,g,I,N):c(i)),j!==e)return j;if(!qe(i))return i;var ot=Xt(i);if(ot){if(j=Av(i),!K)return mr(i,j)}else{var ct=nr(i),pt=ct==et||ct==st;if(dn(i))return Zl(i,K);if(ct==At||ct==_||pt&&!I){if(j=Y||pt?{}:wf(i),!K)return Y?lv(i,Fm(j,i)):uv(i,Cl(j,i))}else{if(!Re[ct])return I?i:{};j=Ev(i,ct,K)}}N||(N=new Xr);var Pt=N.get(i);if(Pt)return Pt;N.set(i,j),Qf(i)?i.forEach(function(qt){j.add(kr(qt,o,c,qt,i,N))}):Vf(i)&&i.forEach(function(qt,oe){j.set(oe,kr(qt,o,c,oe,i,N))});var Dt=nt?Y?Kc:Hc:Y?yr:Je,re=ot?e:Dt(i);return Ur(re||i,function(qt,oe){re&&(oe=qt,qt=i[oe]),js(j,oe,kr(qt,o,c,oe,i,N))}),j}function Dm(i){var o=Je(i);return function(c){return Nl(c,i,o)}}function Nl(i,o,c){var g=c.length;if(i==null)return!g;for(i=Se(i);g--;){var I=c[g],N=o[I],j=i[I];if(j===e&&!(I in i)||!N(j))return!1}return!0}function Rl(i,o,c){if(typeof i!="function")throw new Br(h);return Js(function(){i.apply(e,c)},o)}function zs(i,o,c,g){var I=-1,N=Fo,j=!0,K=i.length,Y=[],nt=o.length;if(!K)return Y;c&&(o=De(o,Mr(c))),g?(N=lc,j=!1):o.length>=s&&(N=qs,j=!1,o=new En(o));t:for(;++I<K;){var ot=i[I],ct=c==null?ot:c(ot);if(ot=g||ot!==0?ot:0,j&&ct===ct){for(var pt=nt;pt--;)if(o[pt]===ct)continue t;Y.push(ot)}else N(o,ct,g)||Y.push(ot)}return Y}var hn=sf(yi),Ol=sf(Mc,!0);function qm(i,o){var c=!0;return hn(i,function(g,I,N){return c=!!o(g,I,N),c}),c}function Xo(i,o,c){for(var g=-1,I=i.length;++g<I;){var N=i[g],j=o(N);if(j!=null&&(K===e?j===j&&!Cr(j):c(j,K)))var K=j,Y=N}return Y}function Um(i,o,c,g){var I=i.length;for(c=te(c),c<0&&(c=-c>I?0:I+c),g=g===e||g>I?I:te(g),g<0&&(g+=I),g=c>g?0:Yf(g);c<g;)i[c++]=o;return i}function Tl(i,o){var c=[];return hn(i,function(g,I,N){o(g,I,N)&&c.push(g)}),c}function Ze(i,o,c,g,I){var N=-1,j=i.length;for(c||(c=Sv),I||(I=[]);++N<j;){var K=i[N];o>0&&c(K)?o>1?Ze(K,o-1,c,g,I):on(I,K):g||(I[I.length]=K)}return I}var xc=of(),Fl=of(!0);function yi(i,o){return i&&xc(i,o,Je)}function Mc(i,o){return i&&Fl(i,o,Je)}function Zo(i,o){return sn(o,function(c){return Hi(i[c])})}function Sn(i,o){o=ln(o,i);for(var c=0,g=o.length;i!=null&&c<g;)i=i[bi(o[c++])];return c&&c==g?i:e}function Dl(i,o,c){var g=o(i);return Xt(i)?g:on(g,c(i))}function ar(i){return i==null?i===e?Bt:xt:_n&&_n in Se(i)?wv(i):Ov(i)}function Pc(i,o){return i>o}function Bm(i,o){return i!=null&&we.call(i,o)}function Lm(i,o){return i!=null&&o in Se(i)}function km(i,o,c){return i>=ir(o,c)&&i<Ve(o,c)}function Cc(i,o,c){for(var g=c?lc:Fo,I=i[0].length,N=i.length,j=N,K=tt(N),Y=1/0,nt=[];j--;){var ot=i[j];j&&o&&(ot=De(ot,Mr(o))),Y=ir(ot.length,Y),K[j]=!c&&(o||I>=120&&ot.length>=120)?new En(j&&ot):e}ot=i[0];var ct=-1,pt=K[0];t:for(;++ct<I&&nt.length<Y;){var Pt=ot[ct],Dt=o?o(Pt):Pt;if(Pt=c||Pt!==0?Pt:0,!(pt?qs(pt,Dt):g(nt,Dt,c))){for(j=N;--j;){var re=K[j];if(!(re?qs(re,Dt):g(i[j],Dt,c)))continue t}pt&&pt.push(Dt),nt.push(Pt)}}return nt}function $m(i,o,c,g){return yi(i,function(I,N,j){o(g,c(I),N,j)}),g}function Hs(i,o,c){o=ln(o,i),i=Ef(i,o);var g=i==null?i:i[bi(jr(o))];return g==null?e:xr(g,i,c)}function ql(i){return Ue(i)&&ar(i)==_}function jm(i){return Ue(i)&&ar(i)==Tt}function zm(i){return Ue(i)&&ar(i)==L}function Ks(i,o,c,g,I){return i===o?!0:i==null||o==null||!Ue(i)&&!Ue(o)?i!==i&&o!==o:Hm(i,o,c,g,Ks,I)}function Hm(i,o,c,g,I,N){var j=Xt(i),K=Xt(o),Y=j?W:nr(i),nt=K?W:nr(o);Y=Y==_?At:Y,nt=nt==_?At:nt;var ot=Y==At,ct=nt==At,pt=Y==nt;if(pt&&dn(i)){if(!dn(o))return!1;j=!0,ot=!1}if(pt&&!ot)return N||(N=new Xr),j||ns(i)?mf(i,o,c,g,I,N):vv(i,o,Y,c,g,I,N);if(!(c&$)){var Pt=ot&&we.call(i,"__wrapped__"),Dt=ct&&we.call(o,"__wrapped__");if(Pt||Dt){var re=Pt?i.value():i,qt=Dt?o.value():o;return N||(N=new Xr),I(re,qt,c,g,N)}}return pt?(N||(N=new Xr),yv(i,o,c,g,I,N)):!1}function Km(i){return Ue(i)&&nr(i)==at}function Nc(i,o,c,g){var I=c.length,N=I,j=!g;if(i==null)return!N;for(i=Se(i);I--;){var K=c[I];if(j&&K[2]?K[1]!==i[K[0]]:!(K[0]in i))return!1}for(;++I<N;){K=c[I];var Y=K[0],nt=i[Y],ot=K[1];if(j&&K[2]){if(nt===e&&!(Y in i))return!1}else{var ct=new Xr;if(g)var pt=g(nt,ot,Y,i,o,ct);if(!(pt===e?Ks(ot,nt,$|Q,g,ct):pt))return!1}}return!0}function Ul(i){if(!qe(i)||Mv(i))return!1;var o=Hi(i)?K1:pi;return o.test(Mn(i))}function Vm(i){return Ue(i)&&ar(i)==Et}function Gm(i){return Ue(i)&&nr(i)==Ot}function Qm(i){return Ue(i)&&ma(i.length)&&!!Te[ar(i)]}function Bl(i){return typeof i=="function"?i:i==null?wr:typeof i=="object"?Xt(i)?$l(i[0],i[1]):kl(i):ad(i)}function Rc(i){if(!Qs(i))return W1(i);var o=[];for(var c in Se(i))we.call(i,c)&&c!="constructor"&&o.push(c);return o}function Jm(i){if(!qe(i))return Rv(i);var o=Qs(i),c=[];for(var g in i)g=="constructor"&&(o||!we.call(i,g))||c.push(g);return c}function Oc(i,o){return i<o}function Ll(i,o){var c=-1,g=vr(i)?tt(i.length):[];return hn(i,function(I,N,j){g[++c]=o(I,N,j)}),g}function kl(i){var o=Gc(i);return o.length==1&&o[0][2]?_f(o[0][0],o[0][1]):function(c){return c===i||Nc(c,i,o)}}function $l(i,o){return Jc(i)&&bf(o)?_f(bi(i),o):function(c){var g=sh(c,i);return g===e&&g===o?oh(c,i):Ks(o,g,$|Q)}}function ta(i,o,c,g,I){i!==o&&xc(o,function(N,j){if(I||(I=new Xr),qe(N))Ym(i,o,j,c,ta,g,I);else{var K=g?g(Wc(i,j),N,j+"",i,o,I):e;K===e&&(K=N),Ic(i,j,K)}},yr)}function Ym(i,o,c,g,I,N,j){var K=Wc(i,c),Y=Wc(o,c),nt=j.get(Y);if(nt){Ic(i,c,nt);return}var ot=N?N(K,Y,c+"",i,o,j):e,ct=ot===e;if(ct){var pt=Xt(Y),Pt=!pt&&dn(Y),Dt=!pt&&!Pt&&ns(Y);ot=Y,pt||Pt||Dt?Xt(K)?ot=K:ke(K)?ot=mr(K):Pt?(ct=!1,ot=Zl(Y,!0)):Dt?(ct=!1,ot=tf(Y,!0)):ot=[]:Ys(Y)||Pn(Y)?(ot=K,Pn(K)?ot=Wf(K):(!qe(K)||Hi(K))&&(ot=wf(Y))):ct=!1}ct&&(j.set(Y,ot),I(ot,Y,g,N,j),j.delete(Y)),Ic(i,c,ot)}function jl(i,o){var c=i.length;if(c)return o+=o<0?c:0,zi(o,c)?i[o]:e}function zl(i,o,c){o.length?o=De(o,function(N){return Xt(N)?function(j){return Sn(j,N.length===1?N[0]:N)}:N}):o=[wr];var g=-1;o=De(o,Mr(Ft()));var I=Ll(i,function(N,j,K){var Y=De(o,function(nt){return nt(N)});return{criteria:Y,index:++g,value:N}});return E1(I,function(N,j){return hv(N,j,c)})}function Wm(i,o){return Hl(i,o,function(c,g){return oh(i,g)})}function Hl(i,o,c){for(var g=-1,I=o.length,N={};++g<I;){var j=o[g],K=Sn(i,j);c(K,j)&&Vs(N,ln(j,i),K)}return N}function Xm(i){return function(o){return Sn(o,i)}}function Tc(i,o,c,g){var I=g?A1:Gn,N=-1,j=o.length,K=i;for(i===o&&(o=mr(o)),c&&(K=De(i,Mr(c)));++N<j;)for(var Y=0,nt=o[N],ot=c?c(nt):nt;(Y=I(K,ot,Y,g))>-1;)K!==i&&Ho.call(K,Y,1),Ho.call(i,Y,1);return i}function Kl(i,o){for(var c=i?o.length:0,g=c-1;c--;){var I=o[c];if(c==g||I!==N){var N=I;zi(I)?Ho.call(i,I,1):Uc(i,I)}}return i}function Fc(i,o){return i+Go(Sl()*(o-i+1))}function Zm(i,o,c,g){for(var I=-1,N=Ve(Vo((o-i)/(c||1)),0),j=tt(N);N--;)j[g?N:++I]=i,i+=c;return j}function Dc(i,o){var c="";if(!i||o<1||o>P)return c;do o%2&&(c+=i),o=Go(o/2),o&&(i+=i);while(o);return c}function ie(i,o){return Xc(Af(i,o,wr),i+"")}function tv(i){return Pl(ss(i))}function ev(i,o){var c=ss(i);return ua(c,In(o,0,c.length))}function Vs(i,o,c,g){if(!qe(i))return i;o=ln(o,i);for(var I=-1,N=o.length,j=N-1,K=i;K!=null&&++I<N;){var Y=bi(o[I]),nt=c;if(Y==="__proto__"||Y==="constructor"||Y==="prototype")return i;if(I!=j){var ot=K[Y];nt=g?g(ot,Y,K):e,nt===e&&(nt=qe(ot)?ot:zi(o[I+1])?[]:{})}js(K,Y,nt),K=K[Y]}return i}var Vl=Qo?function(i,o){return Qo.set(i,o),i}:wr,rv=Ko?function(i,o){return Ko(i,"toString",{configurable:!0,enumerable:!1,value:ch(o),writable:!0})}:wr;function iv(i){return ua(ss(i))}function $r(i,o,c){var g=-1,I=i.length;o<0&&(o=-o>I?0:I+o),c=c>I?I:c,c<0&&(c+=I),I=o>c?0:c-o>>>0,o>>>=0;for(var N=tt(I);++g<I;)N[g]=i[g+o];return N}function nv(i,o){var c;return hn(i,function(g,I,N){return c=o(g,I,N),!c}),!!c}function ea(i,o,c){var g=0,I=i==null?g:i.length;if(typeof o=="number"&&o===o&&I<=X){for(;g<I;){var N=g+I>>>1,j=i[N];j!==null&&!Cr(j)&&(c?j<=o:j<o)?g=N+1:I=N}return I}return qc(i,o,wr,c)}function qc(i,o,c,g){var I=0,N=i==null?0:i.length;if(N===0)return 0;o=c(o);for(var j=o!==o,K=o===null,Y=Cr(o),nt=o===e;I<N;){var ot=Go((I+N)/2),ct=c(i[ot]),pt=ct!==e,Pt=ct===null,Dt=ct===ct,re=Cr(ct);if(j)var qt=g||Dt;else nt?qt=Dt&&(g||pt):K?qt=Dt&&pt&&(g||!Pt):Y?qt=Dt&&pt&&!Pt&&(g||!re):Pt||re?qt=!1:qt=g?ct<=o:ct<o;qt?I=ot+1:N=ot}return ir(N,C)}function Gl(i,o){for(var c=-1,g=i.length,I=0,N=[];++c<g;){var j=i[c],K=o?o(j):j;if(!c||!Zr(K,Y)){var Y=K;N[I++]=j===0?0:j}}return N}function Ql(i){return typeof i=="number"?i:Cr(i)?S:+i}function Pr(i){if(typeof i=="string")return i;if(Xt(i))return De(i,Pr)+"";if(Cr(i))return xl?xl.call(i):"";var o=i+"";return o=="0"&&1/i==-1/0?"-0":o}function un(i,o,c){var g=-1,I=Fo,N=i.length,j=!0,K=[],Y=K;if(c)j=!1,I=lc;else if(N>=s){var nt=o?null:gv(i);if(nt)return qo(nt);j=!1,I=qs,Y=new En}else Y=o?[]:K;t:for(;++g<N;){var ot=i[g],ct=o?o(ot):ot;if(ot=c||ot!==0?ot:0,j&&ct===ct){for(var pt=Y.length;pt--;)if(Y[pt]===ct)continue t;o&&Y.push(ct),K.push(ot)}else I(Y,ct,c)||(Y!==K&&Y.push(ct),K.push(ot))}return K}function Uc(i,o){return o=ln(o,i),i=Ef(i,o),i==null||delete i[bi(jr(o))]}function Jl(i,o,c,g){return Vs(i,o,c(Sn(i,o)),g)}function ra(i,o,c,g){for(var I=i.length,N=g?I:-1;(g?N--:++N<I)&&o(i[N],N,i););return c?$r(i,g?0:N,g?N+1:I):$r(i,g?N+1:0,g?I:N)}function Yl(i,o){var c=i;return c instanceof ce&&(c=c.value()),fc(o,function(g,I){return I.func.apply(I.thisArg,on([g],I.args))},c)}function Bc(i,o,c){var g=i.length;if(g<2)return g?un(i[0]):[];for(var I=-1,N=tt(g);++I<g;)for(var j=i[I],K=-1;++K<g;)K!=I&&(N[I]=zs(N[I]||j,i[K],o,c));return un(Ze(N,1),o,c)}function Wl(i,o,c){for(var g=-1,I=i.length,N=o.length,j={};++g<I;){var K=g<N?o[g]:e;c(j,i[g],K)}return j}function Lc(i){return ke(i)?i:[]}function kc(i){return typeof i=="function"?i:wr}function ln(i,o){return Xt(i)?i:Jc(i,o)?[i]:Mf(ve(i))}var sv=ie;function fn(i,o,c){var g=i.length;return c=c===e?g:c,!o&&c>=g?i:$r(i,o,c)}var Xl=V1||function(i){return Xe.clearTimeout(i)};function Zl(i,o){if(o)return i.slice();var c=i.length,g=bl?bl(c):new i.constructor(c);return i.copy(g),g}function $c(i){var o=new i.constructor(i.byteLength);return new jo(o).set(new jo(i)),o}function ov(i,o){var c=o?$c(i.buffer):i.buffer;return new i.constructor(c,i.byteOffset,i.byteLength)}function av(i){var o=new i.constructor(i.source,Ae.exec(i));return o.lastIndex=i.lastIndex,o}function cv(i){return $s?Se($s.call(i)):{}}function tf(i,o){var c=o?$c(i.buffer):i.buffer;return new i.constructor(c,i.byteOffset,i.length)}function ef(i,o){if(i!==o){var c=i!==e,g=i===null,I=i===i,N=Cr(i),j=o!==e,K=o===null,Y=o===o,nt=Cr(o);if(!K&&!nt&&!N&&i>o||N&&j&&Y&&!K&&!nt||g&&j&&Y||!c&&Y||!I)return 1;if(!g&&!N&&!nt&&i<o||nt&&c&&I&&!g&&!N||K&&c&&I||!j&&I||!Y)return-1}return 0}function hv(i,o,c){for(var g=-1,I=i.criteria,N=o.criteria,j=I.length,K=c.length;++g<j;){var Y=ef(I[g],N[g]);if(Y){if(g>=K)return Y;var nt=c[g];return Y*(nt=="desc"?-1:1)}}return i.index-o.index}function rf(i,o,c,g){for(var I=-1,N=i.length,j=c.length,K=-1,Y=o.length,nt=Ve(N-j,0),ot=tt(Y+nt),ct=!g;++K<Y;)ot[K]=o[K];for(;++I<j;)(ct||I<N)&&(ot[c[I]]=i[I]);for(;nt--;)ot[K++]=i[I++];return ot}function nf(i,o,c,g){for(var I=-1,N=i.length,j=-1,K=c.length,Y=-1,nt=o.length,ot=Ve(N-K,0),ct=tt(ot+nt),pt=!g;++I<ot;)ct[I]=i[I];for(var Pt=I;++Y<nt;)ct[Pt+Y]=o[Y];for(;++j<K;)(pt||I<N)&&(ct[Pt+c[j]]=i[I++]);return ct}function mr(i,o){var c=-1,g=i.length;for(o||(o=tt(g));++c<g;)o[c]=i[c];return o}function wi(i,o,c,g){var I=!c;c||(c={});for(var N=-1,j=o.length;++N<j;){var K=o[N],Y=g?g(c[K],i[K],K,c,i):e;Y===e&&(Y=i[K]),I?ki(c,K,Y):js(c,K,Y)}return c}function uv(i,o){return wi(i,Qc(i),o)}function lv(i,o){return wi(i,vf(i),o)}function ia(i,o){return function(c,g){var I=Xt(c)?m1:Tm,N=o?o():{};return I(c,i,Ft(g,2),N)}}function es(i){return ie(function(o,c){var g=-1,I=c.length,N=I>1?c[I-1]:e,j=I>2?c[2]:e;for(N=i.length>3&&typeof N=="function"?(I--,N):e,j&&cr(c[0],c[1],j)&&(N=I<3?e:N,I=1),o=Se(o);++g<I;){var K=c[g];K&&i(o,K,g,N)}return o})}function sf(i,o){return function(c,g){if(c==null)return c;if(!vr(c))return i(c,g);for(var I=c.length,N=o?I:-1,j=Se(c);(o?N--:++N<I)&&g(j[N],N,j)!==!1;);return c}}function of(i){return function(o,c,g){for(var I=-1,N=Se(o),j=g(o),K=j.length;K--;){var Y=j[i?K:++I];if(c(N[Y],Y,N)===!1)break}return o}}function fv(i,o,c){var g=o&V,I=Gs(i);function N(){var j=this&&this!==Xe&&this instanceof N?I:i;return j.apply(g?c:this,arguments)}return N}function af(i){return function(o){o=ve(o);var c=Qn(o)?Wr(o):e,g=c?c[0]:o.charAt(0),I=c?fn(c,1).join(""):o.slice(1);return g[i]()+I}}function rs(i){return function(o){return fc(sd(nd(o).replace(r1,"")),i,"")}}function Gs(i){return function(){var o=arguments;switch(o.length){case 0:return new i;case 1:return new i(o[0]);case 2:return new i(o[0],o[1]);case 3:return new i(o[0],o[1],o[2]);case 4:return new i(o[0],o[1],o[2],o[3]);case 5:return new i(o[0],o[1],o[2],o[3],o[4]);case 6:return new i(o[0],o[1],o[2],o[3],o[4],o[5]);case 7:return new i(o[0],o[1],o[2],o[3],o[4],o[5],o[6])}var c=ts(i.prototype),g=i.apply(c,o);return qe(g)?g:c}}function dv(i,o,c){var g=Gs(i);function I(){for(var N=arguments.length,j=tt(N),K=N,Y=is(I);K--;)j[K]=arguments[K];var nt=N<3&&j[0]!==Y&&j[N-1]!==Y?[]:an(j,Y);if(N-=nt.length,N<c)return ff(i,o,na,I.placeholder,e,j,nt,e,e,c-N);var ot=this&&this!==Xe&&this instanceof I?g:i;return xr(ot,this,j)}return I}function cf(i){return function(o,c,g){var I=Se(o);if(!vr(o)){var N=Ft(c,3);o=Je(o),c=function(K){return N(I[K],K,I)}}var j=i(o,c,g);return j>-1?I[N?o[j]:j]:e}}function hf(i){return ji(function(o){var c=o.length,g=c,I=Lr.prototype.thru;for(i&&o.reverse();g--;){var N=o[g];if(typeof N!="function")throw new Br(h);if(I&&!j&&ca(N)=="wrapper")var j=new Lr([],!0)}for(g=j?g:c;++g<c;){N=o[g];var K=ca(N),Y=K=="wrapper"?Vc(N):e;Y&&Yc(Y[0])&&Y[1]==(w|J|k|q)&&!Y[4].length&&Y[9]==1?j=j[ca(Y[0])].apply(j,Y[3]):j=N.length==1&&Yc(N)?j[K]():j.thru(N)}return function(){var nt=arguments,ot=nt[0];if(j&&nt.length==1&&Xt(ot))return j.plant(ot).value();for(var ct=0,pt=c?o[ct].apply(this,nt):ot;++ct<c;)pt=o[ct].call(this,pt);return pt}})}function na(i,o,c,g,I,N,j,K,Y,nt){var ot=o&w,ct=o&V,pt=o&Z,Pt=o&(J|B),Dt=o&ht,re=pt?e:Gs(i);function qt(){for(var oe=arguments.length,le=tt(oe),Nr=oe;Nr--;)le[Nr]=arguments[Nr];if(Pt)var hr=is(qt),Rr=S1(le,hr);if(g&&(le=rf(le,g,I,Pt)),N&&(le=nf(le,N,j,Pt)),oe-=Rr,Pt&&oe<nt){var $e=an(le,hr);return ff(i,o,na,qt.placeholder,c,le,$e,K,Y,nt-oe)}var ti=ct?c:this,Vi=pt?ti[i]:i;return oe=le.length,K?le=Tv(le,K):Dt&&oe>1&&le.reverse(),ot&&Y<oe&&(le.length=Y),this&&this!==Xe&&this instanceof qt&&(Vi=re||Gs(Vi)),Vi.apply(ti,le)}return qt}function uf(i,o){return function(c,g){return $m(c,i,o(g),{})}}function sa(i,o){return function(c,g){var I;if(c===e&&g===e)return o;if(c!==e&&(I=c),g!==e){if(I===e)return g;typeof c=="string"||typeof g=="string"?(c=Pr(c),g=Pr(g)):(c=Ql(c),g=Ql(g)),I=i(c,g)}return I}}function jc(i){return ji(function(o){return o=De(o,Mr(Ft())),ie(function(c){var g=this;return i(o,function(I){return xr(I,g,c)})})})}function oa(i,o){o=o===e?" ":Pr(o);var c=o.length;if(c<2)return c?Dc(o,i):o;var g=Dc(o,Vo(i/Jn(o)));return Qn(o)?fn(Wr(g),0,i).join(""):g.slice(0,i)}function pv(i,o,c,g){var I=o&V,N=Gs(i);function j(){for(var K=-1,Y=arguments.length,nt=-1,ot=g.length,ct=tt(ot+Y),pt=this&&this!==Xe&&this instanceof j?N:i;++nt<ot;)ct[nt]=g[nt];for(;Y--;)ct[nt++]=arguments[++K];return xr(pt,I?c:this,ct)}return j}function lf(i){return function(o,c,g){return g&&typeof g!="number"&&cr(o,c,g)&&(c=g=e),o=Ki(o),c===e?(c=o,o=0):c=Ki(c),g=g===e?o<c?1:-1:Ki(g),Zm(o,c,g,i)}}function aa(i){return function(o,c){return typeof o=="string"&&typeof c=="string"||(o=zr(o),c=zr(c)),i(o,c)}}function ff(i,o,c,g,I,N,j,K,Y,nt){var ot=o&J,ct=ot?j:e,pt=ot?e:j,Pt=ot?N:e,Dt=ot?e:N;o|=ot?k:z,o&=~(ot?z:k),o&H||(o&=-4);var re=[i,o,I,Pt,ct,Dt,pt,K,Y,nt],qt=c.apply(e,re);return Yc(i)&&If(qt,re),qt.placeholder=g,Sf(qt,i,o)}function zc(i){var o=Ke[i];return function(c,g){if(c=zr(c),g=g==null?0:ir(te(g),292),g&&Il(c)){var I=(ve(c)+"e").split("e"),N=o(I[0]+"e"+(+I[1]+g));return I=(ve(N)+"e").split("e"),+(I[0]+"e"+(+I[1]-g))}return o(c)}}var gv=Xn&&1/qo(new Xn([,-0]))[1]==E?function(i){return new Xn(i)}:lh;function df(i){return function(o){var c=nr(o);return c==at?wc(o):c==Ot?O1(o):I1(o,i(o))}}function $i(i,o,c,g,I,N,j,K){var Y=o&Z;if(!Y&&typeof i!="function")throw new Br(h);var nt=g?g.length:0;if(nt||(o&=-97,g=I=e),j=j===e?j:Ve(te(j),0),K=K===e?K:te(K),nt-=I?I.length:0,o&z){var ot=g,ct=I;g=I=e}var pt=Y?e:Vc(i),Pt=[i,o,c,g,I,ot,ct,N,j,K];if(pt&&Nv(Pt,pt),i=Pt[0],o=Pt[1],c=Pt[2],g=Pt[3],I=Pt[4],K=Pt[9]=Pt[9]===e?Y?0:i.length:Ve(Pt[9]-nt,0),!K&&o&(J|B)&&(o&=-25),!o||o==V)var Dt=fv(i,o,c);else o==J||o==B?Dt=dv(i,o,K):(o==k||o==(V|k))&&!I.length?Dt=pv(i,o,c,g):Dt=na.apply(e,Pt);var re=pt?Vl:If;return Sf(re(Dt,Pt),i,o)}function pf(i,o,c,g){return i===e||Zr(i,Wn[c])&&!we.call(g,c)?o:i}function gf(i,o,c,g,I,N){return qe(i)&&qe(o)&&(N.set(o,i),ta(i,o,e,gf,N),N.delete(o)),i}function mv(i){return Ys(i)?e:i}function mf(i,o,c,g,I,N){var j=c&$,K=i.length,Y=o.length;if(K!=Y&&!(j&&Y>K))return!1;var nt=N.get(i),ot=N.get(o);if(nt&&ot)return nt==o&&ot==i;var ct=-1,pt=!0,Pt=c&Q?new En:e;for(N.set(i,o),N.set(o,i);++ct<K;){var Dt=i[ct],re=o[ct];if(g)var qt=j?g(re,Dt,ct,o,i,N):g(Dt,re,ct,i,o,N);if(qt!==e){if(qt)continue;pt=!1;break}if(Pt){if(!dc(o,function(oe,le){if(!qs(Pt,le)&&(Dt===oe||I(Dt,oe,c,g,N)))return Pt.push(le)})){pt=!1;break}}else if(!(Dt===re||I(Dt,re,c,g,N))){pt=!1;break}}return N.delete(i),N.delete(o),pt}function vv(i,o,c,g,I,N,j){switch(c){case _t:if(i.byteLength!=o.byteLength||i.byteOffset!=o.byteOffset)return!1;i=i.buffer,o=o.buffer;case Tt:return!(i.byteLength!=o.byteLength||!N(new jo(i),new jo(o)));case U:case L:case It:return Zr(+i,+o);case F:return i.name==o.name&&i.message==o.message;case Et:case yt:return i==o+"";case at:var K=wc;case Ot:var Y=g&$;if(K||(K=qo),i.size!=o.size&&!Y)return!1;var nt=j.get(i);if(nt)return nt==o;g|=Q,j.set(i,o);var ot=mf(K(i),K(o),g,I,N,j);return j.delete(i),ot;case wt:if($s)return $s.call(i)==$s.call(o)}return!1}function yv(i,o,c,g,I,N){var j=c&$,K=Hc(i),Y=K.length,nt=Hc(o),ot=nt.length;if(Y!=ot&&!j)return!1;for(var ct=Y;ct--;){var pt=K[ct];if(!(j?pt in o:we.call(o,pt)))return!1}var Pt=N.get(i),Dt=N.get(o);if(Pt&&Dt)return Pt==o&&Dt==i;var re=!0;N.set(i,o),N.set(o,i);for(var qt=j;++ct<Y;){pt=K[ct];var oe=i[pt],le=o[pt];if(g)var Nr=j?g(le,oe,pt,o,i,N):g(oe,le,pt,i,o,N);if(!(Nr===e?oe===le||I(oe,le,c,g,N):Nr)){re=!1;break}qt||(qt=pt=="constructor")}if(re&&!qt){var hr=i.constructor,Rr=o.constructor;hr!=Rr&&"constructor"in i&&"constructor"in o&&!(typeof hr=="function"&&hr instanceof hr&&typeof Rr=="function"&&Rr instanceof Rr)&&(re=!1)}return N.delete(i),N.delete(o),re}function ji(i){return Xc(Af(i,e,Rf),i+"")}function Hc(i){return Dl(i,Je,Qc)}function Kc(i){return Dl(i,yr,vf)}var Vc=Qo?function(i){return Qo.get(i)}:lh;function ca(i){for(var o=i.name+"",c=Zn[o],g=we.call(Zn,o)?c.length:0;g--;){var I=c[g],N=I.func;if(N==null||N==i)return I.name}return o}function is(i){var o=we.call(M,"placeholder")?M:i;return o.placeholder}function Ft(){var i=M.iteratee||hh;return i=i===hh?Bl:i,arguments.length?i(arguments[0],arguments[1]):i}function ha(i,o){var c=i.__data__;return xv(o)?c[typeof o=="string"?"string":"hash"]:c.map}function Gc(i){for(var o=Je(i),c=o.length;c--;){var g=o[c],I=i[g];o[c]=[g,I,bf(I)]}return o}function xn(i,o){var c=C1(i,o);return Ul(c)?c:e}function wv(i){var o=we.call(i,_n),c=i[_n];try{i[_n]=e;var g=!0}catch{}var I=ko.call(i);return g&&(o?i[_n]=c:delete i[_n]),I}var Qc=_c?function(i){return i==null?[]:(i=Se(i),sn(_c(i),function(o){return Al.call(i,o)}))}:fh,vf=_c?function(i){for(var o=[];i;)on(o,Qc(i)),i=zo(i);return o}:fh,nr=ar;(Ac&&nr(new Ac(new ArrayBuffer(1)))!=_t||Bs&&nr(new Bs)!=at||Ec&&nr(Ec.resolve())!=me||Xn&&nr(new Xn)!=Ot||Ls&&nr(new Ls)!=mt)&&(nr=function(i){var o=ar(i),c=o==At?i.constructor:e,g=c?Mn(c):"";if(g)switch(g){case em:return _t;case rm:return at;case im:return me;case nm:return Ot;case sm:return mt}return o});function bv(i,o,c){for(var g=-1,I=c.length;++g<I;){var N=c[g],j=N.size;switch(N.type){case"drop":i+=j;break;case"dropRight":o-=j;break;case"take":o=ir(o,i+j);break;case"takeRight":i=Ve(i,o-j);break}}return{start:i,end:o}}function _v(i){var o=i.match(Qt);return o?o[1].split(Ne):[]}function yf(i,o,c){o=ln(o,i);for(var g=-1,I=o.length,N=!1;++g<I;){var j=bi(o[g]);if(!(N=i!=null&&c(i,j)))break;i=i[j]}return N||++g!=I?N:(I=i==null?0:i.length,!!I&&ma(I)&&zi(j,I)&&(Xt(i)||Pn(i)))}function Av(i){var o=i.length,c=new i.constructor(o);return o&&typeof i[0]=="string"&&we.call(i,"index")&&(c.index=i.index,c.input=i.input),c}function wf(i){return typeof i.constructor=="function"&&!Qs(i)?ts(zo(i)):{}}function Ev(i,o,c){var g=i.constructor;switch(o){case Tt:return $c(i);case U:case L:return new g(+i);case _t:return ov(i,c);case St:case Wt:case Mt:case Ct:case ee:case Nt:case Rt:case He:case se:return tf(i,c);case at:return new g;case It:case yt:return new g(i);case Et:return av(i);case Ot:return new g;case wt:return cv(i)}}function Iv(i,o){var c=o.length;if(!c)return i;var g=c-1;return o[g]=(c>1?"& ":"")+o[g],o=o.join(c>2?", ":" "),i.replace(Gt,`{
/* [wrapped with `+o+`] */
`)}function Sv(i){return Xt(i)||Pn(i)||!!(El&&i&&i[El])}function zi(i,o){var c=typeof i;return o=o??P,!!o&&(c=="number"||c!="symbol"&&mi.test(i))&&i>-1&&i%1==0&&i<o}function cr(i,o,c){if(!qe(c))return!1;var g=typeof o;return(g=="number"?vr(c)&&zi(o,c.length):g=="string"&&o in c)?Zr(c[o],i):!1}function Jc(i,o){if(Xt(i))return!1;var c=typeof i;return c=="number"||c=="symbol"||c=="boolean"||i==null||Cr(i)?!0:Ht.test(i)||!Pe.test(i)||o!=null&&i in Se(o)}function xv(i){var o=typeof i;return o=="string"||o=="number"||o=="symbol"||o=="boolean"?i!=="__proto__":i===null}function Yc(i){var o=ca(i),c=M[o];if(typeof c!="function"||!(o in ce.prototype))return!1;if(i===c)return!0;var g=Vc(c);return!!g&&i===g[0]}function Mv(i){return!!wl&&wl in i}var Pv=Bo?Hi:dh;function Qs(i){var o=i&&i.constructor,c=typeof o=="function"&&o.prototype||Wn;return i===c}function bf(i){return i===i&&!qe(i)}function _f(i,o){return function(c){return c==null?!1:c[i]===o&&(o!==e||i in Se(c))}}function Cv(i){var o=pa(i,function(g){return c.size===y&&c.clear(),g}),c=o.cache;return o}function Nv(i,o){var c=i[1],g=o[1],I=c|g,N=I<(V|Z|w),j=g==w&&c==J||g==w&&c==q&&i[7].length<=o[8]||g==(w|q)&&o[7].length<=o[8]&&c==J;if(!(N||j))return i;g&V&&(i[2]=o[2],I|=c&V?0:H);var K=o[3];if(K){var Y=i[3];i[3]=Y?rf(Y,K,o[4]):K,i[4]=Y?an(i[3],A):o[4]}return K=o[5],K&&(Y=i[5],i[5]=Y?nf(Y,K,o[6]):K,i[6]=Y?an(i[5],A):o[6]),K=o[7],K&&(i[7]=K),g&w&&(i[8]=i[8]==null?o[8]:ir(i[8],o[8])),i[9]==null&&(i[9]=o[9]),i[0]=o[0],i[1]=I,i}function Rv(i){var o=[];if(i!=null)for(var c in Se(i))o.push(c);return o}function Ov(i){return ko.call(i)}function Af(i,o,c){return o=Ve(o===e?i.length-1:o,0),function(){for(var g=arguments,I=-1,N=Ve(g.length-o,0),j=tt(N);++I<N;)j[I]=g[o+I];I=-1;for(var K=tt(o+1);++I<o;)K[I]=g[I];return K[o]=c(j),xr(i,this,K)}}function Ef(i,o){return o.length<2?i:Sn(i,$r(o,0,-1))}function Tv(i,o){for(var c=i.length,g=ir(o.length,c),I=mr(i);g--;){var N=o[g];i[g]=zi(N,c)?I[N]:e}return i}function Wc(i,o){if(!(o==="constructor"&&typeof i[o]=="function")&&o!="__proto__")return i[o]}var If=xf(Vl),Js=Q1||function(i,o){return Xe.setTimeout(i,o)},Xc=xf(rv);function Sf(i,o,c){var g=o+"";return Xc(i,Iv(g,Fv(_v(g),c)))}function xf(i){var o=0,c=0;return function(){var g=X1(),I=l-(g-c);if(c=g,I>0){if(++o>=gt)return arguments[0]}else o=0;return i.apply(e,arguments)}}function ua(i,o){var c=-1,g=i.length,I=g-1;for(o=o===e?g:o;++c<o;){var N=Fc(c,I),j=i[N];i[N]=i[c],i[c]=j}return i.length=o,i}var Mf=Cv(function(i){var o=[];return i.charCodeAt(0)===46&&o.push(""),i.replace(Kt,function(c,g,I,N){o.push(I?N.replace(Ui,"$1"):g||c)}),o});function bi(i){if(typeof i=="string"||Cr(i))return i;var o=i+"";return o=="0"&&1/i==-1/0?"-0":o}function Mn(i){if(i!=null){try{return Lo.call(i)}catch{}try{return i+""}catch{}}return""}function Fv(i,o){return Ur(rt,function(c){var g="_."+c[0];o&c[1]&&!Fo(i,g)&&i.push(g)}),i.sort()}function Pf(i){if(i instanceof ce)return i.clone();var o=new Lr(i.__wrapped__,i.__chain__);return o.__actions__=mr(i.__actions__),o.__index__=i.__index__,o.__values__=i.__values__,o}function Dv(i,o,c){(c?cr(i,o,c):o===e)?o=1:o=Ve(te(o),0);var g=i==null?0:i.length;if(!g||o<1)return[];for(var I=0,N=0,j=tt(Vo(g/o));I<g;)j[N++]=$r(i,I,I+=o);return j}function qv(i){for(var o=-1,c=i==null?0:i.length,g=0,I=[];++o<c;){var N=i[o];N&&(I[g++]=N)}return I}function Uv(){var i=arguments.length;if(!i)return[];for(var o=tt(i-1),c=arguments[0],g=i;g--;)o[g-1]=arguments[g];return on(Xt(c)?mr(c):[c],Ze(o,1))}var Bv=ie(function(i,o){return ke(i)?zs(i,Ze(o,1,ke,!0)):[]}),Lv=ie(function(i,o){var c=jr(o);return ke(c)&&(c=e),ke(i)?zs(i,Ze(o,1,ke,!0),Ft(c,2)):[]}),kv=ie(function(i,o){var c=jr(o);return ke(c)&&(c=e),ke(i)?zs(i,Ze(o,1,ke,!0),e,c):[]});function $v(i,o,c){var g=i==null?0:i.length;return g?(o=c||o===e?1:te(o),$r(i,o<0?0:o,g)):[]}function jv(i,o,c){var g=i==null?0:i.length;return g?(o=c||o===e?1:te(o),o=g-o,$r(i,0,o<0?0:o)):[]}function zv(i,o){return i&&i.length?ra(i,Ft(o,3),!0,!0):[]}function Hv(i,o){return i&&i.length?ra(i,Ft(o,3),!0):[]}function Kv(i,o,c,g){var I=i==null?0:i.length;return I?(c&&typeof c!="number"&&cr(i,o,c)&&(c=0,g=I),Um(i,o,c,g)):[]}function Cf(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var I=c==null?0:te(c);return I<0&&(I=Ve(g+I,0)),Do(i,Ft(o,3),I)}function Nf(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var I=g-1;return c!==e&&(I=te(c),I=c<0?Ve(g+I,0):ir(I,g-1)),Do(i,Ft(o,3),I,!0)}function Rf(i){var o=i==null?0:i.length;return o?Ze(i,1):[]}function Vv(i){var o=i==null?0:i.length;return o?Ze(i,E):[]}function Gv(i,o){var c=i==null?0:i.length;return c?(o=o===e?1:te(o),Ze(i,o)):[]}function Qv(i){for(var o=-1,c=i==null?0:i.length,g={};++o<c;){var I=i[o];g[I[0]]=I[1]}return g}function Of(i){return i&&i.length?i[0]:e}function Jv(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var I=c==null?0:te(c);return I<0&&(I=Ve(g+I,0)),Gn(i,o,I)}function Yv(i){var o=i==null?0:i.length;return o?$r(i,0,-1):[]}var Wv=ie(function(i){var o=De(i,Lc);return o.length&&o[0]===i[0]?Cc(o):[]}),Xv=ie(function(i){var o=jr(i),c=De(i,Lc);return o===jr(c)?o=e:c.pop(),c.length&&c[0]===i[0]?Cc(c,Ft(o,2)):[]}),Zv=ie(function(i){var o=jr(i),c=De(i,Lc);return o=typeof o=="function"?o:e,o&&c.pop(),c.length&&c[0]===i[0]?Cc(c,e,o):[]});function ty(i,o){return i==null?"":Y1.call(i,o)}function jr(i){var o=i==null?0:i.length;return o?i[o-1]:e}function ey(i,o,c){var g=i==null?0:i.length;if(!g)return-1;var I=g;return c!==e&&(I=te(c),I=I<0?Ve(g+I,0):ir(I,g-1)),o===o?F1(i,o,I):Do(i,ll,I,!0)}function ry(i,o){return i&&i.length?jl(i,te(o)):e}var iy=ie(Tf);function Tf(i,o){return i&&i.length&&o&&o.length?Tc(i,o):i}function ny(i,o,c){return i&&i.length&&o&&o.length?Tc(i,o,Ft(c,2)):i}function sy(i,o,c){return i&&i.length&&o&&o.length?Tc(i,o,e,c):i}var oy=ji(function(i,o){var c=i==null?0:i.length,g=Sc(i,o);return Kl(i,De(o,function(I){return zi(I,c)?+I:I}).sort(ef)),g});function ay(i,o){var c=[];if(!(i&&i.length))return c;var g=-1,I=[],N=i.length;for(o=Ft(o,3);++g<N;){var j=i[g];o(j,g,i)&&(c.push(j),I.push(g))}return Kl(i,I),c}function Zc(i){return i==null?i:tm.call(i)}function cy(i,o,c){var g=i==null?0:i.length;return g?(c&&typeof c!="number"&&cr(i,o,c)?(o=0,c=g):(o=o==null?0:te(o),c=c===e?g:te(c)),$r(i,o,c)):[]}function hy(i,o){return ea(i,o)}function uy(i,o,c){return qc(i,o,Ft(c,2))}function ly(i,o){var c=i==null?0:i.length;if(c){var g=ea(i,o);if(g<c&&Zr(i[g],o))return g}return-1}function fy(i,o){return ea(i,o,!0)}function dy(i,o,c){return qc(i,o,Ft(c,2),!0)}function py(i,o){var c=i==null?0:i.length;if(c){var g=ea(i,o,!0)-1;if(Zr(i[g],o))return g}return-1}function gy(i){return i&&i.length?Gl(i):[]}function my(i,o){return i&&i.length?Gl(i,Ft(o,2)):[]}function vy(i){var o=i==null?0:i.length;return o?$r(i,1,o):[]}function yy(i,o,c){return i&&i.length?(o=c||o===e?1:te(o),$r(i,0,o<0?0:o)):[]}function wy(i,o,c){var g=i==null?0:i.length;return g?(o=c||o===e?1:te(o),o=g-o,$r(i,o<0?0:o,g)):[]}function by(i,o){return i&&i.length?ra(i,Ft(o,3),!1,!0):[]}function _y(i,o){return i&&i.length?ra(i,Ft(o,3)):[]}var Ay=ie(function(i){return un(Ze(i,1,ke,!0))}),Ey=ie(function(i){var o=jr(i);return ke(o)&&(o=e),un(Ze(i,1,ke,!0),Ft(o,2))}),Iy=ie(function(i){var o=jr(i);return o=typeof o=="function"?o:e,un(Ze(i,1,ke,!0),e,o)});function Sy(i){return i&&i.length?un(i):[]}function xy(i,o){return i&&i.length?un(i,Ft(o,2)):[]}function My(i,o){return o=typeof o=="function"?o:e,i&&i.length?un(i,e,o):[]}function th(i){if(!(i&&i.length))return[];var o=0;return i=sn(i,function(c){if(ke(c))return o=Ve(c.length,o),!0}),vc(o,function(c){return De(i,pc(c))})}function Ff(i,o){if(!(i&&i.length))return[];var c=th(i);return o==null?c:De(c,function(g){return xr(o,e,g)})}var Py=ie(function(i,o){return ke(i)?zs(i,o):[]}),Cy=ie(function(i){return Bc(sn(i,ke))}),Ny=ie(function(i){var o=jr(i);return ke(o)&&(o=e),Bc(sn(i,ke),Ft(o,2))}),Ry=ie(function(i){var o=jr(i);return o=typeof o=="function"?o:e,Bc(sn(i,ke),e,o)}),Oy=ie(th);function Ty(i,o){return Wl(i||[],o||[],js)}function Fy(i,o){return Wl(i||[],o||[],Vs)}var Dy=ie(function(i){var o=i.length,c=o>1?i[o-1]:e;return c=typeof c=="function"?(i.pop(),c):e,Ff(i,c)});function Df(i){var o=M(i);return o.__chain__=!0,o}function qy(i,o){return o(i),i}function la(i,o){return o(i)}var Uy=ji(function(i){var o=i.length,c=o?i[0]:0,g=this.__wrapped__,I=function(N){return Sc(N,i)};return o>1||this.__actions__.length||!(g instanceof ce)||!zi(c)?this.thru(I):(g=g.slice(c,+c+(o?1:0)),g.__actions__.push({func:la,args:[I],thisArg:e}),new Lr(g,this.__chain__).thru(function(N){return o&&!N.length&&N.push(e),N}))});function By(){return Df(this)}function Ly(){return new Lr(this.value(),this.__chain__)}function ky(){this.__values__===e&&(this.__values__=Jf(this.value()));var i=this.__index__>=this.__values__.length,o=i?e:this.__values__[this.__index__++];return{done:i,value:o}}function $y(){return this}function jy(i){for(var o,c=this;c instanceof Yo;){var g=Pf(c);g.__index__=0,g.__values__=e,o?I.__wrapped__=g:o=g;var I=g;c=c.__wrapped__}return I.__wrapped__=i,o}function zy(){var i=this.__wrapped__;if(i instanceof ce){var o=i;return this.__actions__.length&&(o=new ce(this)),o=o.reverse(),o.__actions__.push({func:la,args:[Zc],thisArg:e}),new Lr(o,this.__chain__)}return this.thru(Zc)}function Hy(){return Yl(this.__wrapped__,this.__actions__)}var Ky=ia(function(i,o,c){we.call(i,c)?++i[c]:ki(i,c,1)});function Vy(i,o,c){var g=Xt(i)?hl:qm;return c&&cr(i,o,c)&&(o=e),g(i,Ft(o,3))}function Gy(i,o){var c=Xt(i)?sn:Tl;return c(i,Ft(o,3))}var Qy=cf(Cf),Jy=cf(Nf);function Yy(i,o){return Ze(fa(i,o),1)}function Wy(i,o){return Ze(fa(i,o),E)}function Xy(i,o,c){return c=c===e?1:te(c),Ze(fa(i,o),c)}function qf(i,o){var c=Xt(i)?Ur:hn;return c(i,Ft(o,3))}function Uf(i,o){var c=Xt(i)?v1:Ol;return c(i,Ft(o,3))}var Zy=ia(function(i,o,c){we.call(i,c)?i[c].push(o):ki(i,c,[o])});function tw(i,o,c,g){i=vr(i)?i:ss(i),c=c&&!g?te(c):0;var I=i.length;return c<0&&(c=Ve(I+c,0)),va(i)?c<=I&&i.indexOf(o,c)>-1:!!I&&Gn(i,o,c)>-1}var ew=ie(function(i,o,c){var g=-1,I=typeof o=="function",N=vr(i)?tt(i.length):[];return hn(i,function(j){N[++g]=I?xr(o,j,c):Hs(j,o,c)}),N}),rw=ia(function(i,o,c){ki(i,c,o)});function fa(i,o){var c=Xt(i)?De:Ll;return c(i,Ft(o,3))}function iw(i,o,c,g){return i==null?[]:(Xt(o)||(o=o==null?[]:[o]),c=g?e:c,Xt(c)||(c=c==null?[]:[c]),zl(i,o,c))}var nw=ia(function(i,o,c){i[c?0:1].push(o)},function(){return[[],[]]});function sw(i,o,c){var g=Xt(i)?fc:dl,I=arguments.length<3;return g(i,Ft(o,4),c,I,hn)}function ow(i,o,c){var g=Xt(i)?y1:dl,I=arguments.length<3;return g(i,Ft(o,4),c,I,Ol)}function aw(i,o){var c=Xt(i)?sn:Tl;return c(i,ga(Ft(o,3)))}function cw(i){var o=Xt(i)?Pl:tv;return o(i)}function hw(i,o,c){(c?cr(i,o,c):o===e)?o=1:o=te(o);var g=Xt(i)?Rm:ev;return g(i,o)}function uw(i){var o=Xt(i)?Om:iv;return o(i)}function lw(i){if(i==null)return 0;if(vr(i))return va(i)?Jn(i):i.length;var o=nr(i);return o==at||o==Ot?i.size:Rc(i).length}function fw(i,o,c){var g=Xt(i)?dc:nv;return c&&cr(i,o,c)&&(o=e),g(i,Ft(o,3))}var dw=ie(function(i,o){if(i==null)return[];var c=o.length;return c>1&&cr(i,o[0],o[1])?o=[]:c>2&&cr(o[0],o[1],o[2])&&(o=[o[0]]),zl(i,Ze(o,1),[])}),da=G1||function(){return Xe.Date.now()};function pw(i,o){if(typeof o!="function")throw new Br(h);return i=te(i),function(){if(--i<1)return o.apply(this,arguments)}}function Bf(i,o,c){return o=c?e:o,o=i&&o==null?i.length:o,$i(i,w,e,e,e,e,o)}function Lf(i,o){var c;if(typeof o!="function")throw new Br(h);return i=te(i),function(){return--i>0&&(c=o.apply(this,arguments)),i<=1&&(o=e),c}}var eh=ie(function(i,o,c){var g=V;if(c.length){var I=an(c,is(eh));g|=k}return $i(i,g,o,c,I)}),kf=ie(function(i,o,c){var g=V|Z;if(c.length){var I=an(c,is(kf));g|=k}return $i(o,g,i,c,I)});function $f(i,o,c){o=c?e:o;var g=$i(i,J,e,e,e,e,e,o);return g.placeholder=$f.placeholder,g}function jf(i,o,c){o=c?e:o;var g=$i(i,B,e,e,e,e,e,o);return g.placeholder=jf.placeholder,g}function zf(i,o,c){var g,I,N,j,K,Y,nt=0,ot=!1,ct=!1,pt=!0;if(typeof i!="function")throw new Br(h);o=zr(o)||0,qe(c)&&(ot=!!c.leading,ct="maxWait"in c,N=ct?Ve(zr(c.maxWait)||0,o):N,pt="trailing"in c?!!c.trailing:pt);function Pt($e){var ti=g,Vi=I;return g=I=e,nt=$e,j=i.apply(Vi,ti),j}function Dt($e){return nt=$e,K=Js(oe,o),ot?Pt($e):j}function re($e){var ti=$e-Y,Vi=$e-nt,cd=o-ti;return ct?ir(cd,N-Vi):cd}function qt($e){var ti=$e-Y,Vi=$e-nt;return Y===e||ti>=o||ti<0||ct&&Vi>=N}function oe(){var $e=da();if(qt($e))return le($e);K=Js(oe,re($e))}function le($e){return K=e,pt&&g?Pt($e):(g=I=e,j)}function Nr(){K!==e&&Xl(K),nt=0,g=Y=I=K=e}function hr(){return K===e?j:le(da())}function Rr(){var $e=da(),ti=qt($e);if(g=arguments,I=this,Y=$e,ti){if(K===e)return Dt(Y);if(ct)return Xl(K),K=Js(oe,o),Pt(Y)}return K===e&&(K=Js(oe,o)),j}return Rr.cancel=Nr,Rr.flush=hr,Rr}var gw=ie(function(i,o){return Rl(i,1,o)}),mw=ie(function(i,o,c){return Rl(i,zr(o)||0,c)});function vw(i){return $i(i,ht)}function pa(i,o){if(typeof i!="function"||o!=null&&typeof o!="function")throw new Br(h);var c=function(){var g=arguments,I=o?o.apply(this,g):g[0],N=c.cache;if(N.has(I))return N.get(I);var j=i.apply(this,g);return c.cache=N.set(I,j)||N,j};return c.cache=new(pa.Cache||Li),c}pa.Cache=Li;function ga(i){if(typeof i!="function")throw new Br(h);return function(){var o=arguments;switch(o.length){case 0:return!i.call(this);case 1:return!i.call(this,o[0]);case 2:return!i.call(this,o[0],o[1]);case 3:return!i.call(this,o[0],o[1],o[2])}return!i.apply(this,o)}}function yw(i){return Lf(2,i)}var ww=sv(function(i,o){o=o.length==1&&Xt(o[0])?De(o[0],Mr(Ft())):De(Ze(o,1),Mr(Ft()));var c=o.length;return ie(function(g){for(var I=-1,N=ir(g.length,c);++I<N;)g[I]=o[I].call(this,g[I]);return xr(i,this,g)})}),rh=ie(function(i,o){var c=an(o,is(rh));return $i(i,k,e,o,c)}),Hf=ie(function(i,o){var c=an(o,is(Hf));return $i(i,z,e,o,c)}),bw=ji(function(i,o){return $i(i,q,e,e,e,o)});function _w(i,o){if(typeof i!="function")throw new Br(h);return o=o===e?o:te(o),ie(i,o)}function Aw(i,o){if(typeof i!="function")throw new Br(h);return o=o==null?0:Ve(te(o),0),ie(function(c){var g=c[o],I=fn(c,0,o);return g&&on(I,g),xr(i,this,I)})}function Ew(i,o,c){var g=!0,I=!0;if(typeof i!="function")throw new Br(h);return qe(c)&&(g="leading"in c?!!c.leading:g,I="trailing"in c?!!c.trailing:I),zf(i,o,{leading:g,maxWait:o,trailing:I})}function Iw(i){return Bf(i,1)}function Sw(i,o){return rh(kc(o),i)}function xw(){if(!arguments.length)return[];var i=arguments[0];return Xt(i)?i:[i]}function Mw(i){return kr(i,R)}function Pw(i,o){return o=typeof o=="function"?o:e,kr(i,R,o)}function Cw(i){return kr(i,x|R)}function Nw(i,o){return o=typeof o=="function"?o:e,kr(i,x|R,o)}function Rw(i,o){return o==null||Nl(i,o,Je(o))}function Zr(i,o){return i===o||i!==i&&o!==o}var Ow=aa(Pc),Tw=aa(function(i,o){return i>=o}),Pn=ql(function(){return arguments}())?ql:function(i){return Ue(i)&&we.call(i,"callee")&&!Al.call(i,"callee")},Xt=tt.isArray,Fw=il?Mr(il):jm;function vr(i){return i!=null&&ma(i.length)&&!Hi(i)}function ke(i){return Ue(i)&&vr(i)}function Dw(i){return i===!0||i===!1||Ue(i)&&ar(i)==U}var dn=J1||dh,qw=nl?Mr(nl):zm;function Uw(i){return Ue(i)&&i.nodeType===1&&!Ys(i)}function Bw(i){if(i==null)return!0;if(vr(i)&&(Xt(i)||typeof i=="string"||typeof i.splice=="function"||dn(i)||ns(i)||Pn(i)))return!i.length;var o=nr(i);if(o==at||o==Ot)return!i.size;if(Qs(i))return!Rc(i).length;for(var c in i)if(we.call(i,c))return!1;return!0}function Lw(i,o){return Ks(i,o)}function kw(i,o,c){c=typeof c=="function"?c:e;var g=c?c(i,o):e;return g===e?Ks(i,o,e,c):!!g}function ih(i){if(!Ue(i))return!1;var o=ar(i);return o==F||o==p||typeof i.message=="string"&&typeof i.name=="string"&&!Ys(i)}function $w(i){return typeof i=="number"&&Il(i)}function Hi(i){if(!qe(i))return!1;var o=ar(i);return o==et||o==st||o==D||o==Ut}function Kf(i){return typeof i=="number"&&i==te(i)}function ma(i){return typeof i=="number"&&i>-1&&i%1==0&&i<=P}function qe(i){var o=typeof i;return i!=null&&(o=="object"||o=="function")}function Ue(i){return i!=null&&typeof i=="object"}var Vf=sl?Mr(sl):Km;function jw(i,o){return i===o||Nc(i,o,Gc(o))}function zw(i,o,c){return c=typeof c=="function"?c:e,Nc(i,o,Gc(o),c)}function Hw(i){return Gf(i)&&i!=+i}function Kw(i){if(Pv(i))throw new Yt(a);return Ul(i)}function Vw(i){return i===null}function Gw(i){return i==null}function Gf(i){return typeof i=="number"||Ue(i)&&ar(i)==It}function Ys(i){if(!Ue(i)||ar(i)!=At)return!1;var o=zo(i);if(o===null)return!0;var c=we.call(o,"constructor")&&o.constructor;return typeof c=="function"&&c instanceof c&&Lo.call(c)==z1}var nh=ol?Mr(ol):Vm;function Qw(i){return Kf(i)&&i>=-9007199254740991&&i<=P}var Qf=al?Mr(al):Gm;function va(i){return typeof i=="string"||!Xt(i)&&Ue(i)&&ar(i)==yt}function Cr(i){return typeof i=="symbol"||Ue(i)&&ar(i)==wt}var ns=cl?Mr(cl):Qm;function Jw(i){return i===e}function Yw(i){return Ue(i)&&nr(i)==mt}function Ww(i){return Ue(i)&&ar(i)==bt}var Xw=aa(Oc),Zw=aa(function(i,o){return i<=o});function Jf(i){if(!i)return[];if(vr(i))return va(i)?Wr(i):mr(i);if(Us&&i[Us])return R1(i[Us]());var o=nr(i),c=o==at?wc:o==Ot?qo:ss;return c(i)}function Ki(i){if(!i)return i===0?i:0;if(i=zr(i),i===E||i===-1/0){var o=i<0?-1:1;return o*O}return i===i?i:0}function te(i){var o=Ki(i),c=o%1;return o===o?c?o-c:o:0}function Yf(i){return i?In(te(i),0,d):0}function zr(i){if(typeof i=="number")return i;if(Cr(i))return S;if(qe(i)){var o=typeof i.valueOf=="function"?i.valueOf():i;i=qe(o)?o+"":o}if(typeof i!="string")return i===0?i:+i;i=pl(i);var c=di.test(i);return c||gi.test(i)?p1(i.slice(2),c?2:8):fi.test(i)?S:+i}function Wf(i){return wi(i,yr(i))}function t2(i){return i?In(te(i),-9007199254740991,P):i===0?i:0}function ve(i){return i==null?"":Pr(i)}var e2=es(function(i,o){if(Qs(o)||vr(o)){wi(o,Je(o),i);return}for(var c in o)we.call(o,c)&&js(i,c,o[c])}),Xf=es(function(i,o){wi(o,yr(o),i)}),ya=es(function(i,o,c,g){wi(o,yr(o),i,g)}),r2=es(function(i,o,c,g){wi(o,Je(o),i,g)}),i2=ji(Sc);function n2(i,o){var c=ts(i);return o==null?c:Cl(c,o)}var s2=ie(function(i,o){i=Se(i);var c=-1,g=o.length,I=g>2?o[2]:e;for(I&&cr(o[0],o[1],I)&&(g=1);++c<g;)for(var N=o[c],j=yr(N),K=-1,Y=j.length;++K<Y;){var nt=j[K],ot=i[nt];(ot===e||Zr(ot,Wn[nt])&&!we.call(i,nt))&&(i[nt]=N[nt])}return i}),o2=ie(function(i){return i.push(e,gf),xr(Zf,e,i)});function a2(i,o){return ul(i,Ft(o,3),yi)}function c2(i,o){return ul(i,Ft(o,3),Mc)}function h2(i,o){return i==null?i:xc(i,Ft(o,3),yr)}function u2(i,o){return i==null?i:Fl(i,Ft(o,3),yr)}function l2(i,o){return i&&yi(i,Ft(o,3))}function f2(i,o){return i&&Mc(i,Ft(o,3))}function d2(i){return i==null?[]:Zo(i,Je(i))}function p2(i){return i==null?[]:Zo(i,yr(i))}function sh(i,o,c){var g=i==null?e:Sn(i,o);return g===e?c:g}function g2(i,o){return i!=null&&yf(i,o,Bm)}function oh(i,o){return i!=null&&yf(i,o,Lm)}var m2=uf(function(i,o,c){o!=null&&typeof o.toString!="function"&&(o=ko.call(o)),i[o]=c},ch(wr)),v2=uf(function(i,o,c){o!=null&&typeof o.toString!="function"&&(o=ko.call(o)),we.call(i,o)?i[o].push(c):i[o]=[c]},Ft),y2=ie(Hs);function Je(i){return vr(i)?Ml(i):Rc(i)}function yr(i){return vr(i)?Ml(i,!0):Jm(i)}function w2(i,o){var c={};return o=Ft(o,3),yi(i,function(g,I,N){ki(c,o(g,I,N),g)}),c}function b2(i,o){var c={};return o=Ft(o,3),yi(i,function(g,I,N){ki(c,I,o(g,I,N))}),c}var _2=es(function(i,o,c){ta(i,o,c)}),Zf=es(function(i,o,c,g){ta(i,o,c,g)}),A2=ji(function(i,o){var c={};if(i==null)return c;var g=!1;o=De(o,function(N){return N=ln(N,i),g||(g=N.length>1),N}),wi(i,Kc(i),c),g&&(c=kr(c,x|T|R,mv));for(var I=o.length;I--;)Uc(c,o[I]);return c});function E2(i,o){return td(i,ga(Ft(o)))}var I2=ji(function(i,o){return i==null?{}:Wm(i,o)});function td(i,o){if(i==null)return{};var c=De(Kc(i),function(g){return[g]});return o=Ft(o),Hl(i,c,function(g,I){return o(g,I[0])})}function S2(i,o,c){o=ln(o,i);var g=-1,I=o.length;for(I||(I=1,i=e);++g<I;){var N=i==null?e:i[bi(o[g])];N===e&&(g=I,N=c),i=Hi(N)?N.call(i):N}return i}function x2(i,o,c){return i==null?i:Vs(i,o,c)}function M2(i,o,c,g){return g=typeof g=="function"?g:e,i==null?i:Vs(i,o,c,g)}var ed=df(Je),rd=df(yr);function P2(i,o,c){var g=Xt(i),I=g||dn(i)||ns(i);if(o=Ft(o,4),c==null){var N=i&&i.constructor;I?c=g?new N:[]:qe(i)?c=Hi(N)?ts(zo(i)):{}:c={}}return(I?Ur:yi)(i,function(j,K,Y){return o(c,j,K,Y)}),c}function C2(i,o){return i==null?!0:Uc(i,o)}function N2(i,o,c){return i==null?i:Jl(i,o,kc(c))}function R2(i,o,c,g){return g=typeof g=="function"?g:e,i==null?i:Jl(i,o,kc(c),g)}function ss(i){return i==null?[]:yc(i,Je(i))}function O2(i){return i==null?[]:yc(i,yr(i))}function T2(i,o,c){return c===e&&(c=o,o=e),c!==e&&(c=zr(c),c=c===c?c:0),o!==e&&(o=zr(o),o=o===o?o:0),In(zr(i),o,c)}function F2(i,o,c){return o=Ki(o),c===e?(c=o,o=0):c=Ki(c),i=zr(i),km(i,o,c)}function D2(i,o,c){if(c&&typeof c!="boolean"&&cr(i,o,c)&&(o=c=e),c===e&&(typeof o=="boolean"?(c=o,o=e):typeof i=="boolean"&&(c=i,i=e)),i===e&&o===e?(i=0,o=1):(i=Ki(i),o===e?(o=i,i=0):o=Ki(o)),i>o){var g=i;i=o,o=g}if(c||i%1||o%1){var I=Sl();return ir(i+I*(o-i+d1("1e-"+((I+"").length-1))),o)}return Fc(i,o)}var q2=rs(function(i,o,c){return o=o.toLowerCase(),i+(c?id(o):o)});function id(i){return ah(ve(i).toLowerCase())}function nd(i){return i=ve(i),i&&i.replace(vi,x1).replace(i1,"")}function U2(i,o,c){i=ve(i),o=Pr(o);var g=i.length;c=c===e?g:In(te(c),0,g);var I=c;return c-=o.length,c>=0&&i.slice(c,I)==o}function B2(i){return i=ve(i),i&&jt.test(i)?i.replace(Sr,M1):i}function L2(i){return i=ve(i),i&&Vt.test(i)?i.replace(_e,"\\$&"):i}var k2=rs(function(i,o,c){return i+(c?"-":"")+o.toLowerCase()}),$2=rs(function(i,o,c){return i+(c?" ":"")+o.toLowerCase()}),j2=af("toLowerCase");function z2(i,o,c){i=ve(i),o=te(o);var g=o?Jn(i):0;if(!o||g>=o)return i;var I=(o-g)/2;return oa(Go(I),c)+i+oa(Vo(I),c)}function H2(i,o,c){i=ve(i),o=te(o);var g=o?Jn(i):0;return o&&g<o?i+oa(o-g,c):i}function K2(i,o,c){i=ve(i),o=te(o);var g=o?Jn(i):0;return o&&g<o?oa(o-g,c)+i:i}function V2(i,o,c){return c||o==null?o=0:o&&(o=+o),Z1(ve(i).replace(Lt,""),o||0)}function G2(i,o,c){return(c?cr(i,o,c):o===e)?o=1:o=te(o),Dc(ve(i),o)}function Q2(){var i=arguments,o=ve(i[0]);return i.length<3?o:o.replace(i[1],i[2])}var J2=rs(function(i,o,c){return i+(c?"_":"")+o.toLowerCase()});function Y2(i,o,c){return c&&typeof c!="number"&&cr(i,o,c)&&(o=c=e),c=c===e?d:c>>>0,c?(i=ve(i),i&&(typeof o=="string"||o!=null&&!nh(o))&&(o=Pr(o),!o&&Qn(i))?fn(Wr(i),0,c):i.split(o,c)):[]}var W2=rs(function(i,o,c){return i+(c?" ":"")+ah(o)});function X2(i,o,c){return i=ve(i),c=c==null?0:In(te(c),0,i.length),o=Pr(o),i.slice(c,c+o.length)==o}function Z2(i,o,c){var g=M.templateSettings;c&&cr(i,o,c)&&(o=e),i=ve(i),o=ya({},o,g,pf);var I=ya({},o.imports,g.imports,pf),N=Je(I),j=yc(I,N),K,Y,nt=0,ot=o.interpolate||rn,ct="__p += '",pt=bc((o.escape||rn).source+"|"+ot.source+"|"+(ot===kt?Ie:rn).source+"|"+(o.evaluate||rn).source+"|$","g"),Pt="//# sourceURL="+(we.call(o,"sourceURL")?(o.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++c1+"]")+`
`;i.replace(pt,function(qt,oe,le,Nr,hr,Rr){return le||(le=Nr),ct+=i.slice(nt,Rr).replace(Ps,P1),oe&&(K=!0,ct+=`' +
__e(`+oe+`) +
'`),hr&&(Y=!0,ct+=`';
`+hr+`;
__p += '`),le&&(ct+=`' +
((__t = (`+le+`)) == null ? '' : __t) +
'`),nt=Rr+qt.length,qt}),ct+=`';
`;var Dt=we.call(o,"variable")&&o.variable;if(!Dt)ct=`with (obj) {
`+ct+`
}
`;else if(Ee.test(Dt))throw new Yt(u);ct=(Y?ct.replace(fe,""):ct).replace(or,"$1").replace(de,"$1;"),ct="function("+(Dt||"obj")+`) {
`+(Dt?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(K?", __e = _.escape":"")+(Y?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+ct+`return __p
}`;var re=od(function(){return ge(N,Pt+"return "+ct).apply(e,j)});if(re.source=ct,ih(re))throw re;return re}function tb(i){return ve(i).toLowerCase()}function eb(i){return ve(i).toUpperCase()}function rb(i,o,c){if(i=ve(i),i&&(c||o===e))return pl(i);if(!i||!(o=Pr(o)))return i;var g=Wr(i),I=Wr(o),N=gl(g,I),j=ml(g,I)+1;return fn(g,N,j).join("")}function ib(i,o,c){if(i=ve(i),i&&(c||o===e))return i.slice(0,yl(i)+1);if(!i||!(o=Pr(o)))return i;var g=Wr(i),I=ml(g,Wr(o))+1;return fn(g,0,I).join("")}function nb(i,o,c){if(i=ve(i),i&&(c||o===e))return i.replace(Lt,"");if(!i||!(o=Pr(o)))return i;var g=Wr(i),I=gl(g,Wr(o));return fn(g,I).join("")}function sb(i,o){var c=ut,g=lt;if(qe(o)){var I="separator"in o?o.separator:I;c="length"in o?te(o.length):c,g="omission"in o?Pr(o.omission):g}i=ve(i);var N=i.length;if(Qn(i)){var j=Wr(i);N=j.length}if(c>=N)return i;var K=c-Jn(g);if(K<1)return g;var Y=j?fn(j,0,K).join(""):i.slice(0,K);if(I===e)return Y+g;if(j&&(K+=Y.length-K),nh(I)){if(i.slice(K).search(I)){var nt,ot=Y;for(I.global||(I=bc(I.source,ve(Ae.exec(I))+"g")),I.lastIndex=0;nt=I.exec(ot);)var ct=nt.index;Y=Y.slice(0,ct===e?K:ct)}}else if(i.indexOf(Pr(I),K)!=K){var pt=Y.lastIndexOf(I);pt>-1&&(Y=Y.slice(0,pt))}return Y+g}function ob(i){return i=ve(i),i&&$t.test(i)?i.replace(pe,D1):i}var ab=rs(function(i,o,c){return i+(c?" ":"")+o.toUpperCase()}),ah=af("toUpperCase");function sd(i,o,c){return i=ve(i),o=c?e:o,o===e?N1(i)?B1(i):_1(i):i.match(o)||[]}var od=ie(function(i,o){try{return xr(i,e,o)}catch(c){return ih(c)?c:new Yt(c)}}),cb=ji(function(i,o){return Ur(o,function(c){c=bi(c),ki(i,c,eh(i[c],i))}),i});function hb(i){var o=i==null?0:i.length,c=Ft();return i=o?De(i,function(g){if(typeof g[1]!="function")throw new Br(h);return[c(g[0]),g[1]]}):[],ie(function(g){for(var I=-1;++I<o;){var N=i[I];if(xr(N[0],this,g))return xr(N[1],this,g)}})}function ub(i){return Dm(kr(i,x))}function ch(i){return function(){return i}}function lb(i,o){return i==null||i!==i?o:i}var fb=hf(),db=hf(!0);function wr(i){return i}function hh(i){return Bl(typeof i=="function"?i:kr(i,x))}function pb(i){return kl(kr(i,x))}function gb(i,o){return $l(i,kr(o,x))}var mb=ie(function(i,o){return function(c){return Hs(c,i,o)}}),vb=ie(function(i,o){return function(c){return Hs(i,c,o)}});function uh(i,o,c){var g=Je(o),I=Zo(o,g);c==null&&!(qe(o)&&(I.length||!g.length))&&(c=o,o=i,i=this,I=Zo(o,Je(o)));var N=!(qe(c)&&"chain"in c)||!!c.chain,j=Hi(i);return Ur(I,function(K){var Y=o[K];i[K]=Y,j&&(i.prototype[K]=function(){var nt=this.__chain__;if(N||nt){var ot=i(this.__wrapped__),ct=ot.__actions__=mr(this.__actions__);return ct.push({func:Y,args:arguments,thisArg:i}),ot.__chain__=nt,ot}return Y.apply(i,on([this.value()],arguments))})}),i}function yb(){return Xe._===this&&(Xe._=H1),this}function lh(){}function wb(i){return i=te(i),ie(function(o){return jl(o,i)})}var bb=jc(De),_b=jc(hl),Ab=jc(dc);function ad(i){return Jc(i)?pc(bi(i)):Xm(i)}function Eb(i){return function(o){return i==null?e:Sn(i,o)}}var Ib=lf(),Sb=lf(!0);function fh(){return[]}function dh(){return!1}function xb(){return{}}function Mb(){return""}function Pb(){return!0}function Cb(i,o){if(i=te(i),i<1||i>P)return[];var c=d,g=ir(i,d);o=Ft(o),i-=d;for(var I=vc(g,o);++c<i;)o(c);return I}function Nb(i){return Xt(i)?De(i,bi):Cr(i)?[i]:mr(Mf(ve(i)))}function Rb(i){var o=++j1;return ve(i)+o}var Ob=sa(function(i,o){return i+o},0),Tb=zc("ceil"),Fb=sa(function(i,o){return i/o},1),Db=zc("floor");function qb(i){return i&&i.length?Xo(i,wr,Pc):e}function Ub(i,o){return i&&i.length?Xo(i,Ft(o,2),Pc):e}function Bb(i){return fl(i,wr)}function Lb(i,o){return fl(i,Ft(o,2))}function kb(i){return i&&i.length?Xo(i,wr,Oc):e}function $b(i,o){return i&&i.length?Xo(i,Ft(o,2),Oc):e}var jb=sa(function(i,o){return i*o},1),zb=zc("round"),Hb=sa(function(i,o){return i-o},0);function Kb(i){return i&&i.length?mc(i,wr):0}function Vb(i,o){return i&&i.length?mc(i,Ft(o,2)):0}return M.after=pw,M.ary=Bf,M.assign=e2,M.assignIn=Xf,M.assignInWith=ya,M.assignWith=r2,M.at=i2,M.before=Lf,M.bind=eh,M.bindAll=cb,M.bindKey=kf,M.castArray=xw,M.chain=Df,M.chunk=Dv,M.compact=qv,M.concat=Uv,M.cond=hb,M.conforms=ub,M.constant=ch,M.countBy=Ky,M.create=n2,M.curry=$f,M.curryRight=jf,M.debounce=zf,M.defaults=s2,M.defaultsDeep=o2,M.defer=gw,M.delay=mw,M.difference=Bv,M.differenceBy=Lv,M.differenceWith=kv,M.drop=$v,M.dropRight=jv,M.dropRightWhile=zv,M.dropWhile=Hv,M.fill=Kv,M.filter=Gy,M.flatMap=Yy,M.flatMapDeep=Wy,M.flatMapDepth=Xy,M.flatten=Rf,M.flattenDeep=Vv,M.flattenDepth=Gv,M.flip=vw,M.flow=fb,M.flowRight=db,M.fromPairs=Qv,M.functions=d2,M.functionsIn=p2,M.groupBy=Zy,M.initial=Yv,M.intersection=Wv,M.intersectionBy=Xv,M.intersectionWith=Zv,M.invert=m2,M.invertBy=v2,M.invokeMap=ew,M.iteratee=hh,M.keyBy=rw,M.keys=Je,M.keysIn=yr,M.map=fa,M.mapKeys=w2,M.mapValues=b2,M.matches=pb,M.matchesProperty=gb,M.memoize=pa,M.merge=_2,M.mergeWith=Zf,M.method=mb,M.methodOf=vb,M.mixin=uh,M.negate=ga,M.nthArg=wb,M.omit=A2,M.omitBy=E2,M.once=yw,M.orderBy=iw,M.over=bb,M.overArgs=ww,M.overEvery=_b,M.overSome=Ab,M.partial=rh,M.partialRight=Hf,M.partition=nw,M.pick=I2,M.pickBy=td,M.property=ad,M.propertyOf=Eb,M.pull=iy,M.pullAll=Tf,M.pullAllBy=ny,M.pullAllWith=sy,M.pullAt=oy,M.range=Ib,M.rangeRight=Sb,M.rearg=bw,M.reject=aw,M.remove=ay,M.rest=_w,M.reverse=Zc,M.sampleSize=hw,M.set=x2,M.setWith=M2,M.shuffle=uw,M.slice=cy,M.sortBy=dw,M.sortedUniq=gy,M.sortedUniqBy=my,M.split=Y2,M.spread=Aw,M.tail=vy,M.take=yy,M.takeRight=wy,M.takeRightWhile=by,M.takeWhile=_y,M.tap=qy,M.throttle=Ew,M.thru=la,M.toArray=Jf,M.toPairs=ed,M.toPairsIn=rd,M.toPath=Nb,M.toPlainObject=Wf,M.transform=P2,M.unary=Iw,M.union=Ay,M.unionBy=Ey,M.unionWith=Iy,M.uniq=Sy,M.uniqBy=xy,M.uniqWith=My,M.unset=C2,M.unzip=th,M.unzipWith=Ff,M.update=N2,M.updateWith=R2,M.values=ss,M.valuesIn=O2,M.without=Py,M.words=sd,M.wrap=Sw,M.xor=Cy,M.xorBy=Ny,M.xorWith=Ry,M.zip=Oy,M.zipObject=Ty,M.zipObjectDeep=Fy,M.zipWith=Dy,M.entries=ed,M.entriesIn=rd,M.extend=Xf,M.extendWith=ya,uh(M,M),M.add=Ob,M.attempt=od,M.camelCase=q2,M.capitalize=id,M.ceil=Tb,M.clamp=T2,M.clone=Mw,M.cloneDeep=Cw,M.cloneDeepWith=Nw,M.cloneWith=Pw,M.conformsTo=Rw,M.deburr=nd,M.defaultTo=lb,M.divide=Fb,M.endsWith=U2,M.eq=Zr,M.escape=B2,M.escapeRegExp=L2,M.every=Vy,M.find=Qy,M.findIndex=Cf,M.findKey=a2,M.findLast=Jy,M.findLastIndex=Nf,M.findLastKey=c2,M.floor=Db,M.forEach=qf,M.forEachRight=Uf,M.forIn=h2,M.forInRight=u2,M.forOwn=l2,M.forOwnRight=f2,M.get=sh,M.gt=Ow,M.gte=Tw,M.has=g2,M.hasIn=oh,M.head=Of,M.identity=wr,M.includes=tw,M.indexOf=Jv,M.inRange=F2,M.invoke=y2,M.isArguments=Pn,M.isArray=Xt,M.isArrayBuffer=Fw,M.isArrayLike=vr,M.isArrayLikeObject=ke,M.isBoolean=Dw,M.isBuffer=dn,M.isDate=qw,M.isElement=Uw,M.isEmpty=Bw,M.isEqual=Lw,M.isEqualWith=kw,M.isError=ih,M.isFinite=$w,M.isFunction=Hi,M.isInteger=Kf,M.isLength=ma,M.isMap=Vf,M.isMatch=jw,M.isMatchWith=zw,M.isNaN=Hw,M.isNative=Kw,M.isNil=Gw,M.isNull=Vw,M.isNumber=Gf,M.isObject=qe,M.isObjectLike=Ue,M.isPlainObject=Ys,M.isRegExp=nh,M.isSafeInteger=Qw,M.isSet=Qf,M.isString=va,M.isSymbol=Cr,M.isTypedArray=ns,M.isUndefined=Jw,M.isWeakMap=Yw,M.isWeakSet=Ww,M.join=ty,M.kebabCase=k2,M.last=jr,M.lastIndexOf=ey,M.lowerCase=$2,M.lowerFirst=j2,M.lt=Xw,M.lte=Zw,M.max=qb,M.maxBy=Ub,M.mean=Bb,M.meanBy=Lb,M.min=kb,M.minBy=$b,M.stubArray=fh,M.stubFalse=dh,M.stubObject=xb,M.stubString=Mb,M.stubTrue=Pb,M.multiply=jb,M.nth=ry,M.noConflict=yb,M.noop=lh,M.now=da,M.pad=z2,M.padEnd=H2,M.padStart=K2,M.parseInt=V2,M.random=D2,M.reduce=sw,M.reduceRight=ow,M.repeat=G2,M.replace=Q2,M.result=S2,M.round=zb,M.runInContext=G,M.sample=cw,M.size=lw,M.snakeCase=J2,M.some=fw,M.sortedIndex=hy,M.sortedIndexBy=uy,M.sortedIndexOf=ly,M.sortedLastIndex=fy,M.sortedLastIndexBy=dy,M.sortedLastIndexOf=py,M.startCase=W2,M.startsWith=X2,M.subtract=Hb,M.sum=Kb,M.sumBy=Vb,M.template=Z2,M.times=Cb,M.toFinite=Ki,M.toInteger=te,M.toLength=Yf,M.toLower=tb,M.toNumber=zr,M.toSafeInteger=t2,M.toString=ve,M.toUpper=eb,M.trim=rb,M.trimEnd=ib,M.trimStart=nb,M.truncate=sb,M.unescape=ob,M.uniqueId=Rb,M.upperCase=ab,M.upperFirst=ah,M.each=qf,M.eachRight=Uf,M.first=Of,uh(M,function(){var i={};return yi(M,function(o,c){we.call(M.prototype,c)||(i[c]=o)}),i}(),{chain:!1}),M.VERSION=n,Ur(["bind","bindKey","curry","curryRight","partial","partialRight"],function(i){M[i].placeholder=M}),Ur(["drop","take"],function(i,o){ce.prototype[i]=function(c){c=c===e?1:Ve(te(c),0);var g=this.__filtered__&&!o?new ce(this):this.clone();return g.__filtered__?g.__takeCount__=ir(c,g.__takeCount__):g.__views__.push({size:ir(c,d),type:i+(g.__dir__<0?"Right":"")}),g},ce.prototype[i+"Right"]=function(c){return this.reverse()[i](c).reverse()}}),Ur(["filter","map","takeWhile"],function(i,o){var c=o+1,g=c==v||c==b;ce.prototype[i]=function(I){var N=this.clone();return N.__iteratees__.push({iteratee:Ft(I,3),type:c}),N.__filtered__=N.__filtered__||g,N}}),Ur(["head","last"],function(i,o){var c="take"+(o?"Right":"");ce.prototype[i]=function(){return this[c](1).value()[0]}}),Ur(["initial","tail"],function(i,o){var c="drop"+(o?"":"Right");ce.prototype[i]=function(){return this.__filtered__?new ce(this):this[c](1)}}),ce.prototype.compact=function(){return this.filter(wr)},ce.prototype.find=function(i){return this.filter(i).head()},ce.prototype.findLast=function(i){return this.reverse().find(i)},ce.prototype.invokeMap=ie(function(i,o){return typeof i=="function"?new ce(this):this.map(function(c){return Hs(c,i,o)})}),ce.prototype.reject=function(i){return this.filter(ga(Ft(i)))},ce.prototype.slice=function(i,o){i=te(i);var c=this;return c.__filtered__&&(i>0||o<0)?new ce(c):(i<0?c=c.takeRight(-i):i&&(c=c.drop(i)),o!==e&&(o=te(o),c=o<0?c.dropRight(-o):c.take(o-i)),c)},ce.prototype.takeRightWhile=function(i){return this.reverse().takeWhile(i).reverse()},ce.prototype.toArray=function(){return this.take(d)},yi(ce.prototype,function(i,o){var c=/^(?:filter|find|map|reject)|While$/.test(o),g=/^(?:head|last)$/.test(o),I=M[g?"take"+(o=="last"?"Right":""):o],N=g||/^find/.test(o);I&&(M.prototype[o]=function(){var j=this.__wrapped__,K=g?[1]:arguments,Y=j instanceof ce,nt=K[0],ot=Y||Xt(j),ct=function(oe){var le=I.apply(M,on([oe],K));return g&&pt?le[0]:le};ot&&c&&typeof nt=="function"&&nt.length!=1&&(Y=ot=!1);var pt=this.__chain__,Pt=!!this.__actions__.length,Dt=N&&!pt,re=Y&&!Pt;if(!N&&ot){j=re?j:new ce(this);var qt=i.apply(j,K);return qt.__actions__.push({func:la,args:[ct],thisArg:e}),new Lr(qt,pt)}return Dt&&re?i.apply(this,K):(qt=this.thru(ct),Dt?g?qt.value()[0]:qt.value():qt)})}),Ur(["pop","push","shift","sort","splice","unshift"],function(i){var o=Uo[i],c=/^(?:push|sort|unshift)$/.test(i)?"tap":"thru",g=/^(?:pop|shift)$/.test(i);M.prototype[i]=function(){var I=arguments;if(g&&!this.__chain__){var N=this.value();return o.apply(Xt(N)?N:[],I)}return this[c](function(j){return o.apply(Xt(j)?j:[],I)})}}),yi(ce.prototype,function(i,o){var c=M[o];if(c){var g=c.name+"";we.call(Zn,g)||(Zn[g]=[]),Zn[g].push({name:o,func:c})}}),Zn[na(e,Z).name]=[{name:"wrapper",func:e}],ce.prototype.clone=om,ce.prototype.reverse=am,ce.prototype.value=cm,M.prototype.at=Uy,M.prototype.chain=By,M.prototype.commit=Ly,M.prototype.next=ky,M.prototype.plant=jy,M.prototype.reverse=zy,M.prototype.toJSON=M.prototype.valueOf=M.prototype.value=Hy,M.prototype.first=M.prototype.head,Us&&(M.prototype[Us]=$y),M},Yn=L1();bn?((bn.exports=Yn)._=Yn,hc._=Yn):Xe._=Yn}).call(uo)})(du,du.exports);var zI=Object.defineProperty,HI=Object.defineProperties,KI=Object.getOwnPropertyDescriptors,n0=Object.getOwnPropertySymbols,VI=Object.prototype.hasOwnProperty,GI=Object.prototype.propertyIsEnumerable,s0=(r,t,e)=>t in r?zI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Pa=(r,t)=>{for(var e in t||(t={}))VI.call(t,e)&&s0(r,e,t[e]);if(n0)for(var e of n0(t))GI.call(t,e)&&s0(r,e,t[e]);return r},QI=(r,t)=>HI(r,KI(t));function ci(r,t,e){var n;const s=go(r);return((n=t.rpcMap)==null?void 0:n[s.reference])||`${Hg}?chainId=${s.namespace}:${s.reference}&projectId=${e}`}function jn(r){return r.includes(":")?r.split(":")[1]:r}function Kg(r){return r.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function JI(r,t){const e=Object.keys(t.namespaces).filter(s=>s.includes(r));if(!e.length)return[];const n=[];return e.forEach(s=>{const a=t.namespaces[s].accounts;n.push(...a)}),n}function Yh(r={},t={}){const e=o0(r),n=o0(t);return du.exports.merge(e,n)}function o0(r){var t,e,n,s;const a={};if(!Eo(r))return a;for(const[h,u]of Object.entries(r)){const f=Tu(h)?[h]:u.chains,y=u.methods||[],A=u.events||[],x=u.rpcMap||{},T=po(h);a[T]=QI(Pa(Pa({},a[T]),u),{chains:Ra(f,(t=a[T])==null?void 0:t.chains),methods:Ra(y,(e=a[T])==null?void 0:e.methods),events:Ra(A,(n=a[T])==null?void 0:n.events),rpcMap:Pa(Pa({},x),(s=a[T])==null?void 0:s.rpcMap)})}return a}function YI(r){return r.includes(":")?r.split(":")[2]:r}function a0(r){const t={};for(const[e,n]of Object.entries(r)){const s=n.methods||[],a=n.events||[],h=n.accounts||[],u=Tu(e)?[e]:n.chains?n.chains:Kg(n.accounts);t[e]={chains:u,methods:s,events:a,accounts:h}}return t}function Wh(r){return typeof r=="number"?r:r.includes("0x")?parseInt(r,16):(r=r.includes(":")?r.split(":")[1]:r,isNaN(Number(r))?r:Number(r))}const Vg={},ye=r=>Vg[r],Xh=(r,t)=>{Vg[r]=t};class WI{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;const s=jn(e);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}var XI=Object.defineProperty,ZI=Object.defineProperties,tS=Object.getOwnPropertyDescriptors,c0=Object.getOwnPropertySymbols,eS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,h0=(r,t,e)=>t in r?XI(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,u0=(r,t)=>{for(var e in t||(t={}))eS.call(t,e)&&h0(r,e,t[e]);if(c0)for(var e of c0(t))rS.call(t,e)&&h0(r,e,t[e]);return r},l0=(r,t)=>ZI(r,tS(t));class iS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(t);case"wallet_getCallsStatus":return await this.getCallStatus(t)}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(parseInt(t),e),this.chainId=parseInt(t),this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,e){const n=e||ci(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;const s=parseInt(jn(e));t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}async handleSwitchChain(t){var e,n;let s=t.request.params?(e=t.request.params[0])==null?void 0:e.chainId:"0x0";s=s.startsWith("0x")?s:`0x${s}`;const a=parseInt(s,16);if(this.isChainApproved(a))this.setDefaultChain(`${a}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:s}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${a}`);else throw new Error(`Failed to switch to chain 'eip155:${a}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}async getCapabilities(t){var e,n,s;const a=(n=(e=t.request)==null?void 0:e.params)==null?void 0:n[0];if(!a)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const h=this.client.session.get(t.topic),u=((s=h==null?void 0:h.sessionProperties)==null?void 0:s.capabilities)||{};if(u!=null&&u[a])return u==null?void 0:u[a];const f=await this.client.request(t);try{await this.client.session.update(t.topic,{sessionProperties:l0(u0({},h.sessionProperties||{}),{capabilities:l0(u0({},u||{}),{[a]:f})})})}catch(y){console.warn("Failed to update session with capabilities",y)}return f}async getCallStatus(t){var e,n;const s=this.client.session.get(t.topic),a=(e=s.sessionProperties)==null?void 0:e.bundler_name;if(a){const u=this.getBundlerUrl(t.chainId,a);try{return await this.getUserOperationReceipt(u,t)}catch(f){console.warn("Failed to fetch call status from bundler",f,u)}}const h=(n=s.sessionProperties)==null?void 0:n.bundler_url;if(h)try{return await this.getUserOperationReceipt(h,t)}catch(u){console.warn("Failed to fetch call status from custom bundler",u,h)}if(this.namespace.methods.includes(t.request.method))return await this.client.request(t);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(t,e){var n;const s=new URL(t),a=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Fn("eth_getUserOperationReceipt",[(n=e.request.params)==null?void 0:n[0]]))});if(!a.ok)throw new Error(`Failed to fetch user operation receipt - ${a.status}`);return await a.json()}getBundlerUrl(t,e){return`${jI}?projectId=${this.client.core.projectId}&chainId=${t}&bundler=${e}`}}class nS{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;const s=jn(e);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}class sS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;const s=jn(e);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}class oS{constructor(t){this.name="algorand",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(!this.httpProviders[t]){const n=e||ci(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;t[e]=this.createHttpProvider(e,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);return typeof n>"u"?void 0:new hi(new Di(n,ye("disableProviderPing")))}}class aS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{const n=this.getCardanoRPCUrl(e),s=jn(e);t[s]=this.createHttpProvider(s,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}getCardanoRPCUrl(t){const e=this.namespace.rpcMap;if(e)return e[t]}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}class cS{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;const s=jn(e);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}class hS{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;const s=jn(e);t[s]=this.createHttpProvider(s,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}class uS{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,e){if(this.chainId=t,!this.httpProviders[t]){const n=e||ci(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(e=>{var n;t[e]=this.createHttpProvider(e,(n=this.namespace.rpcMap)==null?void 0:n[e])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace);return typeof n>"u"?void 0:new hi(new Di(n,ye("disableProviderPing")))}}class lS{constructor(t){this.name=us,this.namespace=t.namespace,this.events=ye("events"),this.client=ye("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(t.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(t.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(t.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(t.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider(t.chainId).request(t.request)}setDefaultChain(t,e){this.httpProviders[t]||this.setHttpProvider(t,e),this.chainId=t,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var t,e;const n={};return(e=(t=this.namespace)==null?void 0:t.accounts)==null||e.forEach(s=>{const a=go(s);n[`${a.namespace}:${a.reference}`]=this.createHttpProvider(s)}),n}getHttpProvider(t){const e=this.httpProviders[t];if(typeof e>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return e}setHttpProvider(t,e){const n=this.createHttpProvider(t,e);n&&(this.httpProviders[t]=n)}createHttpProvider(t,e){const n=e||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new hi(new Di(n,ye("disableProviderPing")))}}var fS=Object.defineProperty,dS=Object.defineProperties,pS=Object.getOwnPropertyDescriptors,f0=Object.getOwnPropertySymbols,gS=Object.prototype.hasOwnProperty,mS=Object.prototype.propertyIsEnumerable,d0=(r,t,e)=>t in r?fS(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,Ca=(r,t)=>{for(var e in t||(t={}))gS.call(t,e)&&d0(r,e,t[e]);if(f0)for(var e of f0(t))mS.call(t,e)&&d0(r,e,t[e]);return r},Zh=(r,t)=>dS(r,pS(t));class Bu{constructor(t){this.events=new _u,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:yu(Ya({level:(t==null?void 0:t.logger)||r0})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const e=new Bu(t);return await e.initialize(),e}async request(t,e,n){const[s,a]=this.validateChain(e);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Ca({},t),chainId:`${s}:${a}`,topic:this.session.topic,expiry:n})}sendAsync(t,e,n,s){const a=new Date().getTime();this.request(t,n,s).then(h=>e(null,Wa(a,h))).catch(h=>e(h,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:be("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}async authenticate(t,e){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(t),await this.cleanupPendingPairings();const{uri:n,response:s}=await this.client.authenticate(t,e);n&&(this.uri=n,this.events.emit("display_uri",n));const a=await s();if(this.session=a.session,this.session){const h=a0(this.session.namespaces);this.namespaces=Yh(this.namespaces,h),this.persist("namespaces",this.namespaces),this.onConnect()}return a}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let e=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(e>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:s}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await s().then(a=>{this.session=a;const h=a0(a.namespaces);this.namespaces=Yh(this.namespaces,h),this.persist("namespaces",this.namespaces)}).catch(a=>{if(a.message!==zg)throw a;e++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,e){try{if(!this.session)return;const[n,s]=this.validateChain(t),a=this.getProvider(n);a.name===us?a.setDefaultChain(`${n}:${s}`,e):a.setDefaultChain(s,e)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const e=this.client.pairing.getAll();if(Ti(e)){for(const n of e)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${e.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Uu.init({core:this.providerOpts.core,logger:this.providerOpts.logger||r0,relayUrl:this.providerOpts.relayUrl||LI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(e=>po(e)))];Xh("client",this.client),Xh("events",this.events),Xh("disableProviderPing",this.disableProviderPing),t.forEach(e=>{if(!this.session)return;const n=JI(e,this.session),s=Kg(n),a=Yh(this.namespaces,this.optionalNamespaces),h=Zh(Ca({},a[e]),{accounts:n,chains:s});switch(e){case"eip155":this.rpcProviders[e]=new iS({namespace:h});break;case"algorand":this.rpcProviders[e]=new oS({namespace:h});break;case"solana":this.rpcProviders[e]=new nS({namespace:h});break;case"cosmos":this.rpcProviders[e]=new sS({namespace:h});break;case"polkadot":this.rpcProviders[e]=new WI({namespace:h});break;case"cip34":this.rpcProviders[e]=new aS({namespace:h});break;case"elrond":this.rpcProviders[e]=new cS({namespace:h});break;case"multiversx":this.rpcProviders[e]=new hS({namespace:h});break;case"near":this.rpcProviders[e]=new uS({namespace:h});break;default:this.rpcProviders[us]?this.rpcProviders[us].updateNamespace(h):this.rpcProviders[us]=new lS({namespace:h})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:e}=t,{event:n}=e;if(n.name==="accountsChanged"){const s=n.data;s&&Ti(s)&&this.events.emit("accountsChanged",s.map(YI))}else if(n.name==="chainChanged"){const s=e.chainId,a=e.event.data,h=po(s),u=Wh(s)!==Wh(a)?`${h}:${Wh(a)}`:s;this.onChainChanged(u)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:e})=>{var n;const{namespaces:s}=e,a=(n=this.client)==null?void 0:n.session.get(t);this.session=Zh(Ca({},a),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:e})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Zh(Ca({},be("USER_DISCONNECTED")),{data:t.topic}))}),this.on(li.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){return this.rpcProviders[t]||this.rpcProviders[us]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var e;this.getProvider(t).updateNamespace((e=this.session)==null?void 0:e.namespaces[t])})}setNamespaces(t){const{namespaces:e,optionalNamespaces:n,sessionProperties:s}=t;e&&Object.keys(e).length&&(this.namespaces=e),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=s,this.persist("namespaces",e),this.persist("optionalNamespaces",n)}validateChain(t){const[e,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[e,n];if(e&&!Object.keys(this.namespaces||{}).map(h=>po(h)).includes(e))throw new Error(`Namespace '${e}' is not configured. Please call connect() first with namespace config.`);if(e&&n)return[e,n];const s=po(Object.keys(this.namespaces)[0]),a=this.rpcProviders[s].getDefaultChain();return[s,a]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,e=!1){if(!this.namespaces)return;const[n,s]=this.validateChain(t);s&&(e||this.getProvider(n).setDefaultChain(s),this.namespaces[n]?this.namespaces[n].defaultChain=s:this.namespaces[`${n}:${s}`]?this.namespaces[`${n}:${s}`].defaultChain=s:this.namespaces[`${n}:${s}`]={defaultChain:s},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",s))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,e){this.client.core.storage.setItem(`${i0}/${t}`,e)}async getFromStore(t){return await this.client.core.storage.getItem(`${i0}/${t}`)}}const vS=Bu,yS="wc",wS="ethereum_provider",bS=`${yS}@2:${wS}:`,_S="https://rpc.walletconnect.org/v1/",pu=["eth_sendTransaction","personal_sign"],AS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],gu=["chainChanged","accountsChanged"],ES=["chainChanged","accountsChanged","message","disconnect","connect"];var IS=Object.defineProperty,SS=Object.defineProperties,xS=Object.getOwnPropertyDescriptors,p0=Object.getOwnPropertySymbols,MS=Object.prototype.hasOwnProperty,PS=Object.prototype.propertyIsEnumerable,g0=(r,t,e)=>t in r?IS(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,ls=(r,t)=>{for(var e in t||(t={}))MS.call(t,e)&&g0(r,e,t[e]);if(p0)for(var e of p0(t))PS.call(t,e)&&g0(r,e,t[e]);return r},tu=(r,t)=>SS(r,xS(t));function Ja(r){return Number(r[0].split(":")[1])}function Na(r){return`0x${r.toString(16)}`}function CS(r){const{chains:t,optionalChains:e,methods:n,optionalMethods:s,events:a,optionalEvents:h,rpcMap:u}=r;if(!Ti(t))throw new Error("Invalid chains");const f={chains:t,methods:n||pu,events:a||gu,rpcMap:ls({},t.length?{[Ja(t)]:u[Ja(t)]}:{})},y=a==null?void 0:a.filter(R=>!gu.includes(R)),A=n==null?void 0:n.filter(R=>!pu.includes(R));if(!e&&!h&&!s&&!(y!=null&&y.length)&&!(A!=null&&A.length))return{required:t.length?f:void 0};const x=(y==null?void 0:y.length)&&(A==null?void 0:A.length)||!e,T={chains:[...new Set(x?f.chains.concat(e||[]):e)],methods:[...new Set(f.methods.concat(s!=null&&s.length?s:AS))],events:[...new Set(f.events.concat(h!=null&&h.length?h:ES))],rpcMap:u};return{required:t.length?f:void 0,optional:e.length?T:void 0}}class Lu{constructor(){this.events=new en.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=bS,this.on=(t,e)=>(this.events.on(t,e),this),this.once=(t,e)=>(this.events.once(t,e),this),this.removeListener=(t,e)=>(this.events.removeListener(t,e),this),this.off=(t,e)=>(this.events.off(t,e),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const e=new Lu;return await e.initialize(t),e}async request(t,e){return await this.signer.request(t,this.formatChainId(this.chainId),e)}sendAsync(t,e,n){this.signer.sendAsync(t,e,this.formatChainId(this.chainId),n)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:e,optional:n}=CS(this.rpc);try{const s=await new Promise(async(h,u)=>{var f;this.rpc.showQrModal&&((f=this.modal)==null||f.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),u(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(tu(ls({namespaces:ls({},e&&{[this.namespace]:e})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{h(y)}).catch(y=>{u(new Error(y.message))})});if(!s)return;const a=Bd(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Na(this.chainId)})}catch(s){throw this.signer.logger.error(s),s}finally{this.modal&&this.modal.closeModal()}}async authenticate(t,e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:t==null?void 0:t.chains});try{const n=await new Promise(async(a,h)=>{var u;this.rpc.showQrModal&&((u=this.modal)==null||u.subscribeModal(f=>{!f.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),h(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(tu(ls({},t),{chains:this.rpc.chains}),e).then(f=>{a(f)}).catch(f=>{h(new Error(f.message))})}),s=n.session;if(s){const a=Bd(s.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:a),this.setAccounts(a),this.events.emit("connect",{chainId:Na(this.chainId)})}return n}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:e}=t,{event:n}=e;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const e=parseInt(t);this.chainId=e,this.events.emit("chainChanged",Na(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",tu(ls({},be("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var e,n;this.rpc.showQrModal&&((e=this.modal)==null||e.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const e=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));e.length&&(this.chainId=e[0],this.events.emit("chainChanged",Na(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const e=this.parseChainId(t);this.chainId=e,this.switchEthereumChain(e)}}parseAccountId(t){const[e,n,s]=t.split(":");return{chainId:`${e}:${n}`,address:s}}setAccounts(t){this.accounts=t.filter(e=>this.parseChainId(this.parseAccountId(e).chainId)===this.chainId).map(e=>this.parseAccountId(e).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var e,n;const s=(e=t==null?void 0:t.chains)!=null?e:[],a=(n=t==null?void 0:t.optionalChains)!=null?n:[],h=s.concat(a);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const u=s.length?(t==null?void 0:t.methods)||pu:[],f=s.length?(t==null?void 0:t.events)||gu:[],y=(t==null?void 0:t.optionalMethods)||[],A=(t==null?void 0:t.optionalEvents)||[],x=(t==null?void 0:t.rpcMap)||this.buildRpcMap(h,t.projectId),T=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:s==null?void 0:s.map(R=>this.formatChainId(R)),optionalChains:a.map(R=>this.formatChainId(R)),methods:u,events:f,optionalMethods:y,optionalEvents:A,rpcMap:x,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:T,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,e){const n={};return t.forEach(s=>{n[s]=this.getRpcUrl(s,e)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Ja(this.rpc.chains):Ja(this.rpc.optionalChains),this.signer=await vS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions,customStoragePrefix:t.customStoragePrefix,telemetryEnabled:t.telemetryEnabled}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let e;try{const{WalletConnectModal:n}=await s6(()=>import("./index-DCptEfrH.js").then(s=>s.i),__vite__mapDeps([0,1,2]));e=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(e)try{this.modal=new e(ls({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:e,optionalChains:n,rpcMap:s}=t;e&&Ti(e)&&(this.rpc.chains=e.map(a=>this.formatChainId(a)),e.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)})),n&&Ti(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(a=>this.formatChainId(a)),n.forEach(a=>{this.rpc.rpcMap[a]=(s==null?void 0:s[a])||this.getRpcUrl(a)}))}getRpcUrl(t,e){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${_S}?chainId=eip155:${t}&projectId=${e||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),e=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:e==null?void 0:e.accounts),this.setAccounts(e==null?void 0:e.accounts)}catch(t){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(t),await this.disconnect().catch(e=>this.signer.logger.warn(e))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(e=>this.parseAccount(e))}}const jS=Lu;export{jS as EthereumProvider,ES as OPTIONAL_EVENTS,AS as OPTIONAL_METHODS,gu as REQUIRED_EVENTS,pu as REQUIRED_METHODS,Lu as default};
